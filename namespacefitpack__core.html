<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>fitpack: fitpack_core Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
        <script type="text/javascript">
            DoxygenAwesomeDarkModeToggle.init()
        </script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">fitpack
   </div>
   <div id="projectbrief">Modern Fortran library for curve and surface fitting with splines</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('namespacefitpack__core.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">fitpack_core Module Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacefitpack__core_1_1fitpack__polar__boundary.html">fitpack_polar_boundary</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacefitpack__core_1_1fitpack__swap.html">fitpack_swap</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacefitpack__core_1_1fp__comm__expand.html">fp_comm_expand</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand communication buffer into allocatable arrays.  <a href="interfacefitpack__core_1_1fp__comm__expand.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacefitpack__core_1_1fp__comm__pack.html">fp_comm_pack</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack allocatable arrays into communication buffer.  <a href="interfacefitpack__core_1_1fp__comm__pack.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacefitpack__core_1_1fp__comm__size.html">fp_comm_size</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Communication size for allocatable 1D arrays.  <a href="interfacefitpack__core_1_1fp__comm__size.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a2df24a0ee6fecec68ea6b06ee1f28e08" id="r_a2df24a0ee6fecec68ea6b06ee1f28e08"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2df24a0ee6fecec68ea6b06ee1f28e08">fitpack_error_handling</a> (ierr, ierr_out, whereat)</td></tr>
<tr class="memdesc:a2df24a0ee6fecec68ea6b06ee1f28e08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispatch an error code: return it to caller or halt with a message.  <br /></td></tr>
<tr class="separator:a2df24a0ee6fecec68ea6b06ee1f28e08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acecd9e9bd2b5f16cc9ba6d0263b275c5" id="r_acecd9e9bd2b5f16cc9ba6d0263b275c5"><td class="memItemLeft" align="right" valign="top">pure character(len=:) function, allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acecd9e9bd2b5f16cc9ba6d0263b275c5">fitpack_message</a> (ierr)</td></tr>
<tr class="memdesc:acecd9e9bd2b5f16cc9ba6d0263b275c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert an integer error flag to a human-readable message string.  <br /></td></tr>
<tr class="separator:acecd9e9bd2b5f16cc9ba6d0263b275c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9c168cddc6b453b8a23cd0d27e899e2" id="r_af9c168cddc6b453b8a23cd0d27e899e2"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9c168cddc6b453b8a23cd0d27e899e2">get_smoothing</a> (old_smoothing, user_smoothing, nit, smooth_now)</td></tr>
<tr class="memdesc:af9c168cddc6b453b8a23cd0d27e899e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Choose the smoothing parameter(s) for an iterative fit.  <br /></td></tr>
<tr class="separator:af9c168cddc6b453b8a23cd0d27e899e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab71e638faa5a4457d12026be93f6588c" id="r_ab71e638faa5a4457d12026be93f6588c"><td class="memItemLeft" align="right" valign="top">pure character(len=:) function, allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab71e638faa5a4457d12026be93f6588c">iopt_message</a> (iopt)</td></tr>
<tr class="memdesc:ab71e638faa5a4457d12026be93f6588c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert an <code>iopt</code> computation-mode flag to a human-readable string.  <br /></td></tr>
<tr class="separator:ab71e638faa5a4457d12026be93f6588c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ebd1c826f330de0103ba72e55260ba" id="r_ab0ebd1c826f330de0103ba72e55260ba"><td class="memItemLeft" align="right" valign="top">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab0ebd1c826f330de0103ba72e55260ba">fitpack_success</a> (ierr)</td></tr>
<tr class="memdesc:ab0ebd1c826f330de0103ba72e55260ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether a FITPACK error flag indicates success.  <br /></td></tr>
<tr class="separator:ab0ebd1c826f330de0103ba72e55260ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fc6de0b9389c7699809c138e0cb8604" id="r_a7fc6de0b9389c7699809c138e0cb8604"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7fc6de0b9389c7699809c138e0cb8604">bispeu</a> (tx, nx, ty, ny, c, kx, ky, x, y, z, m, wrk, lwrk, ier)</td></tr>
<tr class="memdesc:a7fc6de0b9389c7699809c138e0cb8604"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate a bivariate spline at scattered points \( (x_i, y_i) \).  <br /></td></tr>
<tr class="separator:a7fc6de0b9389c7699809c138e0cb8604"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac8fa7ec692eb2758290f050c302d22d" id="r_aac8fa7ec692eb2758290f050c302d22d"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac8fa7ec692eb2758290f050c302d22d">bispev</a> (tx, nx, ty, ny, c, kx, ky, x, mx, y, my, z, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:aac8fa7ec692eb2758290f050c302d22d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate a bivariate spline on a rectangular grid.  <br /></td></tr>
<tr class="separator:aac8fa7ec692eb2758290f050c302d22d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a343cb3562b6062cf6ca4a493b8fca8" id="r_a5a343cb3562b6062cf6ca4a493b8fca8"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a343cb3562b6062cf6ca4a493b8fca8">clocur</a> (iopt, ipar, idim, m, u, mx, x, w, k, s, nest, n, t, nc, c, fp, wrk, lwrk, iwrk, ier)</td></tr>
<tr class="memdesc:a5a343cb3562b6062cf6ca4a493b8fca8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine a smooth closed parametric spline curve approximation.  <br /></td></tr>
<tr class="separator:a5a343cb3562b6062cf6ca4a493b8fca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7347e7f9131cca78d72fe38baba4c92" id="r_ae7347e7f9131cca78d72fe38baba4c92"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7347e7f9131cca78d72fe38baba4c92">cocosp</a> (m, x, y, w, n, t, e, maxtr, maxbin, c, sq, sx, bind, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:ae7347e7f9131cca78d72fe38baba4c92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a cubic spline with convexity/concavity constraints and user-specified knots.  <br /></td></tr>
<tr class="separator:ae7347e7f9131cca78d72fe38baba4c92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c04e0266b3011454aef7f491c067036" id="r_a4c04e0266b3011454aef7f491c067036"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4c04e0266b3011454aef7f491c067036">concon</a> (iopt, m, x, y, w, v, s, nest, maxtr, maxbin, n, t, c, sq, sx, bind, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:a4c04e0266b3011454aef7f491c067036"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a cubic spline with convexity/concavity constraints and automatic knot placement.  <br /></td></tr>
<tr class="separator:a4c04e0266b3011454aef7f491c067036"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f06e314103a691e23bd2eda4055086d" id="r_a4f06e314103a691e23bd2eda4055086d"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f06e314103a691e23bd2eda4055086d">concur</a> (iopt, idim, m, u, mx, x, xx, w, ib, db, nb, ie, de, ne, k, s, nest, n, t, nc, c, np, cp, fp, wrk, lwrk, iwrk, ier)</td></tr>
<tr class="memdesc:a4f06e314103a691e23bd2eda4055086d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine a smooth parametric spline curve with derivative constraints at endpoints.  <br /></td></tr>
<tr class="separator:a4f06e314103a691e23bd2eda4055086d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2705f0e7063ef12ffd607c3d07f39c" id="r_a5c2705f0e7063ef12ffd607c3d07f39c"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c2705f0e7063ef12ffd607c3d07f39c">cualde</a> (idim, t, n, c, nc, k1, u, d, nd, ier)</td></tr>
<tr class="memdesc:a5c2705f0e7063ef12ffd607c3d07f39c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate all derivatives of a parametric spline curve at a single point.  <br /></td></tr>
<tr class="separator:a5c2705f0e7063ef12ffd607c3d07f39c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d7ebdb8afd5f3265a7f664cb9c83312" id="r_a5d7ebdb8afd5f3265a7f664cb9c83312"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5d7ebdb8afd5f3265a7f664cb9c83312">curev</a> (idim, t, n, c, nc, k, u, m, x, mx, ier)</td></tr>
<tr class="memdesc:a5d7ebdb8afd5f3265a7f664cb9c83312"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate a parametric spline curve at a set of parameter values.  <br /></td></tr>
<tr class="separator:a5d7ebdb8afd5f3265a7f664cb9c83312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65af4d46ed853e0bfe2274ea2660b0f" id="r_ac65af4d46ed853e0bfe2274ea2660b0f"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac65af4d46ed853e0bfe2274ea2660b0f">curfit</a> (iopt, m, x, y, w, xb, xe, k, s, nest, n, t, c, fp, wrk, lwrk, iwrk, ier)</td></tr>
<tr class="memdesc:ac65af4d46ed853e0bfe2274ea2660b0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine a smooth spline approximation of degree \( k \) to a set of data points.  <br /></td></tr>
<tr class="separator:ac65af4d46ed853e0bfe2274ea2660b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad87800d8674963f83316e6a9a6c9cce" id="r_aad87800d8674963f83316e6a9a6c9cce"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad87800d8674963f83316e6a9a6c9cce">dblint</a> (tx, nx, ty, ny, c, kx, ky, xb, xe, yb, ye, wrk)</td></tr>
<tr class="memdesc:aad87800d8674963f83316e6a9a6c9cce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the double integral of a bivariate spline over a rectangle.  <br /></td></tr>
<tr class="separator:aad87800d8674963f83316e6a9a6c9cce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe28377d1376dd629fcd34340fd3949b" id="r_afe28377d1376dd629fcd34340fd3949b"><td class="memItemLeft" align="right" valign="top">pure real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe28377d1376dd629fcd34340fd3949b">evapol</a> (tu, nu, tv, nv, c, rad, x, y)</td></tr>
<tr class="memdesc:afe28377d1376dd629fcd34340fd3949b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate a polar spline \( f(x,y) = s(u,v) \) at a Cartesian point.  <br /></td></tr>
<tr class="separator:afe28377d1376dd629fcd34340fd3949b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2256640832da2724f9e5058bcebd6ec2" id="r_a2256640832da2724f9e5058bcebd6ec2"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2256640832da2724f9e5058bcebd6ec2">fourco</a> (t, n, c, alfa, m, ress, resc, wrk1, wrk2, ier)</td></tr>
<tr class="memdesc:a2256640832da2724f9e5058bcebd6ec2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Fourier coefficients of a cubic spline.  <br /></td></tr>
<tr class="separator:a2256640832da2724f9e5058bcebd6ec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6b368d82e72f0bde7c8a9cc60eb76f2" id="r_ab6b368d82e72f0bde7c8a9cc60eb76f2"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab6b368d82e72f0bde7c8a9cc60eb76f2">fpader</a> (t, n, c, k1, x, l, d)</td></tr>
<tr class="separator:ab6b368d82e72f0bde7c8a9cc60eb76f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bcbf8cf99bfb2ac2f3834891c731be7" id="r_a9bcbf8cf99bfb2ac2f3834891c731be7"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9bcbf8cf99bfb2ac2f3834891c731be7">fpadno</a> (maxtr, up, left, right, info, count, merk, jbind, n1, ier)</td></tr>
<tr class="memdesc:a9bcbf8cf99bfb2ac2f3834891c731be7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a branch to the constraint-set binary tree.  <br /></td></tr>
<tr class="separator:a9bcbf8cf99bfb2ac2f3834891c731be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b4b656d4556778559ffea0d15d20e55" id="r_a8b4b656d4556778559ffea0d15d20e55"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8b4b656d4556778559ffea0d15d20e55">fpadpo</a> (idim, t, n, c, nc, k, cp, np, cc, t1, t2)</td></tr>
<tr class="memdesc:a8b4b656d4556778559ffea0d15d20e55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a polynomial curve to a spline curve in B-spline representation.  <br /></td></tr>
<tr class="separator:a8b4b656d4556778559ffea0d15d20e55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae590b9ba81851ee9d9c76e1fe127c0d1" id="r_ae590b9ba81851ee9d9c76e1fe127c0d1"><td class="memItemLeft" align="right" valign="top">pure real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, dimension(n)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae590b9ba81851ee9d9c76e1fe127c0d1">fpback</a> (a, z, n, k, nest)</td></tr>
<tr class="memdesc:ae590b9ba81851ee9d9c76e1fe127c0d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve an upper triangular banded system by back-substitution.  <br /></td></tr>
<tr class="separator:ae590b9ba81851ee9d9c76e1fe127c0d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7f22eea056465653c17c25aaf23b06f" id="r_ae7f22eea056465653c17c25aaf23b06f"><td class="memItemLeft" align="right" valign="top">pure real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, dimension(n)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7f22eea056465653c17c25aaf23b06f">fpbacp</a> (a, b, z, n, k, k1, nest)</td></tr>
<tr class="memdesc:ae7f22eea056465653c17c25aaf23b06f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve a bordered upper triangular system by back-substitution.  <br /></td></tr>
<tr class="separator:ae7f22eea056465653c17c25aaf23b06f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc0e64bf7c182c225873ce2bfac77ab1" id="r_acc0e64bf7c182c225873ce2bfac77ab1"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc0e64bf7c182c225873ce2bfac77ab1">fpbfou</a> (t, n, par, ress, resc)</td></tr>
<tr class="memdesc:acc0e64bf7c182c225873ce2bfac77ab1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Fourier coefficients of cubic B-splines.  <br /></td></tr>
<tr class="separator:acc0e64bf7c182c225873ce2bfac77ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72432bc4ebc7c5ff0425d188147d7dbb" id="r_a72432bc4ebc7c5ff0425d188147d7dbb"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a72432bc4ebc7c5ff0425d188147d7dbb">fpbisp</a> (tx, nx, ty, ny, c, kx, ky, x, mx, y, my, z, wx, wy, lx, ly)</td></tr>
<tr class="memdesc:a72432bc4ebc7c5ff0425d188147d7dbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate a tensor product spline on a grid.  <br /></td></tr>
<tr class="separator:a72432bc4ebc7c5ff0425d188147d7dbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5fb8acceffae7a31a838c1d7ff97d31" id="r_ac5fb8acceffae7a31a838c1d7ff97d31"><td class="memItemLeft" align="right" valign="top">pure real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, dimension(<a class="el" href="#a6c5b21fc23625ebfc7f555075c13eb07">max_order</a>+1)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac5fb8acceffae7a31a838c1d7ff97d31">fpbspl</a> (t, n, k, x, l)</td></tr>
<tr class="memdesc:ac5fb8acceffae7a31a838c1d7ff97d31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the non-zero B-splines at a given point.  <br /></td></tr>
<tr class="separator:ac5fb8acceffae7a31a838c1d7ff97d31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8705afed0d461ae20bf35a10b0579f5" id="r_ab8705afed0d461ae20bf35a10b0579f5"><td class="memItemLeft" align="right" valign="top">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab8705afed0d461ae20bf35a10b0579f5">fp_knot_interval</a> (t, x, l_start, l_max)</td></tr>
<tr class="memdesc:ab8705afed0d461ae20bf35a10b0579f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges, binary for large. This replaces the repeated pattern: do while (x &gt;= t(l+1) .and. l /= l_max) l = l + 1 end do.  <br /></td></tr>
<tr class="separator:ab8705afed0d461ae20bf35a10b0579f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e1011bf7749aa62d3c05bd1a20e36d1" id="r_a3e1011bf7749aa62d3c05bd1a20e36d1"><td class="memItemLeft" align="right" valign="top">pure integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3e1011bf7749aa62d3c05bd1a20e36d1">fpchec</a> (x, m, t, n, k)</td></tr>
<tr class="memdesc:a3e1011bf7749aa62d3c05bd1a20e36d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify knot positions against data points (Schoenberg-Whitney check).  <br /></td></tr>
<tr class="separator:a3e1011bf7749aa62d3c05bd1a20e36d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa29b4729274b28092dd2e3a338f21c" id="r_a7fa29b4729274b28092dd2e3a338f21c"><td class="memItemLeft" align="right" valign="top">pure integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7fa29b4729274b28092dd2e3a338f21c">fpched</a> (x, m, t, n, k, ib, ie)</td></tr>
<tr class="separator:a7fa29b4729274b28092dd2e3a338f21c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accaa1729715efbe04726699613597c32" id="r_accaa1729715efbe04726699613597c32"><td class="memItemLeft" align="right" valign="top">pure integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#accaa1729715efbe04726699613597c32">fpchep</a> (x, m, t, n, k)</td></tr>
<tr class="separator:accaa1729715efbe04726699613597c32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a899b48e5e372c91998b53c9f1959d177" id="r_a899b48e5e372c91998b53c9f1959d177"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a899b48e5e372c91998b53c9f1959d177">fpclos</a> (iopt, idim, m, u, mx, x, w, k, s, nest, tol, maxit, k1, k2, n, t, nc, c, fp, fpint, z, a1, a2, b, g1, g2, q, nrdata, ier)</td></tr>
<tr class="memdesc:a899b48e5e372c91998b53c9f1959d177"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core algorithm for closed (periodic) parametric curve fitting.  <br /></td></tr>
<tr class="separator:a899b48e5e372c91998b53c9f1959d177"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae099a69d7fc431841d2de41c38e4fcab" id="r_ae099a69d7fc431841d2de41c38e4fcab"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae099a69d7fc431841d2de41c38e4fcab">fpclos_reset_interp</a> (idim, k, m, mx, n, nc, nest, kk, kk1, u, x, t, c, fp, per, fp0, s, fpint, nrdata, done)</td></tr>
<tr class="separator:ae099a69d7fc431841d2de41c38e4fcab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4003dce07901ef7e9b8db9bb2a45b97c" id="r_a4003dce07901ef7e9b8db9bb2a45b97c"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4003dce07901ef7e9b8db9bb2a45b97c">fpcoco</a> (iopt, m, x, y, w, v, s, nest, maxtr, maxbin, n, t, c, sq, sx, bind, e, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:a4003dce07901ef7e9b8db9bb2a45b97c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a convexity-constrained cubic smoothing spline.  <br /></td></tr>
<tr class="separator:a4003dce07901ef7e9b8db9bb2a45b97c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17a3995cbff15ef64c241c059a40e682" id="r_a17a3995cbff15ef64c241c059a40e682"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17a3995cbff15ef64c241c059a40e682">fpcons</a> (iopt, idim, m, u, mx, x, w, ib, ie, k, s, nest, tol, maxit, k1, k2, n, t, nc, c, fp, fpint, z, a, b, g, q, nrdata, ier)</td></tr>
<tr class="memdesc:a17a3995cbff15ef64c241c059a40e682"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core algorithm for constrained parametric curve fitting.  <br /></td></tr>
<tr class="separator:a17a3995cbff15ef64c241c059a40e682"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a896928a4fbb29c241426ae61e5f2e69c" id="r_a896928a4fbb29c241426ae61e5f2e69c"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a896928a4fbb29c241426ae61e5f2e69c">fpcosp</a> (m, x, y, w, n, t, e, maxtr, maxbin, c, sq, sx, bind, nm, mb, a, b, const, z, zz, u, q, info, up, left, right, jbind, ibind, ier)</td></tr>
<tr class="memdesc:a896928a4fbb29c241426ae61e5f2e69c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core algorithm for convexity-constrained cubic spline fitting.  <br /></td></tr>
<tr class="separator:a896928a4fbb29c241426ae61e5f2e69c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c6900d3b80033043b2b73b49ce84fc2" id="r_a8c6900d3b80033043b2b73b49ce84fc2"><td class="memItemLeft" align="right" valign="top">pure elemental subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c6900d3b80033043b2b73b49ce84fc2">fpcsin</a> (a, b, par, sia, coa, sib, cob, ress, resc)</td></tr>
<tr class="memdesc:a8c6900d3b80033043b2b73b49ce84fc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute weighted Fourier integrals of a cubic polynomial.  <br /></td></tr>
<tr class="separator:a8c6900d3b80033043b2b73b49ce84fc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4763622af119a94c3be9390ee5d12eb3" id="r_a4763622af119a94c3be9390ee5d12eb3"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4763622af119a94c3be9390ee5d12eb3">fpcurf</a> (iopt, x, y, w, m, xb, xe, k, s, nest, tol, maxit, k1, k2, n, t, c, fp, fpint, z, a, b, g, q, nrdata, ier)</td></tr>
<tr class="memdesc:a4763622af119a94c3be9390ee5d12eb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core algorithm for univariate spline curve fitting.  <br /></td></tr>
<tr class="separator:a4763622af119a94c3be9390ee5d12eb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef57b5a3a930e0c3aa2eeb311b571aa6" id="r_aef57b5a3a930e0c3aa2eeb311b571aa6"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aef57b5a3a930e0c3aa2eeb311b571aa6">fpcuro</a> (a, b, c, d, x, n)</td></tr>
<tr class="memdesc:aef57b5a3a930e0c3aa2eeb311b571aa6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the real zeros of a cubic polynomial.  <br /></td></tr>
<tr class="separator:aef57b5a3a930e0c3aa2eeb311b571aa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95f95a1ab846dcf0b4035058fdde4bad" id="r_a95f95a1ab846dcf0b4035058fdde4bad"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a95f95a1ab846dcf0b4035058fdde4bad">fpcyt1</a> (a, n, nn)</td></tr>
<tr class="memdesc:a95f95a1ab846dcf0b4035058fdde4bad"><td class="mdescLeft">&#160;</td><td class="mdescRight">LU-decompose a cyclic tridiagonal matrix.  <br /></td></tr>
<tr class="separator:a95f95a1ab846dcf0b4035058fdde4bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3781580dd8295b2e2a32266fd0fcf027" id="r_a3781580dd8295b2e2a32266fd0fcf027"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3781580dd8295b2e2a32266fd0fcf027">fpcyt2</a> (a, n, b, c, nn)</td></tr>
<tr class="memdesc:a3781580dd8295b2e2a32266fd0fcf027"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve a cyclic tridiagonal system using LU factors from fpcyt1.  <br /></td></tr>
<tr class="separator:a3781580dd8295b2e2a32266fd0fcf027"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d82ac791ec6ae19e9b4671ffb734e0" id="r_ad5d82ac791ec6ae19e9b4671ffb734e0"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5d82ac791ec6ae19e9b4671ffb734e0">fpdeno</a> (maxtr, up, left, right, nbind, merk)</td></tr>
<tr class="memdesc:ad5d82ac791ec6ae19e9b4671ffb734e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prune short branches from the constraint-set binary tree.  <br /></td></tr>
<tr class="separator:ad5d82ac791ec6ae19e9b4671ffb734e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57fba861443159865065312aa46b6627" id="r_a57fba861443159865065312aa46b6627"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57fba861443159865065312aa46b6627">fpdisc</a> (t, n, k2, b, nest)</td></tr>
<tr class="memdesc:a57fba861443159865065312aa46b6627"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the discontinuity jumps of the B-spline derivatives.  <br /></td></tr>
<tr class="separator:a57fba861443159865065312aa46b6627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8006d449287383c5f5c4151086e9a376" id="r_a8006d449287383c5f5c4151086e9a376"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8006d449287383c5f5c4151086e9a376">fpfrno</a> (maxtr, up, left, right, info, point, merk, n1, count, ier)</td></tr>
<tr class="memdesc:a8006d449287383c5f5c4151086e9a376"><td class="mdescLeft">&#160;</td><td class="mdescRight">Collect free nodes from the constraint-set binary tree.  <br /></td></tr>
<tr class="separator:a8006d449287383c5f5c4151086e9a376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee86d7e7c8bbb38a98dd2dff92861293" id="r_aee86d7e7c8bbb38a98dd2dff92861293"><td class="memItemLeft" align="right" valign="top">elemental subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aee86d7e7c8bbb38a98dd2dff92861293">fpgivs</a> (piv, ww, cos, sin)</td></tr>
<tr class="memdesc:aee86d7e7c8bbb38a98dd2dff92861293"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute parameters of a Givens plane rotation.  <br /></td></tr>
<tr class="separator:aee86d7e7c8bbb38a98dd2dff92861293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ec4c90b00749bb021a6ec2f3433781" id="r_ab4ec4c90b00749bb021a6ec2f3433781"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab4ec4c90b00749bb021a6ec2f3433781">fp_rotate_row</a> (h, band, a, yi, z, j_start)</td></tr>
<tr class="memdesc:ab4ec4c90b00749bb021a6ec2f3433781"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate an observation row into the upper triangular band matrix.  <br /></td></tr>
<tr class="separator:ab4ec4c90b00749bb021a6ec2f3433781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82db002de9c1abeba86fae180dbec079" id="r_a82db002de9c1abeba86fae180dbec079"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a82db002de9c1abeba86fae180dbec079">fp_rotate_row_vec</a> (h, band, a, nest, xi, z, j_start, n, idim)</td></tr>
<tr class="memdesc:a82db002de9c1abeba86fae180dbec079"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate an observation row into a band matrix with vector RHS.  <br /></td></tr>
<tr class="separator:a82db002de9c1abeba86fae180dbec079"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa452051613d61831a99b2f9ef8e21bc8" id="r_aa452051613d61831a99b2f9ef8e21bc8"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa452051613d61831a99b2f9ef8e21bc8">fp_rotate_shifted</a> (h, band, a, nest, yi, z, j_start, j_end)</td></tr>
<tr class="memdesc:aa452051613d61831a99b2f9ef8e21bc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a smoothing-matrix row into a band matrix using shifted pivots.  <br /></td></tr>
<tr class="separator:aa452051613d61831a99b2f9ef8e21bc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73c05ec35eef6da81086156d5cf0597d" id="r_a73c05ec35eef6da81086156d5cf0597d"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73c05ec35eef6da81086156d5cf0597d">fp_rotate_shifted_vec</a> (h, band, a, nest, xi, z, j_start, j_end, n, idim)</td></tr>
<tr class="memdesc:a73c05ec35eef6da81086156d5cf0597d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a smoothing-matrix row into a band matrix with vector RHS.  <br /></td></tr>
<tr class="separator:a73c05ec35eef6da81086156d5cf0597d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b4564b1b6353e60d0808091e9efa2e0" id="r_a8b4564b1b6353e60d0808091e9efa2e0"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8b4564b1b6353e60d0808091e9efa2e0">fp_rotate_row_2mat_vec</a> (h1, band1, h2, band2, a1, a2, nest, xi, z, j1_start, j1_end, n, idim)</td></tr>
<tr class="memdesc:a8b4564b1b6353e60d0808091e9efa2e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a split observation row into the block-triangular periodic system with vector RHS.  <br /></td></tr>
<tr class="separator:a8b4564b1b6353e60d0808091e9efa2e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3c656c52c7e12d25083b56910547f2c" id="r_ab3c656c52c7e12d25083b56910547f2c"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3c656c52c7e12d25083b56910547f2c">fp_rotate_row_2mat</a> (h1, band1, h2, band2, a1, a2, nest, yi, z, j1_start, j1_end)</td></tr>
<tr class="memdesc:ab3c656c52c7e12d25083b56910547f2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a split observation row into the block-triangular periodic system with scalar RHS.  <br /></td></tr>
<tr class="separator:ab3c656c52c7e12d25083b56910547f2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed0bf32d459d0a6b5f61a5f43b4a038d" id="r_aed0bf32d459d0a6b5f61a5f43b4a038d"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed0bf32d459d0a6b5f61a5f43b4a038d">fp_rotate_row_block</a> (h, band, a, na, right, q, nrhs, irot_start)</td></tr>
<tr class="memdesc:aed0bf32d459d0a6b5f61a5f43b4a038d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a row into a band matrix with contiguous-block RHS.  <br /></td></tr>
<tr class="separator:aed0bf32d459d0a6b5f61a5f43b4a038d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa701068a010acc01614dbdb3d2d0af77" id="r_aa701068a010acc01614dbdb3d2d0af77"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa701068a010acc01614dbdb3d2d0af77">fp_rotate_row_stride</a> (h, band, a, na, right, c, ldc, nrhs, irot_start)</td></tr>
<tr class="memdesc:aa701068a010acc01614dbdb3d2d0af77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a row into a band matrix with stride (row-access) RHS.  <br /></td></tr>
<tr class="separator:aa701068a010acc01614dbdb3d2d0af77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abba3243913c5e568249cd4d789a2b1d2" id="r_abba3243913c5e568249cd4d789a2b1d2"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abba3243913c5e568249cd4d789a2b1d2">fp_rotate_2mat_stride</a> (h1, band1, h2, band2, a1, a2, na, right, c, ldc, nrhs, j1_start, j1_end)</td></tr>
<tr class="memdesc:abba3243913c5e568249cd4d789a2b1d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a split row into the block-triangular periodic system with stride RHS.  <br /></td></tr>
<tr class="separator:abba3243913c5e568249cd4d789a2b1d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03d606165767f7703429cb55181efe11" id="r_a03d606165767f7703429cb55181efe11"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a03d606165767f7703429cb55181efe11">fpgrdi</a> (ifsu, ifsv, ifbu, ifbv, lback, u, mu, v, mv, z, mz, dz, iop0, iop1, tu, nu, tv, nv, p, c, nc, sq, fp, fpu, fpv, mm, mvnu, spu, spv, right, q, au, av1, av2, bu, bv, aa, bb, cc, cosi, nru, nrv)</td></tr>
<tr class="memdesc:a03d606165767f7703429cb55181efe11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute spline coefficients on a polar/spherical grid via Kronecker product.  <br /></td></tr>
<tr class="separator:a03d606165767f7703429cb55181efe11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cc8f44b08134a5a84ab88c44e86485d" id="r_a0cc8f44b08134a5a84ab88c44e86485d"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cc8f44b08134a5a84ab88c44e86485d">fpgrpa</a> (ifsu, ifsv, ifbu, ifbv, idim, ipar, u, mu, v, mv, z, mz, tu, nu, tv, nv, p, c, nc, fp, fpu, fpv, mm, mvnu, spu, spv, right, q, au, au1, av, av1, bu, bv, nru, nrv)</td></tr>
<tr class="memdesc:a0cc8f44b08134a5a84ab88c44e86485d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute parametric surface spline coefficients on a grid.  <br /></td></tr>
<tr class="separator:a0cc8f44b08134a5a84ab88c44e86485d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78b0d9c28e76eff73dcf956f4811c257" id="r_a78b0d9c28e76eff73dcf956f4811c257"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a78b0d9c28e76eff73dcf956f4811c257">fpgrre</a> (ifsx, ifsy, ifbx, ifby, x, mx, y, my, z, mz, kx, ky, tx, nx, ty, ny, p, c, nc, fp, fpx, fpy, mm, mynx, kx1, kx2, ky1, ky2, spx, spy, right, q, ax, ay, bx, by, nrx, nry)</td></tr>
<tr class="memdesc:a78b0d9c28e76eff73dcf956f4811c257"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute grid-based spline coefficients via Kronecker product decomposition.  <br /></td></tr>
<tr class="separator:a78b0d9c28e76eff73dcf956f4811c257"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a11f85ace5b032c95c53307fa47913" id="r_a74a11f85ace5b032c95c53307fa47913"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74a11f85ace5b032c95c53307fa47913">fpgrsp</a> (ifsu, ifsv, ifbu, ifbv, lback, u, mu, v, mv, r, mr, dr, iop0, iop1, tu, nu, tv, nv, p, c, nc, sq, fp, fpu, fpv, mm, mvnu, spu, spv, right, q, au, av1, av2, bu, bv, a0, a1, b0, b1, c0, c1, cosi, nru, nrv)</td></tr>
<tr class="memdesc:a74a11f85ace5b032c95c53307fa47913"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute spherical grid spline coefficients via Kronecker product.  <br /></td></tr>
<tr class="separator:a74a11f85ace5b032c95c53307fa47913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d51410017bf94f298da66b1d80fe524" id="r_a3d51410017bf94f298da66b1d80fe524"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3d51410017bf94f298da66b1d80fe524">fpinst</a> (iopt, t, n, c, k, x, l, tt, nn, cc, nest)</td></tr>
<tr class="memdesc:a3d51410017bf94f298da66b1d80fe524"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a single knot into a B-spline representation.  <br /></td></tr>
<tr class="separator:a3d51410017bf94f298da66b1d80fe524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa4be60a77a5e3a8b9e0013517b221b2" id="r_aaa4be60a77a5e3a8b9e0013517b221b2"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa4be60a77a5e3a8b9e0013517b221b2">fpintb</a> (t, n, bint, nk1, x, y)</td></tr>
<tr class="memdesc:aaa4be60a77a5e3a8b9e0013517b221b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute definite integrals of the normalized B-splines.  <br /></td></tr>
<tr class="separator:aaa4be60a77a5e3a8b9e0013517b221b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8357b7623d6629bc3663f8023fcd6666" id="r_a8357b7623d6629bc3663f8023fcd6666"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8357b7623d6629bc3663f8023fcd6666">fpknot</a> (x, m, t, n, fpint, nrdata, nrint, nest, istart)</td></tr>
<tr class="memdesc:a8357b7623d6629bc3663f8023fcd6666"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select and insert a new knot at the location of maximum residual.  <br /></td></tr>
<tr class="separator:a8357b7623d6629bc3663f8023fcd6666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a9d1d759c2a6d39e91039f904c923b" id="r_a07a9d1d759c2a6d39e91039f904c923b"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a07a9d1d759c2a6d39e91039f904c923b">fpopdi</a> (ifsu, ifsv, ifbu, ifbv, u, mu, v, mv, z, mz, z0, dz, iopt, ider, tu, nu, tv, nv, nuest, nvest, p, step, c, nc, fp, fpu, fpv, nru, nrv, wrk, lwrk)</td></tr>
<tr class="memdesc:a07a9d1d759c2a6d39e91039f904c923b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute smoothing spline on a polar grid with origin constraints.  <br /></td></tr>
<tr class="separator:a07a9d1d759c2a6d39e91039f904c923b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a383ad79ef10f0ff29a9122c3f736178e" id="r_a383ad79ef10f0ff29a9122c3f736178e"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a383ad79ef10f0ff29a9122c3f736178e">fpopsp</a> (ifsu, ifsv, ifbu, ifbv, u, mu, v, mv, r, mr, r0, r1, dr, iopt, ider, tu, nu, tv, nv, nuest, nvest, p, step, c, nc, fp, fpu, fpv, nru, nrv, wrk, lwrk)</td></tr>
<tr class="memdesc:a383ad79ef10f0ff29a9122c3f736178e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute smoothing spline on a spherical grid with pole constraints.  <br /></td></tr>
<tr class="separator:a383ad79ef10f0ff29a9122c3f736178e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000e6860b30d66fcc8bf487d934c0f28" id="r_a000e6860b30d66fcc8bf487d934c0f28"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a000e6860b30d66fcc8bf487d934c0f28">fporde</a> (x, y, m, kx, ky, tx, nx, ty, ny, nummer, index, nreg)</td></tr>
<tr class="memdesc:a000e6860b30d66fcc8bf487d934c0f28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sort scattered data points into rectangular panels.  <br /></td></tr>
<tr class="separator:a000e6860b30d66fcc8bf487d934c0f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e667cdc0bc06d8fcf33ec1b61fe50a6" id="r_a5e667cdc0bc06d8fcf33ec1b61fe50a6"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e667cdc0bc06d8fcf33ec1b61fe50a6">fppara</a> (iopt, idim, m, u, mx, x, w, ub, ue, k, s, nest, tol, maxit, k1, k2, n, t, nc, c, fp, fpint, z, a, b, g, q, nrdata, ier)</td></tr>
<tr class="memdesc:a5e667cdc0bc06d8fcf33ec1b61fe50a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core algorithm for open parametric curve fitting.  <br /></td></tr>
<tr class="separator:a5e667cdc0bc06d8fcf33ec1b61fe50a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19127c353493bb69ea3a6c3c382895d7" id="r_a19127c353493bb69ea3a6c3c382895d7"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a19127c353493bb69ea3a6c3c382895d7">fppasu</a> (iopt, ipar, idim, u, mu, v, mv, z, mz, s, nuest, nvest, tol, maxit, nc, nu, tu, nv, tv, c, fp, fp0, fpold, reducu, reducv, fpintu, fpintv, lastdi, nplusu, nplusv, nru, nrv, nrdatu, nrdatv, wrk, lwrk, ier)</td></tr>
<tr class="memdesc:a19127c353493bb69ea3a6c3c382895d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core algorithm for parametric surface fitting on a grid.  <br /></td></tr>
<tr class="separator:a19127c353493bb69ea3a6c3c382895d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a408ada754639be78ba19d10d4e92d560" id="r_a408ada754639be78ba19d10d4e92d560"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a408ada754639be78ba19d10d4e92d560">fpperi</a> (iopt, x, y, w, m, k, s, nest, tol, maxit, k1, k2, n, t, c, fp, fpint, z, a1, a2, b, g1, g2, q, nrdata, ier)</td></tr>
<tr class="memdesc:a408ada754639be78ba19d10d4e92d560"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core algorithm for univariate periodic spline fitting.  <br /></td></tr>
<tr class="separator:a408ada754639be78ba19d10d4e92d560"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58bbdfcdf11801b4bacf532b022a2815" id="r_a58bbdfcdf11801b4bacf532b022a2815"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a58bbdfcdf11801b4bacf532b022a2815">fpperi_reset_interp</a> (k, m, n, nest, kk, kk1, x, y, t, c, fp, per, fp0, s, fpint, nrdata, done)</td></tr>
<tr class="separator:a58bbdfcdf11801b4bacf532b022a2815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c1c9269f27beeddee5d8b680aaa7140" id="r_a1c1c9269f27beeddee5d8b680aaa7140"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1c1c9269f27beeddee5d8b680aaa7140">fppocu</a> (idim, k, a, b, ib, db, nb, ie, de, ne, cp, np)</td></tr>
<tr class="memdesc:a1c1c9269f27beeddee5d8b680aaa7140"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a polynomial curve satisfying endpoint derivative constraints.  <br /></td></tr>
<tr class="separator:a1c1c9269f27beeddee5d8b680aaa7140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a3d9c76b5b016414056f18b807aa39f" id="r_a3a3d9c76b5b016414056f18b807aa39f"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3a3d9c76b5b016414056f18b807aa39f">fppogr</a> (iopt, ider, u, mu, v, mv, z, mz, z0, r, s, nuest, nvest, tol, maxit, nc, nu, tu, nv, tv, c, fp, fp0, fpold, reducu, reducv, fpintu, fpintv, dz, step, lastdi, nplusu, nplusv, lasttu, nru, nrv, nrdatu, nrdatv, wrk, lwrk, ier)</td></tr>
<tr class="memdesc:a3a3d9c76b5b016414056f18b807aa39f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver for polar grid smoothing spline with knot selection.  <br /></td></tr>
<tr class="separator:a3a3d9c76b5b016414056f18b807aa39f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac854d9583be2e3e162a00fd43dc20314" id="r_ac854d9583be2e3e162a00fd43dc20314"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac854d9583be2e3e162a00fd43dc20314">fppola</a> (iopt1, iopt2, iopt3, m, u, v, z, w, rad, s, nuest, nvest, eta, tol, maxit, ib1, ib3, nc, ncc, intest, nrest, nu, tu, nv, tv, c, fp, sup, fpint, coord, f, ff, row, cs, cosi, a, q, bu, bv, spu, spv, h, index, nummer, wrk, lwrk, ier)</td></tr>
<tr class="memdesc:ac854d9583be2e3e162a00fd43dc20314"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core algorithm for spline fitting on a polar domain.  <br /></td></tr>
<tr class="separator:ac854d9583be2e3e162a00fd43dc20314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd90889b0d56592815337f99a849bc7a" id="r_afd90889b0d56592815337f99a849bc7a"><td class="memItemLeft" align="right" valign="top">elemental subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afd90889b0d56592815337f99a849bc7a">root_finding_iterate</a> (p1, f1, p2, f2, p3, f3, p, fpms, acc, check1, check3, success)</td></tr>
<tr class="separator:afd90889b0d56592815337f99a849bc7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab08555e9bd2f44d1461e09ba35a7bb22" id="r_ab08555e9bd2f44d1461e09ba35a7bb22"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab08555e9bd2f44d1461e09ba35a7bb22">fprank</a> (a, f, n, m, na, tol, c, sq, rank, aa, ff, h)</td></tr>
<tr class="memdesc:ab08555e9bd2f44d1461e09ba35a7bb22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the minimum-norm least-squares solution under rank deficiency.  <br /></td></tr>
<tr class="separator:ab08555e9bd2f44d1461e09ba35a7bb22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefb269f6c2a494ba69c10e93334def66" id="r_aefb269f6c2a494ba69c10e93334def66"><td class="memItemLeft" align="right" valign="top">elemental subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aefb269f6c2a494ba69c10e93334def66">fprati</a> (p1, f1, p2, f2, p3, f3, p)</td></tr>
<tr class="memdesc:aefb269f6c2a494ba69c10e93334def66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rational interpolation for the smoothing parameter search.  <br /></td></tr>
<tr class="separator:aefb269f6c2a494ba69c10e93334def66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26879f854f0e23671e8fd07f9f144410" id="r_a26879f854f0e23671e8fd07f9f144410"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26879f854f0e23671e8fd07f9f144410">fpregr</a> (iopt, x, mx, y, my, z, mz, xb, xe, yb, ye, kx, ky, s, nxest, nyest, tol, maxit, nc, nx, tx, ny, ty, c, fp, fp0, fpold, reducx, reducy, fpintx, fpinty, lastdi, nplusx, nplusy, nrx, nry, nrdatx, nrdaty, wrk, lwrk, ier)</td></tr>
<tr class="memdesc:a26879f854f0e23671e8fd07f9f144410"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver for rectangular grid smoothing surface with knot selection.  <br /></td></tr>
<tr class="separator:a26879f854f0e23671e8fd07f9f144410"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c4fa92fbc6556a21d112fbdfbd0f80f" id="r_a8c4fa92fbc6556a21d112fbdfbd0f80f"><td class="memItemLeft" align="right" valign="top">elemental integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c4fa92fbc6556a21d112fbdfbd0f80f">new_knot_dimension</a> (n1, n1add, n1max, n2, n2add, n2max, last)</td></tr>
<tr class="separator:a8c4fa92fbc6556a21d112fbdfbd0f80f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3804afa034c5c78f99a71f867d53de7c" id="r_a3804afa034c5c78f99a71f867d53de7c"><td class="memItemLeft" align="right" valign="top">elemental subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3804afa034c5c78f99a71f867d53de7c">fprota</a> (cos, sin, a, b)</td></tr>
<tr class="memdesc:a3804afa034c5c78f99a71f867d53de7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a Givens plane rotation to two scalars.  <br /></td></tr>
<tr class="separator:a3804afa034c5c78f99a71f867d53de7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85e2e23efd601e9e1e28c0195664dd16" id="r_a85e2e23efd601e9e1e28c0195664dd16"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85e2e23efd601e9e1e28c0195664dd16">fprppo</a> (nu, nv, if1, if2, cosi, ratio, c, f, ncoff)</td></tr>
<tr class="memdesc:a85e2e23efd601e9e1e28c0195664dd16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert constrained polar spline coefficients to standard form.  <br /></td></tr>
<tr class="separator:a85e2e23efd601e9e1e28c0195664dd16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd769a20c06ac85da1866ea8ac3e98c" id="r_a4bd769a20c06ac85da1866ea8ac3e98c"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4bd769a20c06ac85da1866ea8ac3e98c">fprpsp</a> (nt, np, co, si, c, f, ncoff)</td></tr>
<tr class="memdesc:a4bd769a20c06ac85da1866ea8ac3e98c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert constrained spherical spline coefficients to standard form.  <br /></td></tr>
<tr class="separator:a4bd769a20c06ac85da1866ea8ac3e98c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a535f9e04981c794c70a60f728e918472" id="r_a535f9e04981c794c70a60f728e918472"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a535f9e04981c794c70a60f728e918472">fpseno</a> (maxtr, up, left, right, info, merk, ibind, nbind)</td></tr>
<tr class="memdesc:a535f9e04981c794c70a60f728e918472"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fetch and advance to the next branch in the constraint-set tree.  <br /></td></tr>
<tr class="separator:a535f9e04981c794c70a60f728e918472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2fd0d6545f3ff0cc2019428c3d5ad38" id="r_ae2fd0d6545f3ff0cc2019428c3d5ad38"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae2fd0d6545f3ff0cc2019428c3d5ad38">fpspgr</a> (iopt, ider, u, mu, v, mv, r, mr, r0, r1, s, nuest, nvest, tol, maxit, nc, nu, tu, nv, tv, c, fp, fp0, fpold, reducu, reducv, fpintu, fpintv, dr, step, lastdi, nplusu, nplusv, lastu0, lastu1, nru, nrv, nrdatu, nrdatv, wrk, lwrk, ier)</td></tr>
<tr class="memdesc:ae2fd0d6545f3ff0cc2019428c3d5ad38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver for spherical grid smoothing spline with knot selection.  <br /></td></tr>
<tr class="separator:ae2fd0d6545f3ff0cc2019428c3d5ad38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b16cd0ae09d295a9bdf3723c10db8e7" id="r_a6b16cd0ae09d295a9bdf3723c10db8e7"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b16cd0ae09d295a9bdf3723c10db8e7">fpsphe</a> (iopt, m, teta, phi, r, w, s, ntest, npest, eta, tol, maxit, ib1, ib3, nc, ncc, intest, nrest, nt, tt, np, tp, c, fp, sup, fpint, coord, f, ff, row, coco, cosi, a, q, bt, bp, spt, spp, h, index, nummer, wrk, lwrk, ier)</td></tr>
<tr class="memdesc:a6b16cd0ae09d295a9bdf3723c10db8e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core algorithm for spline fitting on the sphere.  <br /></td></tr>
<tr class="separator:a6b16cd0ae09d295a9bdf3723c10db8e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93f9263090199970a23f6dfca11227cf" id="r_a93f9263090199970a23f6dfca11227cf"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93f9263090199970a23f6dfca11227cf">fpsuev</a> (idim, tu, nu, tv, nv, c, u, mu, v, mv, f, wu, wv, lu, lv)</td></tr>
<tr class="separator:a93f9263090199970a23f6dfca11227cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a999c5b98cb9e681f3045c39c6dea7151" id="r_a999c5b98cb9e681f3045c39c6dea7151"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a999c5b98cb9e681f3045c39c6dea7151">fpsurf</a> (iopt, m, x, y, z, w, xb, xe, yb, ye, kxx, kyy, s, nxest, nyest, eta, tol, maxit, nmax, km1, km2, ib1, ib3, nc, intest, nrest, nx0, tx, ny0, ty, c, fp, fp0, fpint, coord, f, ff, a, q, bx, by, spx, spy, h, index, nummer, wrk, lwrk, ier)</td></tr>
<tr class="memdesc:a999c5b98cb9e681f3045c39c6dea7151"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core algorithm for bivariate tensor-product spline surface fitting.  <br /></td></tr>
<tr class="separator:a999c5b98cb9e681f3045c39c6dea7151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0055c06b11885b09b3da8a5b9b24d0bb" id="r_a0055c06b11885b09b3da8a5b9b24d0bb"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0055c06b11885b09b3da8a5b9b24d0bb">fpsysy</a> (a, n, g)</td></tr>
<tr class="memdesc:a0055c06b11885b09b3da8a5b9b24d0bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve a small symmetric linear system by Cholesky factorization.  <br /></td></tr>
<tr class="separator:a0055c06b11885b09b3da8a5b9b24d0bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20ca1b341438d801bc6903c35d1d0e20" id="r_a20ca1b341438d801bc6903c35d1d0e20"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a20ca1b341438d801bc6903c35d1d0e20">fptrnp</a> (m, mm, idim, n, nr, sp, p, b, z, a, q, right)</td></tr>
<tr class="memdesc:a20ca1b341438d801bc6903c35d1d0e20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Triangularize the tensor-product system for non-periodic grids.  <br /></td></tr>
<tr class="separator:a20ca1b341438d801bc6903c35d1d0e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca070414f01b6af3f396f8f3d12bc499" id="r_aca070414f01b6af3f396f8f3d12bc499"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca070414f01b6af3f396f8f3d12bc499">fptrpe</a> (m, mm, idim, n, nr, sp, p, b, z, a, aa, q, right)</td></tr>
<tr class="memdesc:aca070414f01b6af3f396f8f3d12bc499"><td class="mdescLeft">&#160;</td><td class="mdescRight">Triangularize the tensor-product system for periodic grids.  <br /></td></tr>
<tr class="separator:aca070414f01b6af3f396f8f3d12bc499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a396967312954458c7a650aa76ea906" id="r_a4a396967312954458c7a650aa76ea906"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a396967312954458c7a650aa76ea906">insert</a> (iopt, t, n, c, k, x, tt, nn, cc, nest, ier)</td></tr>
<tr class="memdesc:a4a396967312954458c7a650aa76ea906"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a single knot into a spline, returning a new B-spline representation.  <br /></td></tr>
<tr class="separator:a4a396967312954458c7a650aa76ea906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5408515a66457ab26ce615842e24a526" id="r_a5408515a66457ab26ce615842e24a526"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5408515a66457ab26ce615842e24a526">insert_inplace</a> (iopt, t, n, c, k, x, nest, ier)</td></tr>
<tr class="memdesc:a5408515a66457ab26ce615842e24a526"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a single knot into a spline in place (avoiding aliasing issues).  <br /></td></tr>
<tr class="separator:a5408515a66457ab26ce615842e24a526"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2ad7fd4cae431c05938a167488df6f0" id="r_ae2ad7fd4cae431c05938a167488df6f0"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae2ad7fd4cae431c05938a167488df6f0">parcur</a> (iopt, ipar, idim, m, u, mx, x, w, ub, ue, k, s, nest, n, t, nc, c, fp, wrk, lwrk, iwrk, ier)</td></tr>
<tr class="memdesc:ae2ad7fd4cae431c05938a167488df6f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine a smooth parametric spline curve approximation.  <br /></td></tr>
<tr class="separator:ae2ad7fd4cae431c05938a167488df6f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01477d82a007d0853de3bc8247ef8c27" id="r_a01477d82a007d0853de3bc8247ef8c27"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a01477d82a007d0853de3bc8247ef8c27">parder</a> (tx, nx, ty, ny, c, kx, ky, nux, nuy, x, mx, y, my, z, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:a01477d82a007d0853de3bc8247ef8c27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate a partial derivative of a bivariate spline on a rectangular grid.  <br /></td></tr>
<tr class="separator:a01477d82a007d0853de3bc8247ef8c27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fd21985777d3dd9a85782026ff7aeba" id="r_a1fd21985777d3dd9a85782026ff7aeba"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1fd21985777d3dd9a85782026ff7aeba">pardeu</a> (tx, nx, ty, ny, c, kx, ky, nux, nuy, x, y, z, m, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:a1fd21985777d3dd9a85782026ff7aeba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate a partial derivative of a bivariate spline at scattered points.  <br /></td></tr>
<tr class="separator:a1fd21985777d3dd9a85782026ff7aeba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae277d8a029f43ac5702946468c8bd54f" id="r_ae277d8a029f43ac5702946468c8bd54f"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae277d8a029f43ac5702946468c8bd54f">pardtc</a> (tx, nx, ty, ny, c, kx, ky, nux, nuy, newc, ier)</td></tr>
<tr class="memdesc:ae277d8a029f43ac5702946468c8bd54f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transform B-spline coefficients to obtain the partial derivative spline.  <br /></td></tr>
<tr class="separator:ae277d8a029f43ac5702946468c8bd54f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a900e08c9d4a7e79e93c9c25c80ad967b" id="r_a900e08c9d4a7e79e93c9c25c80ad967b"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a900e08c9d4a7e79e93c9c25c80ad967b">parsur</a> (iopt, ipar, idim, mu, u, mv, v, f, s, nuest, nvest, nu, tu, nv, tv, c, fp, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:a900e08c9d4a7e79e93c9c25c80ad967b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a smooth parametric surface to gridded data.  <br /></td></tr>
<tr class="separator:a900e08c9d4a7e79e93c9c25c80ad967b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0afe8a4afa89245ec1ec1447ef7b556" id="r_ad0afe8a4afa89245ec1ec1447ef7b556"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad0afe8a4afa89245ec1ec1447ef7b556">percur</a> (iopt, m, x, y, w, k, s, nest, n, t, c, fp, wrk, lwrk, iwrk, ier)</td></tr>
<tr class="memdesc:ad0afe8a4afa89245ec1ec1447ef7b556"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine a smooth periodic spline approximation to data.  <br /></td></tr>
<tr class="separator:ad0afe8a4afa89245ec1ec1447ef7b556"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11ecdd724a417576c9d5529941633da4" id="r_a11ecdd724a417576c9d5529941633da4"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a11ecdd724a417576c9d5529941633da4">pogrid</a> (iopt, ider, mu, u, mv, v, z, z0, r, s, nuest, nvest, nu, tu, nv, tv, c, fp, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:a11ecdd724a417576c9d5529941633da4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a smooth bivariate spline to gridded data on a polar (disc) domain.  <br /></td></tr>
<tr class="separator:a11ecdd724a417576c9d5529941633da4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a406065ef7b15f1380c2759e9650355f2" id="r_a406065ef7b15f1380c2759e9650355f2"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a406065ef7b15f1380c2759e9650355f2">polar</a> (iopt, m, x, y, z, w, rad, s, nuest, nvest, eps, nu, tu, nv, tv, u, v, c, fp, wrk1, lwrk1, wrk2, lwrk2, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:a406065ef7b15f1380c2759e9650355f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a smooth bivariate spline to scattered data on a polar domain.  <br /></td></tr>
<tr class="separator:a406065ef7b15f1380c2759e9650355f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ea4ba8b0cda533eb078e95b28d782db" id="r_a7ea4ba8b0cda533eb078e95b28d782db"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7ea4ba8b0cda533eb078e95b28d782db">profil</a> (iopt, tx, nx, ty, ny, c, kx, ky, u, nu, cu, ier)</td></tr>
<tr class="memdesc:a7ea4ba8b0cda533eb078e95b28d782db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract a cross-section (profile) of a bivariate spline.  <br /></td></tr>
<tr class="separator:a7ea4ba8b0cda533eb078e95b28d782db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba4c1c277c572cad2725b326b896ef8" id="r_adba4c1c277c572cad2725b326b896ef8"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adba4c1c277c572cad2725b326b896ef8">regrid</a> (iopt, mx, x, my, y, z, xb, xe, yb, ye, kx, ky, s, nxest, nyest, nx, tx, ny, ty, c, fp, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:adba4c1c277c572cad2725b326b896ef8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a smoothing bivariate spline to data on a rectangular grid.  <br /></td></tr>
<tr class="separator:adba4c1c277c572cad2725b326b896ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c64b88d2d403641e200a68c9604f425" id="r_a0c64b88d2d403641e200a68c9604f425"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c64b88d2d403641e200a68c9604f425">spalde</a> (t, n, c, k1, x, d, ier)</td></tr>
<tr class="memdesc:a0c64b88d2d403641e200a68c9604f425"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate all derivatives of a spline at a single point.  <br /></td></tr>
<tr class="separator:a0c64b88d2d403641e200a68c9604f425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30c8a4cf89f70ba6c63596bfdcdc3d4e" id="r_a30c8a4cf89f70ba6c63596bfdcdc3d4e"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a30c8a4cf89f70ba6c63596bfdcdc3d4e">spgrid</a> (iopt, ider, mu, u, mv, v, r, r0, r1, s, nuest, nvest, nu, tu, nv, tv, c, fp, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:a30c8a4cf89f70ba6c63596bfdcdc3d4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a smooth bivariate spline to gridded data on a sphere (latitude-longitude grid).  <br /></td></tr>
<tr class="separator:a30c8a4cf89f70ba6c63596bfdcdc3d4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacb3cc3cd0d0028ebcb2525dc3a6001e" id="r_aacb3cc3cd0d0028ebcb2525dc3a6001e"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aacb3cc3cd0d0028ebcb2525dc3a6001e">sphere</a> (iopt, m, teta, phi, r, w, s, ntest, npest, eps, nt, tt, np, tp, c, fp, wrk1, lwrk1, wrk2, lwrk2, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:aacb3cc3cd0d0028ebcb2525dc3a6001e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a smooth bicubic spherical spline to scattered data on a sphere.  <br /></td></tr>
<tr class="separator:aacb3cc3cd0d0028ebcb2525dc3a6001e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76d523967d0d2a2011719c12c27b2fe7" id="r_a76d523967d0d2a2011719c12c27b2fe7"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a76d523967d0d2a2011719c12c27b2fe7">splder</a> (t, n, c, k, nu, x, y, m, e, wrk, ier)</td></tr>
<tr class="memdesc:a76d523967d0d2a2011719c12c27b2fe7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the \( \nu \)-th derivative of a spline \( s(x) \) at a set of points.  <br /></td></tr>
<tr class="separator:a76d523967d0d2a2011719c12c27b2fe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a633394bd969a94a285ac5eeda32e48a7" id="r_a633394bd969a94a285ac5eeda32e48a7"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a633394bd969a94a285ac5eeda32e48a7">splev</a> (t, n, c, k, x, y, m, e, ier)</td></tr>
<tr class="memdesc:a633394bd969a94a285ac5eeda32e48a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate a spline \( s(x) \) of degree \( k \) at a set of points.  <br /></td></tr>
<tr class="separator:a633394bd969a94a285ac5eeda32e48a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7125f23ea644bcee0719e6279126b038" id="r_a7125f23ea644bcee0719e6279126b038"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7125f23ea644bcee0719e6279126b038">splint</a> (t, n, c, k, a, b, wrk)</td></tr>
<tr class="memdesc:a7125f23ea644bcee0719e6279126b038"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the definite integral of a spline \( s(x) \) over \( [a, b] \).  <br /></td></tr>
<tr class="separator:a7125f23ea644bcee0719e6279126b038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82db7c6b3d5abc2ace2c6e76ec168d7" id="r_ab82db7c6b3d5abc2ace2c6e76ec168d7"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab82db7c6b3d5abc2ace2c6e76ec168d7">sproot</a> (t, n, c, zeros, mest, m, ier)</td></tr>
<tr class="memdesc:ab82db7c6b3d5abc2ace2c6e76ec168d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the zeros of a cubic spline \( s(x) \) given in B-spline representation.  <br /></td></tr>
<tr class="separator:ab82db7c6b3d5abc2ace2c6e76ec168d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a827820ea1a71f5e6fad5e75bd3016578" id="r_a827820ea1a71f5e6fad5e75bd3016578"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a827820ea1a71f5e6fad5e75bd3016578">surev</a> (idim, tu, nu, tv, nv, c, u, mu, v, mv, f, mf, wrk, lwrk, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:a827820ea1a71f5e6fad5e75bd3016578"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate a parametric bicubic spline surface on a grid.  <br /></td></tr>
<tr class="separator:a827820ea1a71f5e6fad5e75bd3016578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3ec431477bdf8868e8aff1cc3f5ab51" id="r_ac3ec431477bdf8868e8aff1cc3f5ab51"><td class="memItemLeft" align="right" valign="top">pure subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac3ec431477bdf8868e8aff1cc3f5ab51">surfit</a> (iopt, m, x, y, z, w, xb, xe, yb, ye, kx, ky, s, nxest, nyest, nmax, eps, nx, tx, ny, ty, c, fp, wrk1, lwrk1, wrk2, lwrk2, iwrk, kwrk, ier)</td></tr>
<tr class="memdesc:ac3ec431477bdf8868e8aff1cc3f5ab51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit a smoothing bivariate spline to scattered data.  <br /></td></tr>
<tr class="separator:ac3ec431477bdf8868e8aff1cc3f5ab51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f64e9a19e2d3171ba5ccc07a5d56a2" id="r_a57f64e9a19e2d3171ba5ccc07a5d56a2"><td class="memItemLeft" align="right" valign="top">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function, dimension(size(list)), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57f64e9a19e2d3171ba5ccc07a5d56a2">fitpack_argsort</a> (list)</td></tr>
<tr class="memdesc:a57f64e9a19e2d3171ba5ccc07a5d56a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the permutation indices that would sort an array.  <br /></td></tr>
<tr class="separator:a57f64e9a19e2d3171ba5ccc07a5d56a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91926262dc58e19b1b4345d9696c90db" id="r_a91926262dc58e19b1b4345d9696c90db"><td class="memItemLeft" align="right" valign="top">pure recursive subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a91926262dc58e19b1b4345d9696c90db">fitpack_quicksort</a> (list, ilist, down)</td></tr>
<tr class="memdesc:a91926262dc58e19b1b4345d9696c90db"><td class="mdescLeft">&#160;</td><td class="mdescRight">In-place quicksort with optional index tracking.  <br /></td></tr>
<tr class="separator:a91926262dc58e19b1b4345d9696c90db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ef02c1455f01a04bc64bed3b5b4309b" id="r_a4ef02c1455f01a04bc64bed3b5b4309b"><td class="memItemLeft" align="right" valign="top">elemental subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ef02c1455f01a04bc64bed3b5b4309b">swap_data</a> (a, b)</td></tr>
<tr class="memdesc:a4ef02c1455f01a04bc64bed3b5b4309b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Swap two real values in place.  <br /></td></tr>
<tr class="separator:a4ef02c1455f01a04bc64bed3b5b4309b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b6ad97b1dc461dd71a0efe495d0538" id="r_a50b6ad97b1dc461dd71a0efe495d0538"><td class="memItemLeft" align="right" valign="top">elemental subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50b6ad97b1dc461dd71a0efe495d0538">swap_size</a> (a, b)</td></tr>
<tr class="memdesc:a50b6ad97b1dc461dd71a0efe495d0538"><td class="mdescLeft">&#160;</td><td class="mdescRight">Swap two integer values in place.  <br /></td></tr>
<tr class="separator:a50b6ad97b1dc461dd71a0efe495d0538"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c35a8032dd7dfa0b593ce00610d36f" id="r_a69c35a8032dd7dfa0b593ce00610d36f"><td class="memItemLeft" align="right" valign="top">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a69c35a8032dd7dfa0b593ce00610d36f">is_before</a> (a, b)</td></tr>
<tr class="memdesc:a69c35a8032dd7dfa0b593ce00610d36f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test \( a &lt; b \) (strict less-than).  <br /></td></tr>
<tr class="separator:a69c35a8032dd7dfa0b593ce00610d36f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9e559a7491e780d631b07d895b4ff98" id="r_ab9e559a7491e780d631b07d895b4ff98"><td class="memItemLeft" align="right" valign="top">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab9e559a7491e780d631b07d895b4ff98">is_after</a> (a, b)</td></tr>
<tr class="memdesc:ab9e559a7491e780d631b07d895b4ff98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test \( a &gt; b \) (strict greater-than).  <br /></td></tr>
<tr class="separator:ab9e559a7491e780d631b07d895b4ff98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82ac0d242da9cc1d0a21148c54a5e64f" id="r_a82ac0d242da9cc1d0a21148c54a5e64f"><td class="memItemLeft" align="right" valign="top">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a82ac0d242da9cc1d0a21148c54a5e64f">is_ge</a> (a, b)</td></tr>
<tr class="memdesc:a82ac0d242da9cc1d0a21148c54a5e64f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test \( a \ge b \).  <br /></td></tr>
<tr class="separator:a82ac0d242da9cc1d0a21148c54a5e64f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5edd55a10f2aebf05e8a9d8c68b36d8" id="r_ad5edd55a10f2aebf05e8a9d8c68b36d8"><td class="memItemLeft" align="right" valign="top">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5edd55a10f2aebf05e8a9d8c68b36d8">is_le</a> (a, b)</td></tr>
<tr class="memdesc:ad5edd55a10f2aebf05e8a9d8c68b36d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test \( a \le b \).  <br /></td></tr>
<tr class="separator:ad5edd55a10f2aebf05e8a9d8c68b36d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44e0185b61cf87f55a1a6ffb9f10fb98" id="r_a44e0185b61cf87f55a1a6ffb9f10fb98"><td class="memItemLeft" align="right" valign="top">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44e0185b61cf87f55a1a6ffb9f10fb98">equal</a> (a, b)</td></tr>
<tr class="memdesc:a44e0185b61cf87f55a1a6ffb9f10fb98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether two reals are equal within machine precision.  <br /></td></tr>
<tr class="separator:a44e0185b61cf87f55a1a6ffb9f10fb98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2509dd629f972935555488cd2db1bff2" id="r_a2509dd629f972935555488cd2db1bff2"><td class="memItemLeft" align="right" valign="top">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2509dd629f972935555488cd2db1bff2">not_equal</a> (a, b)</td></tr>
<tr class="memdesc:a2509dd629f972935555488cd2db1bff2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test whether two reals differ beyond machine precision.  <br /></td></tr>
<tr class="separator:a2509dd629f972935555488cd2db1bff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d6e951acad3110eb2c3dfb6e5215d8b" id="r_a7d6e951acad3110eb2c3dfb6e5215d8b"><td class="memItemLeft" align="right" valign="top">elemental integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d6e951acad3110eb2c3dfb6e5215d8b">fp_rcomms_per_bits</a> (nbits)</td></tr>
<tr class="memdesc:a7d6e951acad3110eb2c3dfb6e5215d8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of FP_COMM elements required to store nbits of data.  <br /></td></tr>
<tr class="separator:a7d6e951acad3110eb2c3dfb6e5215d8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac35f198a5a8f94451b070643d84e0313" id="r_ac35f198a5a8f94451b070643d84e0313"><td class="memItemLeft" align="right" valign="top">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac35f198a5a8f94451b070643d84e0313">fp_real_comm_size_1d</a> (array)</td></tr>
<tr class="memdesc:ac35f198a5a8f94451b070643d84e0313"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate storage size for 1D real(FP_REAL) allocatable array Header: 1 FP_COMM storing bounds as 2 int32 (or NOT_ALLOC marker) Data: raw transfer of array contents.  <br /></td></tr>
<tr class="separator:ac35f198a5a8f94451b070643d84e0313"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00853ac5a703224d7a3ed343729e9a61" id="r_a00853ac5a703224d7a3ed343729e9a61"><td class="memItemLeft" align="right" valign="top">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a00853ac5a703224d7a3ed343729e9a61">fp_real_comm_size_2d</a> (array)</td></tr>
<tr class="memdesc:a00853ac5a703224d7a3ed343729e9a61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate storage size for 2D real(FP_REAL) allocatable array.  <br /></td></tr>
<tr class="separator:a00853ac5a703224d7a3ed343729e9a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad70615c7f263c0cbd802843d940cfcea" id="r_ad70615c7f263c0cbd802843d940cfcea"><td class="memItemLeft" align="right" valign="top">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad70615c7f263c0cbd802843d940cfcea">fp_real_comm_size_3d</a> (array)</td></tr>
<tr class="memdesc:ad70615c7f263c0cbd802843d940cfcea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate storage size for 3D real(FP_REAL) allocatable array.  <br /></td></tr>
<tr class="separator:ad70615c7f263c0cbd802843d940cfcea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42f7e37a6f95520f7112ed4437414499" id="r_a42f7e37a6f95520f7112ed4437414499"><td class="memItemLeft" align="right" valign="top">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42f7e37a6f95520f7112ed4437414499">fp_size_comm_size_1d</a> (array)</td></tr>
<tr class="memdesc:a42f7e37a6f95520f7112ed4437414499"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate storage size for 1D integer(FP_SIZE) allocatable array.  <br /></td></tr>
<tr class="separator:a42f7e37a6f95520f7112ed4437414499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad07f8faaf72983eb7ffbc96d3735391e" id="r_ad07f8faaf72983eb7ffbc96d3735391e"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad07f8faaf72983eb7ffbc96d3735391e">fp_real_comm_pack_1d</a> (array, buffer)</td></tr>
<tr class="memdesc:ad07f8faaf72983eb7ffbc96d3735391e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack 1D real(FP_REAL) allocatable array into communication buffer.  <br /></td></tr>
<tr class="separator:ad07f8faaf72983eb7ffbc96d3735391e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae05e6292701b577dbca3bef71713bf98" id="r_ae05e6292701b577dbca3bef71713bf98"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae05e6292701b577dbca3bef71713bf98">fp_real_comm_pack_2d</a> (array, buffer)</td></tr>
<tr class="memdesc:ae05e6292701b577dbca3bef71713bf98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack 2D real(FP_REAL) allocatable array into communication buffer.  <br /></td></tr>
<tr class="separator:ae05e6292701b577dbca3bef71713bf98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5895e3d43f0c5da6890dfbc9ccadacbc" id="r_a5895e3d43f0c5da6890dfbc9ccadacbc"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5895e3d43f0c5da6890dfbc9ccadacbc">fp_real_comm_pack_3d</a> (array, buffer)</td></tr>
<tr class="memdesc:a5895e3d43f0c5da6890dfbc9ccadacbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack 3D real(FP_REAL) allocatable array into communication buffer.  <br /></td></tr>
<tr class="separator:a5895e3d43f0c5da6890dfbc9ccadacbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9d993cda2dd2b48893144dc12816a02" id="r_ab9d993cda2dd2b48893144dc12816a02"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab9d993cda2dd2b48893144dc12816a02">fp_size_comm_pack_1d</a> (array, buffer)</td></tr>
<tr class="memdesc:ab9d993cda2dd2b48893144dc12816a02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack 1D integer(FP_SIZE) allocatable array into communication buffer.  <br /></td></tr>
<tr class="separator:ab9d993cda2dd2b48893144dc12816a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9b714724c236d5cd3698b89edc4aeb6" id="r_af9b714724c236d5cd3698b89edc4aeb6"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9b714724c236d5cd3698b89edc4aeb6">fp_real_comm_expand_1d</a> (array, buffer)</td></tr>
<tr class="memdesc:af9b714724c236d5cd3698b89edc4aeb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand communication buffer into 1D real(FP_REAL) allocatable array.  <br /></td></tr>
<tr class="separator:af9b714724c236d5cd3698b89edc4aeb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ed46f895334511a1dcf2aa83057f99c" id="r_a6ed46f895334511a1dcf2aa83057f99c"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ed46f895334511a1dcf2aa83057f99c">fp_real_comm_expand_2d</a> (array, buffer)</td></tr>
<tr class="memdesc:a6ed46f895334511a1dcf2aa83057f99c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand communication buffer into 2D real(FP_REAL) allocatable array.  <br /></td></tr>
<tr class="separator:a6ed46f895334511a1dcf2aa83057f99c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a108fa2cb75a9a678945f1b08abd442ea" id="r_a108fa2cb75a9a678945f1b08abd442ea"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a108fa2cb75a9a678945f1b08abd442ea">fp_real_comm_expand_3d</a> (array, buffer)</td></tr>
<tr class="memdesc:a108fa2cb75a9a678945f1b08abd442ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand communication buffer into 3D real(FP_REAL) allocatable array.  <br /></td></tr>
<tr class="separator:a108fa2cb75a9a678945f1b08abd442ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52390a01092c6523bfe60ad85f8390af" id="r_a52390a01092c6523bfe60ad85f8390af"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a52390a01092c6523bfe60ad85f8390af">fp_size_comm_expand_1d</a> (array, buffer)</td></tr>
<tr class="memdesc:a52390a01092c6523bfe60ad85f8390af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand communication buffer into 1D integer(FP_SIZE) allocatable array.  <br /></td></tr>
<tr class="separator:a52390a01092c6523bfe60ad85f8390af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8351ecca3ca1adefde53fc395912d1c2" id="r_a8351ecca3ca1adefde53fc395912d1c2"><td class="memItemLeft" align="right" valign="top">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8351ecca3ca1adefde53fc395912d1c2">fp_bool_comm_size_1d</a> (array)</td></tr>
<tr class="memdesc:a8351ecca3ca1adefde53fc395912d1c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate storage size for 1D logical(FP_BOOL) allocatable array.  <br /></td></tr>
<tr class="separator:a8351ecca3ca1adefde53fc395912d1c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf008db646c0e7bd2afc2f44a7ed903a" id="r_acf008db646c0e7bd2afc2f44a7ed903a"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf008db646c0e7bd2afc2f44a7ed903a">fp_bool_comm_pack_1d</a> (array, buffer)</td></tr>
<tr class="memdesc:acf008db646c0e7bd2afc2f44a7ed903a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pack 1D logical(FP_BOOL) allocatable array into communication buffer.  <br /></td></tr>
<tr class="separator:acf008db646c0e7bd2afc2f44a7ed903a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55f37b7d9b1ed9015f7637067e8a96b" id="r_aa55f37b7d9b1ed9015f7637067e8a96b"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa55f37b7d9b1ed9015f7637067e8a96b">fp_bool_comm_expand_1d</a> (array, buffer)</td></tr>
<tr class="memdesc:aa55f37b7d9b1ed9015f7637067e8a96b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand communication buffer into 1D logical(FP_BOOL) allocatable array.  <br /></td></tr>
<tr class="separator:aa55f37b7d9b1ed9015f7637067e8a96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae6ce471487dec031d833fc0e5dfdb065" id="r_ae6ce471487dec031d833fc0e5dfdb065"><td class="memItemLeft" align="right" valign="top">integer, parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a> = c_double</td></tr>
<tr class="separator:ae6ce471487dec031d833fc0e5dfdb065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a813df3760ab07292679bf3d7384ddcb7" id="r_a813df3760ab07292679bf3d7384ddcb7"><td class="memItemLeft" align="right" valign="top">integer, parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a> = c_int32_t</td></tr>
<tr class="separator:a813df3760ab07292679bf3d7384ddcb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2b42bf8ab592eaa2ea37a333fd10f54" id="r_ab2b42bf8ab592eaa2ea37a333fd10f54"><td class="memItemLeft" align="right" valign="top">integer, parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a> = c_int32_t</td></tr>
<tr class="separator:ab2b42bf8ab592eaa2ea37a333fd10f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a650e5831ebea638e634b52942aae265c" id="r_a650e5831ebea638e634b52942aae265c"><td class="memItemLeft" align="right" valign="top">integer, parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a> = c_bool</td></tr>
<tr class="separator:a650e5831ebea638e634b52942aae265c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9aa06356d8fbf8f4b108db917e429a4" id="r_ac9aa06356d8fbf8f4b108db917e429a4"><td class="memItemLeft" align="right" valign="top">integer, parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a> = c_double</td></tr>
<tr class="separator:ac9aa06356d8fbf8f4b108db917e429a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16ef1ddc6e8416540eac14148753788d" id="r_a16ef1ddc6e8416540eac14148753788d"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16ef1ddc6e8416540eac14148753788d">fp_not_alloc</a> = -99999999_FP_SIZE</td></tr>
<tr class="memdesc:a16ef1ddc6e8416540eac14148753788d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Marker for unallocated arrays in communication buffers.  <br /></td></tr>
<tr class="separator:a16ef1ddc6e8416540eac14148753788d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c83e115f52c352bdc76759d2c21a21" id="r_ae8c83e115f52c352bdc76759d2c21a21"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8c83e115f52c352bdc76759d2c21a21">outside_extrapolate</a> = 0</td></tr>
<tr class="separator:ae8c83e115f52c352bdc76759d2c21a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea35b146c25b52ee76291d55046635a8" id="r_aea35b146c25b52ee76291d55046635a8"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aea35b146c25b52ee76291d55046635a8">outside_zero</a> = 1</td></tr>
<tr class="separator:aea35b146c25b52ee76291d55046635a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90b449513694a8a6e8dd2e0893e9c044" id="r_a90b449513694a8a6e8dd2e0893e9c044"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90b449513694a8a6e8dd2e0893e9c044">outside_not_allowed</a> = 2</td></tr>
<tr class="separator:a90b449513694a8a6e8dd2e0893e9c044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa89341217e078cc2593242b8a4184ff6" id="r_aa89341217e078cc2593242b8a4184ff6"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa89341217e078cc2593242b8a4184ff6">outside_nearest_bnd</a> = 3</td></tr>
<tr class="separator:aa89341217e078cc2593242b8a4184ff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaae5211a1438087b7d98f9648255e63" id="r_aeaae5211a1438087b7d98f9648255e63"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeaae5211a1438087b7d98f9648255e63">iopt_new_leastsquares</a> = -1</td></tr>
<tr class="separator:aeaae5211a1438087b7d98f9648255e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aeb0ab003e1195670a39f28dd36e5d4" id="r_a9aeb0ab003e1195670a39f28dd36e5d4"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9aeb0ab003e1195670a39f28dd36e5d4">iopt_new_smoothing</a> = 0</td></tr>
<tr class="separator:a9aeb0ab003e1195670a39f28dd36e5d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a979a930a27067e89d9a12cdfa770887e" id="r_a979a930a27067e89d9a12cdfa770887e"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a979a930a27067e89d9a12cdfa770887e">iopt_old_fit</a> = 1</td></tr>
<tr class="separator:a979a930a27067e89d9a12cdfa770887e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea3d2d817763c46755c944d4ea72a24" id="r_acea3d2d817763c46755c944d4ea72a24"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acea3d2d817763c46755c944d4ea72a24">max_idim</a> = 10</td></tr>
<tr class="separator:acea3d2d817763c46755c944d4ea72a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae335f58a7994bbafd5ff9cfb81d1e7fb" id="r_ae335f58a7994bbafd5ff9cfb81d1e7fb"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae335f58a7994bbafd5ff9cfb81d1e7fb">knot_dim_none</a> = 0</td></tr>
<tr class="separator:ae335f58a7994bbafd5ff9cfb81d1e7fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d99472224f26deec2560fedeab07794" id="r_a7d99472224f26deec2560fedeab07794"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d99472224f26deec2560fedeab07794">knot_dim_2</a> = 1</td></tr>
<tr class="separator:a7d99472224f26deec2560fedeab07794"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d8475ed3cb1c0bfccef4ca66ef6bf59" id="r_a1d8475ed3cb1c0bfccef4ca66ef6bf59"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d8475ed3cb1c0bfccef4ca66ef6bf59">knot_dim_1</a> = -1</td></tr>
<tr class="separator:a1d8475ed3cb1c0bfccef4ca66ef6bf59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c5b21fc23625ebfc7f555075c13eb07" id="r_a6c5b21fc23625ebfc7f555075c13eb07"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c5b21fc23625ebfc7f555075c13eb07">max_order</a> = 19</td></tr>
<tr class="separator:a6c5b21fc23625ebfc7f555075c13eb07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a668bd0af72972ca4b389eb70672f246b" id="r_a668bd0af72972ca4b389eb70672f246b"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a668bd0af72972ca4b389eb70672f246b">degree_3</a> = 3</td></tr>
<tr class="separator:a668bd0af72972ca4b389eb70672f246b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d07187113a320a4bf1fa751018181d2" id="r_a3d07187113a320a4bf1fa751018181d2"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3d07187113a320a4bf1fa751018181d2">degree_4</a> = 4</td></tr>
<tr class="separator:a3d07187113a320a4bf1fa751018181d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d7d7b394bfadf0160a6986d06c7952d" id="r_a4d7d7b394bfadf0160a6986d06c7952d"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d7d7b394bfadf0160a6986d06c7952d">degree_5</a> = 5</td></tr>
<tr class="separator:a4d7d7b394bfadf0160a6986d06c7952d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4ad90f1d8e6de762e926e53511dcfdc" id="r_ad4ad90f1d8e6de762e926e53511dcfdc"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad4ad90f1d8e6de762e926e53511dcfdc">fitpack_ok</a> = 0</td></tr>
<tr class="separator:ad4ad90f1d8e6de762e926e53511dcfdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a106b66c8074f6ff15a3bbd5b3b05e846" id="r_a106b66c8074f6ff15a3bbd5b3b05e846"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a106b66c8074f6ff15a3bbd5b3b05e846">fitpack_interpolating_ok</a> = -1</td></tr>
<tr class="separator:a106b66c8074f6ff15a3bbd5b3b05e846"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12befae31b0984a43ced0a5953d00699" id="r_a12befae31b0984a43ced0a5953d00699"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a12befae31b0984a43ced0a5953d00699">fitpack_leastsquares_ok</a> = -2</td></tr>
<tr class="separator:a12befae31b0984a43ced0a5953d00699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bdff823e0b4b6c4d78480ebcf261b77" id="r_a9bdff823e0b4b6c4d78480ebcf261b77"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9bdff823e0b4b6c4d78480ebcf261b77">fitpack_insufficient_storage</a> = 1</td></tr>
<tr class="separator:a9bdff823e0b4b6c4d78480ebcf261b77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f2e775aca8ba712b352289ec5f3eaed" id="r_a0f2e775aca8ba712b352289ec5f3eaed"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f2e775aca8ba712b352289ec5f3eaed">fitpack_s_too_small</a> = 2</td></tr>
<tr class="separator:a0f2e775aca8ba712b352289ec5f3eaed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc355752db9a62cf5d13e0b62f1c7afc" id="r_adc355752db9a62cf5d13e0b62f1c7afc"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc355752db9a62cf5d13e0b62f1c7afc">fitpack_maxit</a> = 3</td></tr>
<tr class="separator:adc355752db9a62cf5d13e0b62f1c7afc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aef274b373e0259f86d19f98f0f222f" id="r_a6aef274b373e0259f86d19f98f0f222f"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6aef274b373e0259f86d19f98f0f222f">fitpack_too_many_knots</a> = 4</td></tr>
<tr class="separator:a6aef274b373e0259f86d19f98f0f222f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa524549dddd647e47d11f97c6219214d" id="r_aa524549dddd647e47d11f97c6219214d"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa524549dddd647e47d11f97c6219214d">fitpack_overlapping_knots</a> = 5</td></tr>
<tr class="separator:aa524549dddd647e47d11f97c6219214d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a944d940ace1cff6450dfb7526fef5638" id="r_a944d940ace1cff6450dfb7526fef5638"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a944d940ace1cff6450dfb7526fef5638">fitpack_invalid_range</a> = 6</td></tr>
<tr class="separator:a944d940ace1cff6450dfb7526fef5638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a038ab2216be4b6dddcf5166e9baf6487" id="r_a038ab2216be4b6dddcf5166e9baf6487"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a038ab2216be4b6dddcf5166e9baf6487">fitpack_input_error</a> = 10</td></tr>
<tr class="separator:a038ab2216be4b6dddcf5166e9baf6487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01a372bcb8babb47683f1d60a0ac6d2f" id="r_a01a372bcb8babb47683f1d60a0ac6d2f"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a01a372bcb8babb47683f1d60a0ac6d2f">fitpack_test_error</a> = 11</td></tr>
<tr class="separator:a01a372bcb8babb47683f1d60a0ac6d2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad07193e4c7b3c7365d8c1092f6e4cc9" id="r_aad07193e4c7b3c7365d8c1092f6e4cc9"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad07193e4c7b3c7365d8c1092f6e4cc9">fitpack_invalid_constraint</a> = 12</td></tr>
<tr class="separator:aad07193e4c7b3c7365d8c1092f6e4cc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8896021bdfc50c966a5f5ed3c0a8b23a" id="r_a8896021bdfc50c966a5f5ed3c0a8b23a"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8896021bdfc50c966a5f5ed3c0a8b23a">fitpack_insufficient_knots</a> = 13</td></tr>
<tr class="separator:a8896021bdfc50c966a5f5ed3c0a8b23a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8977b21dfb875ff715ed80ae54eb940f" id="r_a8977b21dfb875ff715ed80ae54eb940f"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8977b21dfb875ff715ed80ae54eb940f">concon_maxbin</a> = 14</td></tr>
<tr class="separator:a8977b21dfb875ff715ed80ae54eb940f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae25605ee85ee9f332ef8c76fd1b4912f" id="r_ae25605ee85ee9f332ef8c76fd1b4912f"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae25605ee85ee9f332ef8c76fd1b4912f">concon_maxtr</a> = 15</td></tr>
<tr class="separator:ae25605ee85ee9f332ef8c76fd1b4912f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34253ec4cac375fd881ce164c7d6f3a5" id="r_a34253ec4cac375fd881ce164c7d6f3a5"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34253ec4cac375fd881ce164c7d6f3a5">concon_qp_fail</a> = 16</td></tr>
<tr class="separator:a34253ec4cac375fd881ce164c7d6f3a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb077d251aa5a83467c1db3413457d9b" id="r_aeb077d251aa5a83467c1db3413457d9b"><td class="memItemLeft" align="right" valign="top">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb077d251aa5a83467c1db3413457d9b">fp_true</a> = .true._FP_BOOL</td></tr>
<tr class="separator:aeb077d251aa5a83467c1db3413457d9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a015fac22c02c6a271cc91e07f8d068ef" id="r_a015fac22c02c6a271cc91e07f8d068ef"><td class="memItemLeft" align="right" valign="top">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a015fac22c02c6a271cc91e07f8d068ef">fp_false</a> = .false._FP_BOOL</td></tr>
<tr class="separator:a015fac22c02c6a271cc91e07f8d068ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ebba5f497175707f893443bd77ea7b" id="r_a01ebba5f497175707f893443bd77ea7b"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a01ebba5f497175707f893443bd77ea7b">izero</a> = 0_FP_SIZE</td></tr>
<tr class="separator:a01ebba5f497175707f893443bd77ea7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a428e614df1a06b6dbf257ecd68a66f27" id="r_a428e614df1a06b6dbf257ecd68a66f27"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a428e614df1a06b6dbf257ecd68a66f27">ione</a> = 1_FP_SIZE</td></tr>
<tr class="separator:a428e614df1a06b6dbf257ecd68a66f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae215ea87e63c4e8042cee1d42ae50828" id="r_ae215ea87e63c4e8042cee1d42ae50828"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae215ea87e63c4e8042cee1d42ae50828">itwo</a> = 2_FP_SIZE</td></tr>
<tr class="separator:ae215ea87e63c4e8042cee1d42ae50828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a274f3c8c6327076d7195c73fa818ebef" id="r_a274f3c8c6327076d7195c73fa818ebef"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a274f3c8c6327076d7195c73fa818ebef">ithree</a> = 3_FP_SIZE</td></tr>
<tr class="separator:a274f3c8c6327076d7195c73fa818ebef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a909438eb654f950c6ca9471738088510" id="r_a909438eb654f950c6ca9471738088510"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a909438eb654f950c6ca9471738088510">ifour</a> = 4_FP_SIZE</td></tr>
<tr class="separator:a909438eb654f950c6ca9471738088510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab4fd1ec4cdc14189c1cbec78baaef0" id="r_a2ab4fd1ec4cdc14189c1cbec78baaef0"><td class="memItemLeft" align="right" valign="top">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2ab4fd1ec4cdc14189c1cbec78baaef0">ifive</a> = 5_FP_SIZE</td></tr>
<tr class="separator:a2ab4fd1ec4cdc14189c1cbec78baaef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ef46fb771d804b34407c3ec419f79cc" id="r_a4ef46fb771d804b34407c3ec419f79cc"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ef46fb771d804b34407c3ec419f79cc">one</a> = 1.0_FP_REAL</td></tr>
<tr class="separator:a4ef46fb771d804b34407c3ec419f79cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9199b127ebd8fa693ca733b00ec1621b" id="r_a9199b127ebd8fa693ca733b00ec1621b"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9199b127ebd8fa693ca733b00ec1621b">zero</a> = 0.0_FP_REAL</td></tr>
<tr class="separator:a9199b127ebd8fa693ca733b00ec1621b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b6dcf919ef8883b8d7d8c5f4117e58c" id="r_a9b6dcf919ef8883b8d7d8c5f4117e58c"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9b6dcf919ef8883b8d7d8c5f4117e58c">half</a> = 0.5_FP_REAL</td></tr>
<tr class="separator:a9b6dcf919ef8883b8d7d8c5f4117e58c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a641bf26c23c6c7089fe7ab041d8b9d4f" id="r_a641bf26c23c6c7089fe7ab041d8b9d4f"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a641bf26c23c6c7089fe7ab041d8b9d4f">onep5</a> = 1.5_FP_REAL</td></tr>
<tr class="separator:a641bf26c23c6c7089fe7ab041d8b9d4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2400f32cd48e2a9819ac8679d58ac20e" id="r_a2400f32cd48e2a9819ac8679d58ac20e"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2400f32cd48e2a9819ac8679d58ac20e">third</a> = <a class="el" href="#a4ef46fb771d804b34407c3ec419f79cc">one</a>/3.0_FP_REAL</td></tr>
<tr class="separator:a2400f32cd48e2a9819ac8679d58ac20e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f011dd3c1148c6cecee9174b2391aa4" id="r_a0f011dd3c1148c6cecee9174b2391aa4"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0f011dd3c1148c6cecee9174b2391aa4">fourth</a> = 0.25_FP_REAL</td></tr>
<tr class="separator:a0f011dd3c1148c6cecee9174b2391aa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afee03366ac96e05920c831ebe8d1a80b" id="r_afee03366ac96e05920c831ebe8d1a80b"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afee03366ac96e05920c831ebe8d1a80b">two</a> = 2.0_FP_REAL</td></tr>
<tr class="separator:afee03366ac96e05920c831ebe8d1a80b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a943cd42934fd393b333db11f752fc638" id="r_a943cd42934fd393b333db11f752fc638"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a943cd42934fd393b333db11f752fc638">three</a> = 3.0_FP_REAL</td></tr>
<tr class="separator:a943cd42934fd393b333db11f752fc638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d8e71908bad79fed68247c6f7731862" id="r_a6d8e71908bad79fed68247c6f7731862"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6d8e71908bad79fed68247c6f7731862">four</a> = 4.0_FP_REAL</td></tr>
<tr class="separator:a6d8e71908bad79fed68247c6f7731862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561dddd557c0d3839c8980a774ac5b26" id="r_a561dddd557c0d3839c8980a774ac5b26"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a561dddd557c0d3839c8980a774ac5b26">five</a> = 5.0_FP_REAL</td></tr>
<tr class="separator:a561dddd557c0d3839c8980a774ac5b26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79a1cbd52f4a65393251fbd8bce4d0c3" id="r_a79a1cbd52f4a65393251fbd8bce4d0c3"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79a1cbd52f4a65393251fbd8bce4d0c3">six</a> = 6.0_FP_REAL</td></tr>
<tr class="separator:a79a1cbd52f4a65393251fbd8bce4d0c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5de665dd2a4942cc8f8e3a7f9d6ca47c" id="r_a5de665dd2a4942cc8f8e3a7f9d6ca47c"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5de665dd2a4942cc8f8e3a7f9d6ca47c">ten</a> = 10.0_FP_REAL</td></tr>
<tr class="separator:a5de665dd2a4942cc8f8e3a7f9d6ca47c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46706d00dd4c5a65aad4dca9b490db91" id="r_a46706d00dd4c5a65aad4dca9b490db91"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a> = atan2(<a class="el" href="#a9199b127ebd8fa693ca733b00ec1621b">zero</a>, -<a class="el" href="#a4ef46fb771d804b34407c3ec419f79cc">one</a>)</td></tr>
<tr class="separator:a46706d00dd4c5a65aad4dca9b490db91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaec2c2df3931627500a073b6683fbb9" id="r_aeaec2c2df3931627500a073b6683fbb9"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeaec2c2df3931627500a073b6683fbb9">pi2</a> = 2*<a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a></td></tr>
<tr class="separator:aeaec2c2df3931627500a073b6683fbb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c893201e301fa7f4756972b71b10bc" id="r_af2c893201e301fa7f4756972b71b10bc"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2c893201e301fa7f4756972b71b10bc">pi4</a> = 4*<a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a></td></tr>
<tr class="separator:af2c893201e301fa7f4756972b71b10bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcc34262b795f5b99a79de4e2eaac8fe" id="r_adcc34262b795f5b99a79de4e2eaac8fe"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adcc34262b795f5b99a79de4e2eaac8fe">pio2</a> = <a class="el" href="#a9b6dcf919ef8883b8d7d8c5f4117e58c">half</a>*<a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a></td></tr>
<tr class="separator:adcc34262b795f5b99a79de4e2eaac8fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b55639d02ea588c18e1f890b04257f" id="r_ad1b55639d02ea588c18e1f890b04257f"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad1b55639d02ea588c18e1f890b04257f">pio4</a> = <a class="el" href="#a0f011dd3c1148c6cecee9174b2391aa4">fourth</a>*<a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a></td></tr>
<tr class="separator:ad1b55639d02ea588c18e1f890b04257f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0909aaddeb47c5a7ae90af3942568060" id="r_a0909aaddeb47c5a7ae90af3942568060"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0909aaddeb47c5a7ae90af3942568060">pio8</a> = 0.125_FP_REAL*<a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a></td></tr>
<tr class="separator:a0909aaddeb47c5a7ae90af3942568060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3c998a4a06cbcdfc95f2f901573016b" id="r_af3c998a4a06cbcdfc95f2f901573016b"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af3c998a4a06cbcdfc95f2f901573016b">deg2rad</a> = <a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a>/180.0_FP_REAL</td></tr>
<tr class="separator:af3c998a4a06cbcdfc95f2f901573016b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb4060ce4cd4a560895caf20419ad93" id="r_a4bb4060ce4cd4a560895caf20419ad93"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4bb4060ce4cd4a560895caf20419ad93">smallnum03</a> = 1.0e-03_FP_REAL</td></tr>
<tr class="separator:a4bb4060ce4cd4a560895caf20419ad93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb09c4fbdc52ad141ec702456cd5936b" id="r_afb09c4fbdc52ad141ec702456cd5936b"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afb09c4fbdc52ad141ec702456cd5936b">smallnum06</a> = 1.0e-06_FP_REAL</td></tr>
<tr class="separator:afb09c4fbdc52ad141ec702456cd5936b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4a447df425d54bdc2962c1fe0cdd332" id="r_ac4a447df425d54bdc2962c1fe0cdd332"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac4a447df425d54bdc2962c1fe0cdd332">smallnum08</a> = 1.0e-08_FP_REAL</td></tr>
<tr class="separator:ac4a447df425d54bdc2962c1fe0cdd332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1ef41e135e2b19a4fef06743624081d" id="r_ab1ef41e135e2b19a4fef06743624081d"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab1ef41e135e2b19a4fef06743624081d">smallnum10</a> = 1.0e-10_FP_REAL</td></tr>
<tr class="separator:ab1ef41e135e2b19a4fef06743624081d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a7fc6de0b9389c7699809c138e0cb8604" name="a7fc6de0b9389c7699809c138e0cb8604"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fc6de0b9389c7699809c138e0cb8604">&#9670;&#160;</a></span>bispeu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::bispeu </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nx-kx-1)*(ny-ky-1)), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate a bivariate spline at scattered points \( (x_i, y_i) \). </p>
<p>Given a bivariate spline \( s(x,y) \) of degrees \( k_x \) and \( k_y \) in tensor-product B-spline representation, evaluates \( s(x_i, y_i) \) for \( i = 1,\ldots,m \) at arbitrary (scattered) points.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>Knot positions in \( x \)-direction (length \( n_x \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Total number of knots in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ty</td><td>Knot positions in \( y \)-direction (length \( n_y \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Total number of knots in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients, length \( (n_x{-}k_x{-}1)(n_y{-}k_y{-}1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Degree in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Degree in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>\( x \)-coordinates of evaluation points (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>\( y \)-coordinates of evaluation points (length \( m \)). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">z</td><td>Spline values \( s(x_i, y_i) \) (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of evaluation points, \( m \ge 1 \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace, length \( \ge k_x + k_y + 2 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Declared dimension of <code>wrk</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#aac8fa7ec692eb2758290f050c302d22d" title="Evaluate a bivariate spline on a rectangular grid.">bispev</a>  grid evaluation variant; <a class="el" href="#a72432bc4ebc7c5ff0425d188147d7dbb" title="Evaluate a tensor product spline on a grid.">fpbisp</a>  tensor-product evaluation kernel </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a7fc6de0b9389c7699809c138e0cb8604_cgraph.png" border="0" usemap="#anamespacefitpack__core_a7fc6de0b9389c7699809c138e0cb8604_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a7fc6de0b9389c7699809c138e0cb8604_cgraph" id="anamespacefitpack__core_a7fc6de0b9389c7699809c138e0cb8604_cgraph">
<area shape="rect" title="Evaluate a bivariate spline at scattered points ." alt="" coords="5,42,157,67"/>
<area shape="rect" href="namespacefitpack__core.html#a72432bc4ebc7c5ff0425d188147d7dbb" title="Evaluate a tensor product spline on a grid." alt="" coords="205,42,355,67"/>
<area shape="poly" title=" " alt="" coords="158,52,192,52,192,57,158,57"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="403,5,561,45"/>
<area shape="poly" title=" " alt="" coords="355,41,389,36,390,41,355,46"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="407,70,557,95"/>
<area shape="poly" title=" " alt="" coords="355,62,394,68,394,73,355,68"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="609,70,783,95"/>
<area shape="poly" title=" " alt="" coords="557,80,596,80,596,85,557,85"/>
<area shape="poly" title=" " alt="" coords="662,72,655,62,659,52,673,46,696,43,725,47,736,56,733,60,722,52,696,49,674,51,663,55,660,61,666,68"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="831,70,976,95"/>
<area shape="poly" title=" " alt="" coords="783,80,817,80,817,85,783,85"/>
<area shape="poly" title=" " alt="" coords="870,72,862,62,866,52,880,46,903,43,932,47,943,56,940,60,930,52,903,49,881,51,870,55,868,61,874,68"/>
</map>
</div>

</div>
</div>
<a id="aac8fa7ec692eb2758290f050c302d22d" name="aac8fa7ec692eb2758290f050c302d22d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac8fa7ec692eb2758290f050c302d22d">&#9670;&#160;</a></span>bispev()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::bispev </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nx-kx-1)*(ny-ky-1)), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(my), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>my</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx*my), intent(out)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate a bivariate spline on a rectangular grid. </p>
<p>Given a bivariate spline \( s(x,y) \) of degrees \( k_x \) and \( k_y \) in tensor-product B-spline representation, evaluates \( s(x_i, y_j) \) on the grid  \( i = 1,\ldots,m_x;\ 
j = 1,\ldots,m_y \). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_aac8fa7ec692eb2758290f050c302d22d_cgraph.png" border="0" usemap="#anamespacefitpack__core_aac8fa7ec692eb2758290f050c302d22d_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_aac8fa7ec692eb2758290f050c302d22d_cgraph" id="anamespacefitpack__core_aac8fa7ec692eb2758290f050c302d22d_cgraph">
<area shape="rect" title="Evaluate a bivariate spline on a rectangular grid." alt="" coords="5,42,157,67"/>
<area shape="rect" href="namespacefitpack__core.html#a72432bc4ebc7c5ff0425d188147d7dbb" title="Evaluate a tensor product spline on a grid." alt="" coords="205,42,355,67"/>
<area shape="poly" title=" " alt="" coords="158,52,192,52,192,57,158,57"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="403,5,561,45"/>
<area shape="poly" title=" " alt="" coords="355,41,389,36,390,41,355,46"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="407,70,557,95"/>
<area shape="poly" title=" " alt="" coords="355,62,394,68,394,73,355,68"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="609,70,783,95"/>
<area shape="poly" title=" " alt="" coords="557,80,596,80,596,85,557,85"/>
<area shape="poly" title=" " alt="" coords="662,72,655,62,659,52,673,46,696,43,725,47,736,56,733,60,722,52,696,49,674,51,663,55,660,61,666,68"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="831,70,976,95"/>
<area shape="poly" title=" " alt="" coords="783,80,817,80,817,85,783,85"/>
<area shape="poly" title=" " alt="" coords="870,72,862,62,866,52,880,46,903,43,932,47,943,56,940,60,930,52,903,49,881,51,870,55,868,61,874,68"/>
</map>
</div>

</div>
</div>
<a id="a5a343cb3562b6062cf6ca4a493b8fca8" name="a5a343cb3562b6062cf6ca4a493b8fca8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a343cb3562b6062cf6ca4a493b8fca8">&#9670;&#160;</a></span>clocur()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::clocur </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ipar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine a smooth closed parametric spline curve approximation. </p>
<p>Given \( m \) data points \( \mathbf{x}_i \in \mathbb{R}^{\text{idim}} \) with \( \mathbf{x}_1 = \mathbf{x}_m \) (closure condition) and weights \( w_i &gt; 0 \), computes an <code>idim</code>-dimensional periodic spline curve \( \mathbf{s}(u) = (s_1(u),\ldots,s_{\text{idim}}(u)) \) of degree \( k \).</p>
<p>Parameter values \( u_i \) can be supplied by the user (<code>ipar=1</code>) or computed automatically from cumulative chord lengths (<code>ipar=0</code>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Computation mode: <code>-1</code> (LSQ), <code>0</code> (new smoothing), <code>1</code> (continue). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipar</td><td>Parameter mode: <code>0</code> = automatic (chord-length), <code>1</code> = user-supplied. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Dimension of the curve, \( 1 \le \text{idim} \le 10 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points, \( m &gt; 1 \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">u</td><td>Parameter values (length \( m \)). Output when <code>ipar=0</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Declared dimension of <code>x</code>, \( \text{mx} \ge \text{idim} \times m \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data coordinates: <code>x(idim*(i-1)+j)</code> is the \( j \)-th coordinate of point \( i \). First and last points must coincide. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Weights (length \( m \)). \( w_m \) not used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree, \( 1 \le k \le 5 \). Cubic recommended. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \ge 0 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Over-estimate of total knots. <code>nest=m+2*k</code> always suffices. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot positions (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Declared dimension of <code>c</code>, \( \text{nc} \ge \text{nest} \times \text{idim} \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients (length <code>nc</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace, length \( \ge m(k+1) + \text{nest}(7+\text{idim}+5k) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Declared dimension of <code>wrk</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer workspace (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag (same codes as curfit).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.1&ndash;6.2; <a class="el" href="#a899b48e5e372c91998b53c9f1959d177" title="Core algorithm for closed (periodic) parametric curve fitting.">fpclos</a>  core closed-curve fitting algorithm </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a5a343cb3562b6062cf6ca4a493b8fca8_cgraph.png" border="0" usemap="#anamespacefitpack__core_a5a343cb3562b6062cf6ca4a493b8fca8_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a5a343cb3562b6062cf6ca4a493b8fca8_cgraph" id="anamespacefitpack__core_a5a343cb3562b6062cf6ca4a493b8fca8_cgraph">
<area shape="rect" title="Determine a smooth closed parametric spline curve approximation." alt="" coords="5,603,153,629"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="840,525,985,550"/>
<area shape="poly" title=" " alt="" coords="143,626,265,645,343,652,428,657,519,657,611,651,703,637,791,614,843,588,885,557,888,562,846,593,793,618,704,642,612,656,519,662,428,662,342,658,264,650,142,631"/>
<area shape="rect" href="namespacefitpack__core.html#accaa1729715efbe04726699613597c32" title=" " alt="" coords="201,578,355,603"/>
<area shape="poly" title=" " alt="" coords="153,604,187,600,188,605,154,609"/>
<area shape="rect" href="namespacefitpack__core.html#a899b48e5e372c91998b53c9f1959d177" title="Core algorithm for closed (periodic) parametric curve fitting." alt="" coords="204,335,352,361"/>
<area shape="poly" title=" " alt="" coords="88,601,257,370,261,373,92,605"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="619,578,792,603"/>
<area shape="poly" title=" " alt="" coords="154,618,343,622,457,621,570,613,636,603,637,609,571,619,457,626,343,628,153,623"/>
<area shape="poly" title=" " alt="" coords="879,526,872,516,875,506,889,500,913,498,941,502,953,511,949,515,939,507,913,503,891,505,879,510,877,516,883,523"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="407,299,566,339"/>
<area shape="poly" title=" " alt="" coords="352,335,393,329,394,334,353,340"/>
<area shape="rect" href="namespacefitpack__core.html#a8b4564b1b6353e60d0808091e9efa2e0" title="Rotate a split observation row into the block&#45;triangular periodic system with vector RHS." alt="" coords="403,235,571,275"/>
<area shape="poly" title=" " alt="" coords="302,333,402,284,418,277,420,282,404,289,305,338"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="631,363,780,389"/>
<area shape="poly" title=" " alt="" coords="353,350,617,368,617,373,352,355"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="631,421,779,446"/>
<area shape="poly" title=" " alt="" coords="290,359,333,413,366,441,404,463,437,473,471,478,541,476,606,464,659,448,661,453,607,469,541,481,471,483,435,478,402,468,363,446,330,416,286,362"/>
<area shape="rect" href="namespacefitpack__core.html#a82db002de9c1abeba86fae180dbec079" title="Rotate an observation row into a band matrix with vector RHS." alt="" coords="403,413,571,453"/>
<area shape="poly" title=" " alt="" coords="311,358,426,406,424,411,309,363"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="410,529,563,554"/>
<area shape="poly" title=" " alt="" coords="288,359,331,429,365,471,404,507,428,521,425,526,401,511,361,474,327,432,284,362"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="412,578,561,603"/>
<area shape="poly" title=" " alt="" coords="285,360,299,400,322,456,357,514,379,541,404,565,411,569,408,574,401,569,375,545,353,517,318,458,294,402,280,362"/>
<area shape="rect" href="namespacefitpack__core.html#ae099a69d7fc431841d2de41c38e4fcab" title=" " alt="" coords="413,5,561,45"/>
<area shape="poly" title=" " alt="" coords="279,334,289,284,310,209,326,168,346,128,371,89,401,55,406,51,409,55,405,59,375,93,351,130,331,171,315,211,294,285,284,335"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="413,70,561,95"/>
<area shape="poly" title=" " alt="" coords="280,334,292,290,315,229,351,163,374,133,401,106,410,100,413,104,404,110,378,136,355,166,320,231,297,292,285,336"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="411,185,562,210"/>
<area shape="poly" title=" " alt="" coords="286,334,331,279,364,248,401,220,416,213,418,218,404,225,368,252,335,283,290,337"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="419,120,554,160"/>
<area shape="poly" title=" " alt="" coords="283,334,325,258,359,211,401,170,409,165,412,169,404,174,363,214,329,260,287,336"/>
<area shape="poly" title=" " alt="" coords="572,262,625,274,683,291,741,316,794,349,833,387,864,431,888,474,904,511,899,513,883,477,860,434,829,390,790,353,738,320,681,296,623,279,570,268"/>
<area shape="poly" title=" " alt="" coords="546,272,572,284,630,319,678,353,675,357,627,323,569,289,544,277"/>
<area shape="poly" title=" " alt="" coords="556,273,573,285,585,299,592,314,597,343,603,371,609,384,620,398,641,413,638,417,617,402,605,387,598,372,592,344,587,316,580,302,569,289,553,277"/>
<area shape="poly" title=" " alt="" coords="570,451,847,519,845,524,569,456"/>
<area shape="poly" title=" " alt="" coords="563,411,642,390,643,395,564,416"/>
<area shape="poly" title=" " alt="" coords="571,431,618,431,618,436,571,436"/>
<area shape="poly" title=" " alt="" coords="562,588,605,588,605,593,562,593"/>
<area shape="poly" title=" " alt="" coords="755,575,849,551,850,556,756,580"/>
<area shape="poly" title=" " alt="" coords="672,580,664,570,668,560,682,554,705,551,734,555,745,564,742,568,732,560,705,557,683,559,672,563,670,569,676,576"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="633,127,777,153"/>
<area shape="poly" title=" " alt="" coords="555,137,619,137,619,143,555,143"/>
</map>
</div>

</div>
</div>
<a id="ae7347e7f9131cca78d72fe38baba4c92" name="ae7347e7f9131cca78d72fe38baba4c92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7347e7f9131cca78d72fe38baba4c92">&#9670;&#160;</a></span>cocosp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::cocosp </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxbin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(out)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>sq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>sx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), dimension(n), intent(out)</td>          <td class="paramname"><span class="paramname"><em>bind</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit a cubic spline with convexity/concavity constraints and user-specified knots. </p>
<p>Given data points \( (x_i, y_i) \) with weights \( w_i &gt; 0 \) and a fixed set of knots \( t_j \), computes the weighted least-squares cubic spline \( s(x) \) subject to local convexity/concavity constraints specified by the array <code>e</code>:</p><ul>
<li>\( e_j = +1 \): \( s&#39;&#39;(t_{j+3}) \ge 0 \) (locally concave)</li>
<li>\( e_j = -1 \): \( s&#39;&#39;(t_{j+3}) \le 0 \) (locally convex)</li>
<li>\( e_j = 0 \): no constraint at \( t_{j+3} \)</li>
</ul>
<p>The constrained fitting uses a quadratic programming approach with a binary tree structure for managing active constraints.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points, \( m &gt; 3 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Abscissae (strictly ascending). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Ordinates. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Weights, \( w_i &gt; 0 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of knots, \( 8 \le n \le m + 4 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot positions (length \( n \)), user-specified. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">e</td><td>Convexity indicators (length \( n \)). Only <code>e(1:n-6)</code> used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxtr</td><td>Over-estimate of tree records. <code>maxtr=100</code> usually sufficient. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxbin</td><td>Over-estimate of inflection knots. <code>maxbin=10</code> usually sufficient. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">c</td><td>B-spline coefficients (length \( n \)). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sq</td><td>Weighted sum of squared residuals. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sx</td><td>Spline values at data points (length \( m \)). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bind</td><td>Active constraint flags (length \( n \)): <code>.true.</code> where \( s&#39;&#39;=0 \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace, length \( \ge 4m + 7n + \text{maxbin}(\text{maxbin}+n+1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Declared dimension of <code>wrk</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer workspace, length \( \ge 4 \times \text{maxtr} + 2(\text{maxbin}+1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kwrk</td><td>Declared dimension of <code>iwrk</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = success; <code>1</code> = maxbin exceeded; <code>2</code> = maxtr exceeded; <code>3</code> = QP solver failed; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 7, 7.1&ndash;7.2; <a class="el" href="#a896928a4fbb29c241426ae61e5f2e69c" title="Core algorithm for convexity-constrained cubic spline fitting.">fpcosp</a>  core convexity-constrained algorithm </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ae7347e7f9131cca78d72fe38baba4c92_cgraph.png" border="0" usemap="#anamespacefitpack__core_ae7347e7f9131cca78d72fe38baba4c92_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ae7347e7f9131cca78d72fe38baba4c92_cgraph" id="anamespacefitpack__core_ae7347e7f9131cca78d72fe38baba4c92_cgraph">
<area shape="rect" title="Fit a cubic spline with convexity/concavity constraints and user&#45;specified knots." alt="" coords="5,145,160,170"/>
<area shape="rect" href="namespacefitpack__core.html#a3e1011bf7749aa62d3c05bd1a20e36d1" title="Verify knot positions against data points (Schoenberg&#45;Whitney check)." alt="" coords="208,95,360,121"/>
<area shape="poly" title=" " alt="" coords="135,142,217,121,219,127,136,147"/>
<area shape="rect" href="namespacefitpack__core.html#a896928a4fbb29c241426ae61e5f2e69c" title="Core algorithm for convexity&#45;constrained cubic spline fitting." alt="" coords="208,145,360,170"/>
<area shape="poly" title=" " alt="" coords="160,155,194,155,194,160,160,160"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="615,206,788,231"/>
<area shape="poly" title=" " alt="" coords="116,168,242,213,324,236,408,253,487,261,566,253,610,245,651,233,652,238,611,250,567,259,487,266,408,259,323,241,240,218,114,173"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="408,5,567,45"/>
<area shape="poly" title=" " alt="" coords="337,142,358,130,374,112,382,94,390,75,406,55,413,50,416,55,410,59,394,78,387,96,379,115,362,134,339,147"/>
<area shape="rect" href="namespacefitpack__core.html#a9bcbf8cf99bfb2ac2f3834891c731be7" title="Add a branch to the constraint&#45;set binary tree." alt="" coords="410,70,565,95"/>
<area shape="poly" title=" " alt="" coords="326,142,359,130,407,104,426,97,428,102,409,109,361,134,328,147"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="413,119,562,145"/>
<area shape="poly" title=" " alt="" coords="360,145,399,140,399,146,360,151"/>
<area shape="rect" href="namespacefitpack__core.html#ad5d82ac791ec6ae19e9b4671ffb734e0" title="Prune short branches from the constraint&#45;set binary tree." alt="" coords="410,169,565,194"/>
<area shape="poly" title=" " alt="" coords="360,164,397,168,396,173,360,169"/>
<area shape="rect" href="namespacefitpack__core.html#a535f9e04981c794c70a60f728e918472" title="Fetch and advance to the next branch in the constraint&#45;set tree." alt="" coords="411,218,564,243"/>
<area shape="poly" title=" " alt="" coords="317,168,409,203,433,211,432,216,407,208,315,173"/>
<area shape="rect" href="namespacefitpack__core.html#a8006d449287383c5f5c4151086e9a376" title="Collect free nodes from the constraint&#45;set binary tree." alt="" coords="627,70,775,95"/>
<area shape="poly" title=" " alt="" coords="565,80,614,80,614,85,565,85"/>
<area shape="poly" title=" " alt="" coords="535,142,568,154,664,197,662,202,566,158,533,147"/>
<area shape="poly" title=" " alt="" coords="668,208,660,198,664,188,678,182,701,179,730,183,741,192,738,196,728,188,701,185,679,187,668,191,666,197,672,204"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="836,206,981,231"/>
<area shape="poly" title=" " alt="" coords="788,216,822,216,822,221,788,221"/>
<area shape="poly" title=" " alt="" coords="875,208,868,198,871,188,885,182,909,179,937,183,949,192,945,196,935,188,909,185,887,187,875,191,873,197,879,204"/>
</map>
</div>

</div>
</div>
<a id="a4c04e0266b3011454aef7f491c067036" name="a4c04e0266b3011454aef7f491c067036"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c04e0266b3011454aef7f491c067036">&#9670;&#160;</a></span>concon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::concon </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxbin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>sq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>sx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bind</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit a cubic spline with convexity/concavity constraints and automatic knot placement. </p>
<p>Given data points \( (x_i, y_i) \) with weights \( w_i &gt; 0 \) and local convexity/concavity requirements \( v_i \in \{-1, 0, +1\} \) at the data points, determines a cubic spline \( s(x) \) satisfying the constraints with weighted residual sum \( \text{sq} \le S \).</p>
<p>Unlike cocosp (which takes fixed knots), concon automatically selects the number and position of knots, starting from a minimal set and adding knots progressively.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Computation mode: <code>0</code> = start with minimal knots; <code>1</code> = continue. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points, \( m &gt; 3 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Abscissae (strictly ascending). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Ordinates. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Weights, \( w_i &gt; 0 \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">v</td><td>Convexity indicators at data points: <code>+1</code> (concave), <code>-1</code> (convex), <code>0</code> (free). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \ge 0 \) (target upper bound for sq). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Over-estimate of total knots, \( \ge 8 \). <code>nest=m+4</code> always suffices. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxtr</td><td>Over-estimate of tree records. <code>maxtr=100</code> usually sufficient. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxbin</td><td>Over-estimate of inflection knots. <code>maxbin=10</code> usually sufficient. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot positions (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sq</td><td>Weighted sum of squared residuals. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sx</td><td>Spline values at data points (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bind</td><td>Active constraint flags (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace, length \( \ge 4m + 8\,\text{nest} + \text{maxbin}(\text{maxbin}+\text{nest}+1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Declared dimension of <code>wrk</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer workspace, length \( \ge 4\,\text{maxtr} + 2(\text{maxbin}+1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kwrk</td><td>Declared dimension of <code>iwrk</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag:<ul>
<li><code>0</code>: normal return ( \( \text{sq} \le S \) and constraints satisfied).</li>
<li><code>-3</code>: nest too small.</li>
<li><code>-2</code>: max knots \( m+4 \) reached.</li>
<li><code>-1</code>: adding knots won't help.</li>
<li><code>1</code>&ndash;<code>5</code>: various errors (maxbin, maxtr, QP, nest, constraint conflicts).</li>
<li><code>10</code>: invalid input.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 7, 7.2; <a class="el" href="#a4003dce07901ef7e9b8db9bb2a45b97c" title="Fit a convexity-constrained cubic smoothing spline.">fpcoco</a>  convexity-constrained driver; <a class="el" href="#a896928a4fbb29c241426ae61e5f2e69c" title="Core algorithm for convexity-constrained cubic spline fitting.">fpcosp</a>  core algorithm </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a4c04e0266b3011454aef7f491c067036_cgraph.png" border="0" usemap="#anamespacefitpack__core_a4c04e0266b3011454aef7f491c067036_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a4c04e0266b3011454aef7f491c067036_cgraph" id="anamespacefitpack__core_a4c04e0266b3011454aef7f491c067036_cgraph">
<area shape="rect" title="Fit a cubic spline with convexity/concavity constraints and automatic knot placement." alt="" coords="5,265,160,290"/>
<area shape="rect" href="namespacefitpack__core.html#a4003dce07901ef7e9b8db9bb2a45b97c" title="Fit a convexity&#45;constrained cubic smoothing spline." alt="" coords="208,165,360,190"/>
<area shape="poly" title=" " alt="" coords="108,262,244,194,246,199,111,267"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="816,226,989,251"/>
<area shape="poly" title=" " alt="" coords="160,285,278,297,430,306,599,304,684,297,767,285,817,272,862,254,864,259,819,277,769,291,685,303,599,309,430,311,278,303,160,291"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="1037,133,1183,158"/>
<area shape="poly" title=" " alt="" coords="293,163,339,114,371,86,407,62,460,37,504,24,609,11,718,3,763,5,804,11,888,35,990,76,1038,99,1079,123,1076,128,1035,104,988,81,886,40,803,16,762,10,718,8,610,16,505,29,462,42,409,66,374,90,342,117,297,166"/>
<area shape="rect" href="namespacefitpack__core.html#ab0ebd1c826f330de0103ba72e55260ba" title="Test whether a FITPACK error flag indicates success." alt="" coords="408,100,561,140"/>
<area shape="poly" title=" " alt="" coords="329,162,400,141,402,146,330,167"/>
<area shape="rect" href="namespacefitpack__core.html#a896928a4fbb29c241426ae61e5f2e69c" title="Core algorithm for convexity&#45;constrained cubic spline fitting." alt="" coords="409,165,561,190"/>
<area shape="poly" title=" " alt="" coords="360,175,395,175,395,180,360,180"/>
<area shape="poly" title=" " alt="" coords="317,188,443,233,525,256,610,273,689,281,768,273,811,265,852,253,854,258,812,270,768,279,689,286,609,279,524,261,442,238,315,193"/>
<area shape="poly" title=" " alt="" coords="1076,134,1069,124,1073,114,1087,108,1110,106,1139,110,1150,119,1147,123,1136,115,1110,111,1088,113,1077,118,1074,124,1080,131"/>
<area shape="poly" title=" " alt="" coords="447,100,445,90,451,81,464,75,485,73,508,76,521,84,518,88,506,81,485,79,466,81,454,85,450,91,452,99"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="609,25,768,65"/>
<area shape="poly" title=" " alt="" coords="538,162,560,150,575,133,583,115,591,96,608,77,616,70,619,75,611,81,596,99,588,117,580,136,563,154,540,167"/>
<area shape="rect" href="namespacefitpack__core.html#a9bcbf8cf99bfb2ac2f3834891c731be7" title="Add a branch to the constraint&#45;set binary tree." alt="" coords="611,90,766,115"/>
<area shape="poly" title=" " alt="" coords="527,162,560,150,608,126,631,117,633,122,610,130,562,155,528,167"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="614,139,763,165"/>
<area shape="poly" title=" " alt="" coords="561,165,600,160,601,166,561,171"/>
<area shape="rect" href="namespacefitpack__core.html#ad5d82ac791ec6ae19e9b4671ffb734e0" title="Prune short branches from the constraint&#45;set binary tree." alt="" coords="611,189,766,214"/>
<area shape="poly" title=" " alt="" coords="561,184,598,188,598,193,561,189"/>
<area shape="rect" href="namespacefitpack__core.html#a535f9e04981c794c70a60f728e918472" title="Fetch and advance to the next branch in the constraint&#45;set tree." alt="" coords="612,238,765,263"/>
<area shape="poly" title=" " alt="" coords="517,188,610,224,632,231,630,236,608,229,515,193"/>
<area shape="rect" href="namespacefitpack__core.html#a8006d449287383c5f5c4151086e9a376" title="Collect free nodes from the constraint&#45;set binary tree." alt="" coords="829,90,977,115"/>
<area shape="poly" title=" " alt="" coords="766,100,815,100,815,105,766,105"/>
<area shape="poly" title=" " alt="" coords="733,162,769,175,865,217,862,222,767,180,732,167"/>
<area shape="poly" title=" " alt="" coords="931,224,1067,161,1069,166,933,228"/>
<area shape="poly" title=" " alt="" coords="869,228,862,218,865,208,879,202,903,199,931,203,943,212,939,216,929,208,903,205,881,207,869,212,867,217,873,224"/>
</map>
</div>

</div>
</div>
<a id="a4f06e314103a691e23bd2eda4055086d" name="a4f06e314103a691e23bd2eda4055086d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f06e314103a691e23bd2eda4055086d">&#9670;&#160;</a></span>concur()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::concur </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>xx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ib</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nb), intent(in)</td>          <td class="paramname"><span class="paramname"><em>db</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ie</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ne), intent(in)</td>          <td class="paramname"><span class="paramname"><em>de</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ne</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>np</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(np), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine a smooth parametric spline curve with derivative constraints at endpoints. </p>
<p>Given \( m \) ordered points \( \mathbf{x}_i \in \mathbb{R}^{\text{idim}} \) with parameter values \( u_i \) and weights \( w_i &gt; 0 \), computes a parametric spline curve \( \mathbf{s}(u) \) of degree \( k \) that satisfies derivative constraints at the endpoints:   </p><p class="formulaDsp">
\[            s_j^{(l)}(u_1) = d_b(\text{idim} \cdot l + j), \quad l = 0,\ldots,i_b{-}1
\]
</p>
   <p class="formulaDsp">
\[            s_j^{(l)}(u_m) = d_e(\text{idim} \cdot l + j), \quad l = 0,\ldots,i_e{-}1
\]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Computation mode: <code>-1</code> (LSQ), <code>0</code> (new smoothing), <code>1</code> (continue). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Dimension of the curve, \( 1 \le \text{idim} \le 10 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Parameter values (strictly ascending). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Declared dimension of <code>x</code> and <code>xx</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data coordinates (length <code>mx</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">xx</td><td>Workspace (length <code>mx</code>). Modified data for constrained fitting. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Weights (length \( m \)), strictly positive. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>Number of derivative constraints at \( u_1 \), \( 0 \le i_b \le (k+1)/2 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">db</td><td>Begin-point derivatives (length <code>nb</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nb</td><td>Dimension of <code>db</code>, \( \ge \max(1, \text{idim} \times i_b) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ie</td><td>Number of derivative constraints at \( u_m \), \( 0 \le i_e \le (k+1)/2 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">de</td><td>End-point derivatives (length <code>ne</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ne</td><td>Dimension of <code>de</code>, \( \ge \max(1, \text{idim} \times i_e) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree: 1, 3, or 5. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \ge 0 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Over-estimate of total knots. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot positions (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Declared dimension of <code>c</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients (length <code>nc</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">np</td><td>Declared dimension of <code>cp</code>, \( \ge 2(k+1) \times \text{idim} \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cp</td><td>Constraint polynomial coefficients (length <code>np</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Declared dimension of <code>wrk</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer workspace (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag (same codes as curfit).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 8, 8.2; <a class="el" href="#a17a3995cbff15ef64c241c059a40e682" title="Core algorithm for constrained parametric curve fitting.">fpcons</a>  core constrained fitting algorithm </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a4f06e314103a691e23bd2eda4055086d_cgraph.png" border="0" usemap="#anamespacefitpack__core_a4f06e314103a691e23bd2eda4055086d_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a4f06e314103a691e23bd2eda4055086d_cgraph" id="anamespacefitpack__core_a4f06e314103a691e23bd2eda4055086d_cgraph">
<area shape="rect" title="Determine a smooth parametric spline curve with derivative constraints at endpoints." alt="" coords="5,248,157,273"/>
<area shape="rect" href="namespacefitpack__core.html#a5d7ebdb8afd5f3265a7f664cb9c83312" title="Evaluate a parametric spline curve at a set of parameter values." alt="" coords="210,101,355,127"/>
<area shape="poly" title=" " alt="" coords="98,246,252,133,255,137,102,250"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="845,72,991,97"/>
<area shape="poly" title=" " alt="" coords="86,247,102,214,127,171,162,126,204,87,255,55,300,39,347,30,408,22,517,7,604,3,690,11,798,33,842,46,882,64,880,68,840,51,797,38,689,17,603,9,517,13,408,27,348,36,301,44,257,60,207,91,166,129,132,174,107,217,91,249"/>
<area shape="rect" href="namespacefitpack__core.html#a8b4b656d4556778559ffea0d15d20e55" title="Add a polynomial curve to a spline curve in B&#45;spline representation." alt="" coords="205,272,360,297"/>
<area shape="poly" title=" " alt="" coords="158,267,192,271,191,276,157,272"/>
<area shape="rect" href="namespacefitpack__core.html#a7fa29b4729274b28092dd2e3a338f21c" title=" " alt="" coords="206,321,359,347"/>
<area shape="poly" title=" " alt="" coords="115,271,206,306,230,314,228,319,204,311,113,276"/>
<area shape="rect" href="namespacefitpack__core.html#a17a3995cbff15ef64c241c059a40e682" title="Core algorithm for constrained parametric curve fitting." alt="" coords="207,223,359,248"/>
<area shape="poly" title=" " alt="" coords="157,248,192,244,193,249,158,254"/>
<area shape="rect" href="namespacefitpack__core.html#a1c1c9269f27beeddee5d8b680aaa7140" title="Construct a polynomial curve satisfying endpoint derivative constraints." alt="" coords="206,371,359,396"/>
<area shape="poly" title=" " alt="" coords="97,271,143,312,207,356,223,363,221,368,204,360,140,317,94,275"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="413,37,571,77"/>
<area shape="poly" title=" " alt="" coords="329,99,405,78,406,83,331,104"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="417,101,567,127"/>
<area shape="poly" title=" " alt="" coords="356,111,403,111,403,117,356,117"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="624,72,797,97"/>
<area shape="poly" title=" " alt="" coords="567,101,610,95,611,101,567,107"/>
<area shape="poly" title=" " alt="" coords="677,74,670,64,673,54,687,48,711,45,739,49,751,58,747,62,737,54,711,51,689,53,677,57,675,63,681,70"/>
<area shape="poly" title=" " alt="" coords="798,82,832,82,832,87,798,87"/>
<area shape="poly" title=" " alt="" coords="884,74,877,64,881,54,895,48,918,45,947,49,958,58,955,62,944,54,918,51,896,53,885,57,882,63,888,70"/>
<area shape="rect" href="namespacefitpack__core.html#a3d51410017bf94f298da66b1d80fe524" title="Insert a single knot into a B&#45;spline representation." alt="" coords="419,493,565,519"/>
<area shape="poly" title=" " alt="" coords="346,295,362,307,378,329,386,351,387,395,388,437,395,458,410,479,416,484,412,488,406,482,390,461,382,438,381,395,380,352,373,331,358,311,343,300"/>
<area shape="poly" title=" " alt="" coords="291,221,347,149,380,112,406,87,415,81,418,85,410,91,384,115,351,153,296,224"/>
<area shape="poly" title=" " alt="" coords="295,221,342,180,373,157,407,137,425,129,427,134,409,142,376,162,345,184,299,225"/>
<area shape="rect" href="namespacefitpack__core.html#a82db002de9c1abeba86fae180dbec079" title="Rotate an observation row into a band matrix with vector RHS." alt="" coords="408,151,576,191"/>
<area shape="poly" title=" " alt="" coords="325,220,412,193,414,198,326,225"/>
<area shape="rect" href="namespacefitpack__core.html#a73c05ec35eef6da81086156d5cf0597d" title="Rotate a smoothing&#45;matrix row into a band matrix with vector RHS." alt="" coords="408,215,576,255"/>
<area shape="poly" title=" " alt="" coords="359,233,394,233,394,238,359,238"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="415,280,569,305"/>
<area shape="poly" title=" " alt="" coords="331,246,433,274,431,279,329,251"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="418,329,566,355"/>
<area shape="poly" title=" " alt="" coords="339,246,362,257,377,272,386,287,395,301,410,315,422,322,420,326,406,319,391,304,382,289,373,275,358,262,336,250"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="417,379,567,404"/>
<area shape="poly" title=" " alt="" coords="344,246,362,257,374,271,381,285,387,312,392,339,399,351,410,364,418,370,415,374,406,368,394,354,387,341,381,313,376,287,369,274,358,261,341,250"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="425,429,559,469"/>
<area shape="poly" title=" " alt="" coords="346,246,362,257,377,277,385,297,387,336,390,375,396,394,410,414,415,418,411,422,406,417,392,397,384,376,382,337,380,299,372,280,358,261,343,250"/>
<area shape="poly" title=" " alt="" coords="576,152,840,98,841,103,577,157"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="636,173,785,199"/>
<area shape="poly" title=" " alt="" coords="576,174,622,177,622,183,576,180"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="637,223,785,248"/>
<area shape="poly" title=" " alt="" coords="562,189,654,216,653,221,560,194"/>
<area shape="poly" title=" " alt="" coords="576,214,640,199,641,204,577,219"/>
<area shape="poly" title=" " alt="" coords="576,233,623,233,623,238,576,238"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="639,436,783,461"/>
<area shape="poly" title=" " alt="" coords="560,446,625,446,625,451,560,451"/>
</map>
</div>

</div>
</div>
<a id="a5c2705f0e7063ef12ffd607c3d07f39c" name="a5c2705f0e7063ef12ffd607c3d07f39c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c2705f0e7063ef12ffd607c3d07f39c">&#9670;&#160;</a></span>cualde()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::cualde </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nd), intent(out)</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate all derivatives of a parametric spline curve at a single point. </p>
<p>Given an <code>idim</code>-dimensional spline curve \( \mathbf{s}(u) = (s_1(u),\ldots,s_{\text{idim}}(u)) \) of order \( k_1 = k + 1 \) with common knots, evaluates all derivatives up to order \( k \) at the point \( u \). Uses the stable recurrence scheme of de Boor for each coordinate component.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Dimension of the curve. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot positions (length \( n \)), common to all components. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients (length <code>nc</code>), stored as \( n \) coefficients for each of the <code>idim</code> components consecutively. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Total number of coefficients ( \( \ge n \times \text{idim} \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k1</td><td>Order of the spline ( \( k_1 = k + 1 \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Parameter value where derivatives are evaluated. Must satisfy \( t_{k_1} \le u \le t_{n-k_1+1} \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d</td><td>Derivative values (length <code>nd</code>): <code>d(idim*l+j)</code> contains the \( j \)-th coordinate of the \( l \)-th derivative. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nd</td><td>Dimension of <code>d</code>. Must satisfy \( \text{nd} \ge k_1 \times \text{idim} \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>At a knot, right derivatives are computed (left derivatives at the right boundary).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a0c64b88d2d403641e200a68c9604f425" title="Evaluate all derivatives of a spline at a single point.">spalde</a>  scalar variant; <a class="el" href="#ab6b368d82e72f0bde7c8a9cc60eb76f2">fpader</a>  derivative computation kernel </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a5c2705f0e7063ef12ffd607c3d07f39c_cgraph.png" border="0" usemap="#anamespacefitpack__core_a5c2705f0e7063ef12ffd607c3d07f39c_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a5c2705f0e7063ef12ffd607c3d07f39c_cgraph" id="anamespacefitpack__core_a5c2705f0e7063ef12ffd607c3d07f39c_cgraph">
<area shape="rect" title="Evaluate all derivatives of a parametric spline curve at a single point." alt="" coords="5,42,157,67"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="205,5,364,45"/>
<area shape="poly" title=" " alt="" coords="157,41,191,36,192,41,158,46"/>
<area shape="rect" href="namespacefitpack__core.html#ab6b368d82e72f0bde7c8a9cc60eb76f2" title=" " alt="" coords="209,70,360,95"/>
<area shape="poly" title=" " alt="" coords="158,62,196,68,196,73,157,68"/>
</map>
</div>

</div>
</div>
<a id="a5d7ebdb8afd5f3265a7f664cb9c83312" name="a5d7ebdb8afd5f3265a7f664cb9c83312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d7ebdb8afd5f3265a7f664cb9c83312">&#9670;&#160;</a></span>curev()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::curev </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(idim,m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate a parametric spline curve at a set of parameter values. </p>
<p>Given an <code>idim</code>-dimensional spline curve \( \mathbf{s}(u) = (s_1(u),\ldots,s_{\text{idim}}(u)) \) of degree \( k \) in B-spline representation with common knots, evaluates \( \mathbf{s}(u_i) \) for \( i = 1,\ldots,m \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Dimension of the curve ( \( 1 \le \text{idim} \le 10 \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot positions (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients (length <code>nc</code>), stored consecutively for each dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Total number of coefficients. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Degree of the spline. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Parameter values (length \( m \)), must be non-decreasing and within \( [t_{k+1}, t_{n-k}] \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of evaluation points, \( m \ge 1 \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>Curve values (length <code>mx</code>): <code>x(idim*(i-1)+j)</code> is the \( j \)-th coordinate at the \( i \)-th point. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Dimension of <code>x</code>. Must satisfy \( \text{mx} \ge m \times \text{idim} \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.3; <a class="el" href="#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non-zero B-splines at a given point.">fpbspl</a>  B-spline basis evaluation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a5d7ebdb8afd5f3265a7f664cb9c83312_cgraph.png" border="0" usemap="#anamespacefitpack__core_a5d7ebdb8afd5f3265a7f664cb9c83312_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a5d7ebdb8afd5f3265a7f664cb9c83312_cgraph" id="anamespacefitpack__core_a5d7ebdb8afd5f3265a7f664cb9c83312_cgraph">
<area shape="rect" title="Evaluate a parametric spline curve at a set of parameter values." alt="" coords="5,42,151,67"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="199,5,357,45"/>
<area shape="poly" title=" " alt="" coords="151,41,185,36,186,42,152,47"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="203,70,353,95"/>
<area shape="poly" title=" " alt="" coords="152,62,190,68,190,73,151,67"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="405,70,579,95"/>
<area shape="poly" title=" " alt="" coords="353,80,392,80,392,85,353,85"/>
<area shape="poly" title=" " alt="" coords="458,72,451,62,455,52,469,46,492,43,521,47,532,56,529,60,518,52,492,49,470,51,459,55,456,61,462,68"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="627,70,772,95"/>
<area shape="poly" title=" " alt="" coords="579,80,613,80,613,85,579,85"/>
<area shape="poly" title=" " alt="" coords="666,72,658,62,662,52,676,46,699,43,728,47,739,56,736,60,726,52,699,49,677,51,666,55,664,61,670,68"/>
</map>
</div>

</div>
</div>
<a id="ac65af4d46ed853e0bfe2274ea2660b0f" name="ac65af4d46ed853e0bfe2274ea2660b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac65af4d46ed853e0bfe2274ea2660b0f">&#9670;&#160;</a></span>curfit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::curfit </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xe</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine a smooth spline approximation of degree \( k \) to a set of data points. </p>
<p>Given data points \( (x_i, y_i) \) with positive weights \( w_i \), \( i=1,\ldots,m \), computes a spline \( s(x) \) of degree \( k \) on the interval \( [x_b, x_e] \).</p>
<ul>
<li>If <code>iopt=-1</code>: computes the weighted least-squares spline for a given set of knots.</li>
<li>If <code>iopt&gt;=0</code>: the number and position of knots is chosen automatically. Smoothness is achieved by minimizing discontinuity jumps of the \( k \)-th derivative at interior knots, subject to the constraint   <p class="formulaDsp">
\[                F(p) = \sum_{i=1}^{m} \bigl(w_i\,(y_i - s(x_i))\bigr)^2 \le S
\]
</p>
 where \( S \ge 0 \) is the smoothing factor.</li>
</ul>
<p>The result is returned in B-spline representation with coefficients  \( c_j,\ 
j=1,\ldots,n{-}k{-}1 \) and can be evaluated with splev. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ac65af4d46ed853e0bfe2274ea2660b0f_cgraph.png" border="0" usemap="#anamespacefitpack__core_ac65af4d46ed853e0bfe2274ea2660b0f_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ac65af4d46ed853e0bfe2274ea2660b0f_cgraph" id="anamespacefitpack__core_ac65af4d46ed853e0bfe2274ea2660b0f_cgraph">
<area shape="rect" title="Determine a smooth spline approximation of degree &#160;to a set of data points." alt="" coords="5,468,148,493"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="864,219,1009,244"/>
<area shape="poly" title=" " alt="" coords="148,486,239,492,352,491,474,480,535,469,594,453,644,434,692,410,782,354,858,297,910,251,914,255,861,301,786,358,695,414,646,439,595,458,536,474,475,486,352,497,239,497,148,491"/>
<area shape="rect" href="namespacefitpack__core.html#a3e1011bf7749aa62d3c05bd1a20e36d1" title="Verify knot positions against data points (Schoenberg&#45;Whitney check)." alt="" coords="196,519,348,544"/>
<area shape="poly" title=" " alt="" coords="127,491,210,513,209,518,126,496"/>
<area shape="rect" href="namespacefitpack__core.html#a4763622af119a94c3be9390ee5d12eb3" title="Core algorithm for univariate spline curve fitting." alt="" coords="199,247,345,272"/>
<area shape="poly" title=" " alt="" coords="87,466,248,281,252,284,91,469"/>
<area shape="poly" title=" " alt="" coords="903,220,896,210,899,200,913,194,937,192,965,196,977,205,973,209,963,201,937,197,915,199,903,204,901,210,907,217"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="416,303,575,343"/>
<area shape="poly" title=" " alt="" coords="318,270,413,297,411,302,317,275"/>
<area shape="rect" href="namespacefitpack__core.html#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="396,189,595,215"/>
<area shape="poly" title=" " alt="" coords="322,244,395,225,431,216,432,221,397,230,323,249"/>
<area shape="rect" href="namespacefitpack__core.html#aa452051613d61831a99b2f9ef8e21bc8" title="Rotate a smoothing&#45;matrix row into a band matrix using shifted pivots." alt="" coords="411,239,579,279"/>
<area shape="poly" title=" " alt="" coords="346,257,397,257,397,262,346,262"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="419,368,572,393"/>
<area shape="poly" title=" " alt="" coords="288,271,334,311,364,334,397,353,418,361,416,366,395,358,362,338,331,316,285,275"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="421,25,570,51"/>
<area shape="poly" title=" " alt="" coords="275,245,289,209,314,159,349,106,370,82,394,61,407,54,410,58,398,65,374,86,353,109,318,162,294,211,280,247"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="421,417,569,443"/>
<area shape="poly" title=" " alt="" coords="283,271,325,335,358,372,397,404,410,410,407,415,395,408,355,376,321,338,278,274"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="420,140,571,165"/>
<area shape="poly" title=" " alt="" coords="287,244,333,209,395,174,414,167,416,172,397,179,336,214,290,249"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="428,75,563,115"/>
<area shape="poly" title=" " alt="" coords="280,245,324,188,357,154,395,125,414,115,416,120,397,130,361,158,328,191,284,248"/>
<area shape="poly" title=" " alt="" coords="553,187,608,177,675,171,746,170,817,178,862,192,902,210,900,215,860,197,815,183,746,175,675,176,609,183,554,192"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="655,243,804,268"/>
<area shape="poly" title=" " alt="" coords="553,212,660,237,659,242,551,217"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="655,193,803,219"/>
<area shape="poly" title=" " alt="" coords="595,201,641,202,641,207,595,206"/>
<area shape="poly" title=" " alt="" coords="580,273,692,285,755,284,815,277,859,264,898,248,900,253,861,269,817,282,755,289,692,290,579,279"/>
<area shape="poly" title=" " alt="" coords="579,255,641,254,641,260,580,261"/>
<area shape="poly" title=" " alt="" coords="579,238,659,219,660,224,580,243"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="643,29,816,55"/>
<area shape="poly" title=" " alt="" coords="571,37,629,38,629,43,570,42"/>
<area shape="poly" title=" " alt="" coords="788,52,818,68,853,100,884,137,925,205,921,208,879,140,850,104,814,72,785,57"/>
<area shape="poly" title=" " alt="" coords="696,31,688,21,692,11,706,5,729,3,758,6,769,15,766,20,756,11,729,8,707,10,696,15,694,20,700,28"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="657,83,801,108"/>
<area shape="poly" title=" " alt="" coords="563,93,644,93,644,98,563,98"/>
</map>
</div>

</div>
</div>
<a id="aad87800d8674963f83316e6a9a6c9cce" name="aad87800d8674963f83316e6a9a6c9cce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad87800d8674963f83316e6a9a6c9cce">&#9670;&#160;</a></span>dblint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, public fitpack_core::dblint </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nx-kx-1)*(ny-ky-1)), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xe</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>yb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ye</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx+ny-kx-ky-2), intent(out)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the double integral of a bivariate spline over a rectangle. </p>
<p>Calculates \( \int_{x_b}^{x_e} \int_{y_b}^{y_e} s(x,y)\,dx\,dy \) for a bivariate spline of degrees \( k_x \) and \( k_y \) in tensor-product B-spline representation. The spline is considered identically zero outside its support rectangle \( (t^x_{k_x+1}, t^x_{n_x-k_x}) \times (t^y_{k_y+1}, t^y_{n_y-k_y}) \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>Knot positions in \( x \) (length \( n_x \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Total number of knots in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ty</td><td>Knot positions in \( y \) (length \( n_y \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Total number of knots in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients, length \( (n_x{-}k_x{-}1)(n_y{-}k_y{-}1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Degree in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Degree in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xb</td><td>Left boundary of integration in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xe</td><td>Right boundary of integration in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yb</td><td>Lower boundary of integration in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>Upper boundary of integration in \( y \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">wrk</td><td>Workspace (length \( \ge n_x + n_y - k_x - k_y - 2 \)). On exit, contains integrals of normalized B-splines in each direction. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The double integral \( \iint s(x,y)\,dx\,dy \).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a7125f23ea644bcee0719e6279126b038" title="Compute the definite integral of a spline  over .">splint</a>  univariate integral; <a class="el" href="#aaa4be60a77a5e3a8b9e0013517b221b2" title="Compute definite integrals of the normalized B-splines.">fpintb</a>  B-spline integration </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_aad87800d8674963f83316e6a9a6c9cce_cgraph.png" border="0" usemap="#anamespacefitpack__core_aad87800d8674963f83316e6a9a6c9cce_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_aad87800d8674963f83316e6a9a6c9cce_cgraph" id="anamespacefitpack__core_aad87800d8674963f83316e6a9a6c9cce_cgraph">
<area shape="rect" title="Compute the double integral of a bivariate spline over a rectangle." alt="" coords="5,55,152,80"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="401,29,547,55"/>
<area shape="poly" title=" " alt="" coords="152,60,387,45,388,50,152,65"/>
<area shape="rect" href="namespacefitpack__core.html#aaa4be60a77a5e3a8b9e0013517b221b2" title="Compute definite integrals of the normalized B&#45;splines." alt="" coords="200,80,347,105"/>
<area shape="poly" title=" " alt="" coords="152,74,187,79,186,84,152,79"/>
<area shape="poly" title=" " alt="" coords="441,31,434,21,438,11,451,5,474,3,502,6,513,16,510,20,500,11,474,8,453,10,442,15,439,20,445,28"/>
<area shape="poly" title=" " alt="" coords="324,77,409,55,411,61,325,82"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="395,79,553,119"/>
<area shape="poly" title=" " alt="" coords="347,92,381,94,381,99,347,98"/>
</map>
</div>

</div>
</div>
<a id="a44e0185b61cf87f55a1a6ffb9f10fb98" name="a44e0185b61cf87f55a1a6ffb9f10fb98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44e0185b61cf87f55a1a6ffb9f10fb98">&#9670;&#160;</a></span>equal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function, public fitpack_core::equal </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test whether two reals are equal within machine precision. </p>
<p>Returns <code>.true.</code> if \( |a - b| &lt; \text{spacing}(\min(|a|,|b|)) \). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a44e0185b61cf87f55a1a6ffb9f10fb98_cgraph.png" border="0" usemap="#anamespacefitpack__core_a44e0185b61cf87f55a1a6ffb9f10fb98_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a44e0185b61cf87f55a1a6ffb9f10fb98_cgraph" id="anamespacefitpack__core_a44e0185b61cf87f55a1a6ffb9f10fb98_cgraph">
<area shape="rect" title="Test whether two reals are equal within machine precision." alt="" coords="5,29,151,55"/>
<area shape="poly" title=" " alt="" coords="53,30,48,21,51,11,61,5,78,3,98,6,107,15,103,18,95,11,78,8,63,10,55,15,54,20,58,28"/>
</map>
</div>

</div>
</div>
<a id="afe28377d1376dd629fcd34340fd3949b" name="afe28377d1376dd629fcd34340fd3949b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe28377d1376dd629fcd34340fd3949b">&#9670;&#160;</a></span>evapol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, public fitpack_core::evapol </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nu-4)*(nv-4)), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(<a class="el" href="interfacefitpack__core_1_1fitpack__polar__boundary.html">fitpack_polar_boundary</a>)</td>          <td class="paramname"><span class="paramname"><em>rad</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate a polar spline \( f(x,y) = s(u,v) \) at a Cartesian point. </p>
<p>Given a bicubic spline \( s(u,v) \) ( \( 0 \le u \le 1 \), \( -\pi \le v \le \pi \)) fitted by polar, evaluates \( f(x,y) \) via the polar transformation:   </p><p class="formulaDsp">
\[            x = u \cdot r(v) \cos v, \qquad y = u \cdot r(v) \sin v
\]
</p>
<p> where \( r(v) \) is the boundary function defining the polar domain.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tu</td><td>Knot positions in \( u \) (length \( n_u \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Total number of knots in \( u \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tv</td><td>Knot positions in \( v \) (length \( n_v \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nv</td><td>Total number of knots in \( v \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients, length \( (n_u{-}4)(n_v{-}4) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rad</td><td>Boundary function \( r(v) \) defining the polar domain. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Cartesian \( x \)-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Cartesian \( y \)-coordinate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value \( f(x,y) = s(u,v) \).</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.1; <a class="el" href="#a406065ef7b15f1380c2759e9650355f2" title="Fit a smooth bivariate spline to scattered data on a polar domain.">polar</a>  <a class="el" href="#a406065ef7b15f1380c2759e9650355f2" title="Fit a smooth bivariate spline to scattered data on a polar domain.">polar</a> spline fitting </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_afe28377d1376dd629fcd34340fd3949b_cgraph.png" border="0" usemap="#anamespacefitpack__core_afe28377d1376dd629fcd34340fd3949b_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_afe28377d1376dd629fcd34340fd3949b_cgraph" id="anamespacefitpack__core_afe28377d1376dd629fcd34340fd3949b_cgraph">
<area shape="rect" title="Evaluate a polar spline &#160;at a Cartesian point." alt="" coords="5,42,159,67"/>
<area shape="rect" href="namespacefitpack__core.html#aac8fa7ec692eb2758290f050c302d22d" title="Evaluate a bivariate spline on a rectangular grid." alt="" coords="207,42,359,67"/>
<area shape="poly" title=" " alt="" coords="159,52,193,52,193,57,159,57"/>
<area shape="rect" href="namespacefitpack__core.html#a72432bc4ebc7c5ff0425d188147d7dbb" title="Evaluate a tensor product spline on a grid." alt="" coords="407,42,556,67"/>
<area shape="poly" title=" " alt="" coords="359,52,393,52,393,57,359,57"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="604,5,763,45"/>
<area shape="poly" title=" " alt="" coords="556,41,590,36,591,41,557,46"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="609,70,758,95"/>
<area shape="poly" title=" " alt="" coords="557,62,596,68,595,73,556,68"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="811,70,984,95"/>
<area shape="poly" title=" " alt="" coords="759,80,797,80,797,85,759,85"/>
<area shape="poly" title=" " alt="" coords="864,72,856,62,860,52,874,46,897,43,926,47,937,56,934,60,924,52,897,49,875,51,864,55,862,61,868,68"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="1032,70,1177,95"/>
<area shape="poly" title=" " alt="" coords="984,80,1018,80,1018,85,984,85"/>
<area shape="poly" title=" " alt="" coords="1071,72,1064,62,1067,52,1081,46,1105,43,1133,47,1145,56,1141,60,1131,52,1105,49,1083,51,1071,55,1069,61,1075,68"/>
</map>
</div>

</div>
</div>
<a id="a57f64e9a19e2d3171ba5ccc07a5d56a2" name="a57f64e9a19e2d3171ba5ccc07a5d56a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57f64e9a19e2d3171ba5ccc07a5d56a2">&#9670;&#160;</a></span>fitpack_argsort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function, dimension(size(list)), public fitpack_core::fitpack_argsort </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>list</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the permutation indices that would sort an array. </p>
<p>Returns an index array <code>ilist</code> such that <code>list(ilist)</code> is in ascending order.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">list</td><td>Array of values to sort. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index permutation (length <code>size(list)</code>). </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a57f64e9a19e2d3171ba5ccc07a5d56a2_cgraph.png" border="0" usemap="#anamespacefitpack__core_a57f64e9a19e2d3171ba5ccc07a5d56a2_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a57f64e9a19e2d3171ba5ccc07a5d56a2_cgraph" id="anamespacefitpack__core_a57f64e9a19e2d3171ba5ccc07a5d56a2_cgraph">
<area shape="rect" title="Return the permutation indices that would sort an array." alt="" coords="5,95,159,135"/>
<area shape="rect" href="namespacefitpack__core.html#a91926262dc58e19b1b4345d9696c90db" title="In&#45;place quicksort with optional index tracking." alt="" coords="207,95,360,135"/>
<area shape="poly" title=" " alt="" coords="159,113,193,113,193,118,159,118"/>
<area shape="poly" title=" " alt="" coords="249,96,247,86,253,77,265,71,283,69,305,72,316,79,313,83,303,77,283,74,266,76,256,81,253,87,255,94"/>
<area shape="rect" href="fitpack__core_8_f90.html#a6e2d25f0c47b08f7fced619525b1a825" title=" " alt="" coords="408,103,517,128"/>
<area shape="poly" title=" " alt="" coords="360,113,394,113,394,118,360,118"/>
<area shape="poly" title=" " alt="" coords="433,104,427,94,430,85,442,78,463,76,487,80,498,88,494,92,485,84,463,81,444,83,434,88,432,94,437,101"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="577,29,723,55"/>
<area shape="poly" title=" " alt="" coords="486,100,564,64,586,56,587,61,566,68,488,105"/>
<area shape="rect" href="namespacefitpack__core.html#ab9e559a7491e780d631b07d895b4ff98" title="Test &#160;(strict greater&#45;than)." alt="" coords="571,103,729,128"/>
<area shape="poly" title=" " alt="" coords="517,113,557,113,557,118,517,118"/>
<area shape="rect" href="namespacefitpack__core.html#a69c35a8032dd7dfa0b593ce00610d36f" title="Test &#160;(strict less&#45;than)." alt="" coords="565,176,735,201"/>
<area shape="poly" title=" " alt="" coords="497,126,605,168,603,173,495,131"/>
<area shape="poly" title=" " alt="" coords="619,31,613,21,616,11,629,5,650,3,676,6,686,15,683,19,674,11,650,8,630,10,620,15,618,20,623,28"/>
<area shape="poly" title=" " alt="" coords="619,104,613,94,616,84,629,78,650,76,676,80,686,88,683,92,674,84,650,81,630,83,620,88,618,94,623,101"/>
<area shape="poly" title=" " alt="" coords="619,177,613,168,616,158,629,152,650,149,676,153,686,162,683,166,674,158,650,155,630,157,620,161,618,167,623,174"/>
</map>
</div>

</div>
</div>
<a id="a2df24a0ee6fecec68ea6b06ee1f28e08" name="a2df24a0ee6fecec68ea6b06ee1f28e08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2df24a0ee6fecec68ea6b06ee1f28e08">&#9670;&#160;</a></span>fitpack_error_handling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fitpack_core::fitpack_error_handling </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ierr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out), optional</td>          <td class="paramname"><span class="paramname"><em>ierr_out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in)</td>          <td class="paramname"><span class="paramname"><em>whereat</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispatch an error code: return it to caller or halt with a message. </p>
<p>If <code>ierr_out</code> is present, the error code is returned through it. Otherwise, if <code>ierr</code> indicates failure, the program halts with a diagnostic message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ierr</td><td>Error flag from a FITPACK routine. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr_out</td><td>Optional output flag; if present, receives <code>ierr</code> instead of halting. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">whereAt</td><td>Location string for the diagnostic message. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a2df24a0ee6fecec68ea6b06ee1f28e08_cgraph.png" border="0" usemap="#anamespacefitpack__core_a2df24a0ee6fecec68ea6b06ee1f28e08_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a2df24a0ee6fecec68ea6b06ee1f28e08_cgraph" id="anamespacefitpack__core_a2df24a0ee6fecec68ea6b06ee1f28e08_cgraph">
<area shape="rect" title="Dispatch an error code: return it to caller or halt with a message." alt="" coords="5,49,159,89"/>
<area shape="rect" href="namespacefitpack__core.html#acecd9e9bd2b5f16cc9ba6d0263b275c5" title="Convert an integer error flag to a human&#45;readable message string." alt="" coords="207,5,360,45"/>
<area shape="poly" title=" " alt="" coords="158,50,193,42,194,48,160,55"/>
<area shape="rect" href="namespacefitpack__core.html#ab0ebd1c826f330de0103ba72e55260ba" title="Test whether a FITPACK error flag indicates success." alt="" coords="207,93,360,133"/>
<area shape="poly" title=" " alt="" coords="160,83,194,91,193,96,158,89"/>
<area shape="poly" title=" " alt="" coords="246,94,243,84,249,75,263,69,283,67,307,70,320,77,317,82,305,75,283,72,264,74,253,79,249,85,251,92"/>
</map>
</div>

</div>
</div>
<a id="acecd9e9bd2b5f16cc9ba6d0263b275c5" name="acecd9e9bd2b5f16cc9ba6d0263b275c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acecd9e9bd2b5f16cc9ba6d0263b275c5">&#9670;&#160;</a></span>fitpack_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure character(len=:) function, allocatable, public fitpack_core::fitpack_message </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ierr</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert an integer error flag to a human-readable message string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ierr</td><td>FITPACK error flag (e.g., <code>FITPACK_OK</code>, <code>FITPACK_INPUT_ERROR</code>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Allocatable character string describing the error. </dd></dl>

</div>
</div>
<a id="a91926262dc58e19b1b4345d9696c90db" name="a91926262dc58e19b1b4345d9696c90db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91926262dc58e19b1b4345d9696c90db">&#9670;&#160;</a></span>fitpack_quicksort()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure recursive subroutine fitpack_core::fitpack_quicksort </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>list</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(size(list)), intent(inout), optional</td>          <td class="paramname"><span class="paramname"><em>ilist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>down</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>In-place quicksort with optional index tracking. </p>
<p>Sorts <code>list</code> in ascending order (or descending if <code>down=.true.</code>). If <code>ilist</code> is present, its elements are permuted in parallel to track the original positions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">list</td><td>Array to sort. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ilist</td><td>Optional index array, permuted alongside <code>list</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">down</td><td>Optional flag for descending order. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a91926262dc58e19b1b4345d9696c90db_cgraph.png" border="0" usemap="#anamespacefitpack__core_a91926262dc58e19b1b4345d9696c90db_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a91926262dc58e19b1b4345d9696c90db_cgraph" id="anamespacefitpack__core_a91926262dc58e19b1b4345d9696c90db_cgraph">
<area shape="rect" title="In&#45;place quicksort with optional index tracking." alt="" coords="5,95,159,135"/>
<area shape="poly" title=" " alt="" coords="48,96,46,86,51,77,64,71,82,69,103,72,115,79,112,83,101,77,82,74,65,76,55,81,51,87,53,94"/>
<area shape="rect" href="fitpack__core_8_f90.html#a6e2d25f0c47b08f7fced619525b1a825" title=" " alt="" coords="207,103,316,128"/>
<area shape="poly" title=" " alt="" coords="159,113,193,113,193,118,159,118"/>
<area shape="poly" title=" " alt="" coords="232,104,225,94,229,85,241,78,261,76,286,80,296,88,293,92,284,84,261,81,242,83,233,88,231,94,236,101"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="376,29,521,55"/>
<area shape="poly" title=" " alt="" coords="285,100,363,64,384,56,386,61,365,68,287,105"/>
<area shape="rect" href="namespacefitpack__core.html#ab9e559a7491e780d631b07d895b4ff98" title="Test &#160;(strict greater&#45;than)." alt="" coords="370,103,527,128"/>
<area shape="poly" title=" " alt="" coords="316,113,356,113,356,118,316,118"/>
<area shape="rect" href="namespacefitpack__core.html#a69c35a8032dd7dfa0b593ce00610d36f" title="Test &#160;(strict less&#45;than)." alt="" coords="364,176,533,201"/>
<area shape="poly" title=" " alt="" coords="296,126,403,168,401,173,294,131"/>
<area shape="poly" title=" " alt="" coords="418,31,411,21,415,11,427,5,449,3,474,6,485,15,482,19,472,11,449,8,429,10,419,15,416,20,422,28"/>
<area shape="poly" title=" " alt="" coords="418,104,411,94,415,84,427,78,449,76,474,80,485,88,482,92,472,84,449,81,429,83,419,88,416,94,422,101"/>
<area shape="poly" title=" " alt="" coords="418,177,411,168,415,158,427,152,449,149,474,153,485,162,482,166,472,158,449,155,429,157,419,161,416,167,422,174"/>
</map>
</div>

</div>
</div>
<a id="ab0ebd1c826f330de0103ba72e55260ba" name="ab0ebd1c826f330de0103ba72e55260ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0ebd1c826f330de0103ba72e55260ba">&#9670;&#160;</a></span>fitpack_success()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function, public fitpack_core::fitpack_success </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ierr</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test whether a FITPACK error flag indicates success. </p>
<p>Returns <code>.true.</code> if <code>ierr &lt;= 0</code> (i.e., <code>FITPACK_OK</code> or any negative success variant).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ierr</td><td>Error flag from a FITPACK routine. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>.true.</code> on success, <code>.false.</code> on error. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ab0ebd1c826f330de0103ba72e55260ba_cgraph.png" border="0" usemap="#anamespacefitpack__core_ab0ebd1c826f330de0103ba72e55260ba_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ab0ebd1c826f330de0103ba72e55260ba_cgraph" id="anamespacefitpack__core_ab0ebd1c826f330de0103ba72e55260ba_cgraph">
<area shape="rect" title="Test whether a FITPACK error flag indicates success." alt="" coords="5,29,159,69"/>
<area shape="poly" title=" " alt="" coords="53,29,51,20,56,11,66,5,82,3,100,6,110,13,107,17,98,11,82,8,68,10,59,14,56,21,58,28"/>
</map>
</div>

</div>
</div>
<a id="a2256640832da2724f9e5058bcebd6ec2" name="a2256640832da2724f9e5058bcebd6ec2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2256640832da2724f9e5058bcebd6ec2">&#9670;&#160;</a></span>fourco()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::fourco </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>alfa</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>resc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute Fourier coefficients of a cubic spline. </p>
<p>For a cubic spline \( s(x) \) and a set of parameters \( \alpha_i \), \( i = 1,\ldots,m \), computes the Fourier integrals:    </p><p class="formulaDsp">
\[            R_s(i) = \int s(x) \sin(\alpha_i x)\,dx, \qquad
            R_c(i) = \int s(x) \cos(\alpha_i x)\,dx
\]
</p>
<p> over the support of the spline.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot positions (length \( n \)). Must have \( n \ge 10 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alfa</td><td>Fourier parameters \( \alpha_i \) (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of integrals to compute. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ress</td><td>Sine integrals \( R_s(i) \) (length \( m \)). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">resc</td><td>Cosine integrals \( R_c(i) \) (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk1</td><td>Real workspace (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk2</td><td>Real workspace (length \( n \)). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 3, 3.3; <a class="el" href="#acc0e64bf7c182c225873ce2bfac77ab1" title="Compute Fourier coefficients of cubic B-splines.">fpbfou</a>  B-spline Fourier integrals; <a class="el" href="#a8c6900d3b80033043b2b73b49ce84fc2" title="Compute weighted Fourier integrals of a cubic polynomial.">fpcsin</a>  cos/sin integrals </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a2256640832da2724f9e5058bcebd6ec2_cgraph.png" border="0" usemap="#anamespacefitpack__core_a2256640832da2724f9e5058bcebd6ec2_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a2256640832da2724f9e5058bcebd6ec2_cgraph" id="anamespacefitpack__core_a2256640832da2724f9e5058bcebd6ec2_cgraph">
<area shape="rect" title="Compute Fourier coefficients of a cubic spline." alt="" coords="5,43,156,68"/>
<area shape="rect" href="namespacefitpack__core.html#acc0e64bf7c182c225873ce2bfac77ab1" title="Compute Fourier coefficients of cubic B&#45;splines." alt="" coords="204,43,355,68"/>
<area shape="poly" title=" " alt="" coords="156,53,190,53,190,58,156,58"/>
<area shape="rect" href="namespacefitpack__core.html#a8c6900d3b80033043b2b73b49ce84fc2" title="Compute weighted Fourier integrals of a cubic polynomial." alt="" coords="415,5,563,31"/>
<area shape="poly" title=" " alt="" coords="351,40,404,30,405,36,352,45"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="403,79,576,104"/>
<area shape="poly" title=" " alt="" coords="354,65,402,74,401,79,353,71"/>
<area shape="poly" title=" " alt="" coords="456,80,448,70,452,60,466,54,489,52,518,56,529,65,526,69,516,61,489,57,467,59,456,64,454,70,460,77"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="624,79,769,104"/>
<area shape="poly" title=" " alt="" coords="576,89,610,89,610,94,576,94"/>
<area shape="poly" title=" " alt="" coords="663,80,656,70,659,60,673,54,697,52,725,56,737,65,733,69,723,61,697,57,675,59,663,64,661,70,667,77"/>
</map>
</div>

</div>
</div>
<a id="aa55f37b7d9b1ed9015f7637067e8a96b" name="aa55f37b7d9b1ed9015f7637067e8a96b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa55f37b7d9b1ed9015f7637067e8a96b">&#9670;&#160;</a></span>fp_bool_comm_expand_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_bool_comm_expand_1d </td>
          <td>(</td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), dimension(:), intent(out), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Expand communication buffer into 1D logical(FP_BOOL) allocatable array. </p>

</div>
</div>
<a id="acf008db646c0e7bd2afc2f44a7ed903a" name="acf008db646c0e7bd2afc2f44a7ed903a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf008db646c0e7bd2afc2f44a7ed903a">&#9670;&#160;</a></span>fp_bool_comm_pack_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_bool_comm_pack_1d </td>
          <td>(</td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), dimension(:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a>), dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack 1D logical(FP_BOOL) allocatable array into communication buffer. </p>

</div>
</div>
<a id="a8351ecca3ca1adefde53fc395912d1c2" name="a8351ecca3ca1adefde53fc395912d1c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8351ecca3ca1adefde53fc395912d1c2">&#9670;&#160;</a></span>fp_bool_comm_size_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function fitpack_core::fp_bool_comm_size_1d </td>
          <td>(</td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), dimension(:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate storage size for 1D logical(FP_BOOL) allocatable array. </p>

</div>
</div>
<a id="ab8705afed0d461ae20bf35a10b0579f5" name="ab8705afed0d461ae20bf35a10b0579f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8705afed0d461ae20bf35a10b0579f5">&#9670;&#160;</a></span>fp_knot_interval()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function fitpack_core::fp_knot_interval </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>l_start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>l_max</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges, binary for large. This replaces the repeated pattern: do while (x &gt;= t(l+1) .and. l /= l_max) l = l + 1 end do. </p>
<p>Find the knot interval containing a given value.</p>
<p>Returns the index \( l \) such that \( t_l \le x &lt; t_{l+1} \), using linear search for small ranges (or warm starts) and binary search otherwise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot array (non-decreasing). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Value to locate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">l_start</td><td>Left bound for the search. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">l_max</td><td>Right bound for the search. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Index of the interval containing <code>x</code>. </dd></dl>

</div>
</div>
<a id="a7d6e951acad3110eb2c3dfb6e5215d8b" name="a7d6e951acad3110eb2c3dfb6e5215d8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d6e951acad3110eb2c3dfb6e5215d8b">&#9670;&#160;</a></span>fp_rcomms_per_bits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elemental integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function, public fitpack_core::fp_rcomms_per_bits </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nbits</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of FP_COMM elements required to store nbits of data. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a7d6e951acad3110eb2c3dfb6e5215d8b_cgraph.png" border="0" usemap="#anamespacefitpack__core_a7d6e951acad3110eb2c3dfb6e5215d8b_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a7d6e951acad3110eb2c3dfb6e5215d8b_cgraph" id="anamespacefitpack__core_a7d6e951acad3110eb2c3dfb6e5215d8b_cgraph">
<area shape="rect" title="Number of FP_COMM elements required to store nbits of data." alt="" coords="5,29,188,69"/>
<area shape="poly" title=" " alt="" coords="62,30,60,20,66,11,78,5,97,3,118,6,130,13,127,17,116,11,97,8,79,10,69,15,65,21,67,28"/>
</map>
</div>

</div>
</div>
<a id="af9b714724c236d5cd3698b89edc4aeb6" name="af9b714724c236d5cd3698b89edc4aeb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9b714724c236d5cd3698b89edc4aeb6">&#9670;&#160;</a></span>fp_real_comm_expand_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_real_comm_expand_1d </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:), intent(out), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Expand communication buffer into 1D real(FP_REAL) allocatable array. </p>

</div>
</div>
<a id="a6ed46f895334511a1dcf2aa83057f99c" name="a6ed46f895334511a1dcf2aa83057f99c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ed46f895334511a1dcf2aa83057f99c">&#9670;&#160;</a></span>fp_real_comm_expand_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_real_comm_expand_2d </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:,:), intent(out), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Expand communication buffer into 2D real(FP_REAL) allocatable array. </p>

</div>
</div>
<a id="a108fa2cb75a9a678945f1b08abd442ea" name="a108fa2cb75a9a678945f1b08abd442ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a108fa2cb75a9a678945f1b08abd442ea">&#9670;&#160;</a></span>fp_real_comm_expand_3d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_real_comm_expand_3d </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:,:,:), intent(out), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Expand communication buffer into 3D real(FP_REAL) allocatable array. </p>

</div>
</div>
<a id="ad07f8faaf72983eb7ffbc96d3735391e" name="ad07f8faaf72983eb7ffbc96d3735391e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad07f8faaf72983eb7ffbc96d3735391e">&#9670;&#160;</a></span>fp_real_comm_pack_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_real_comm_pack_1d </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a>), dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack 1D real(FP_REAL) allocatable array into communication buffer. </p>

</div>
</div>
<a id="ae05e6292701b577dbca3bef71713bf98" name="ae05e6292701b577dbca3bef71713bf98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae05e6292701b577dbca3bef71713bf98">&#9670;&#160;</a></span>fp_real_comm_pack_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_real_comm_pack_2d </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:,:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a>), dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack 2D real(FP_REAL) allocatable array into communication buffer. </p>

</div>
</div>
<a id="a5895e3d43f0c5da6890dfbc9ccadacbc" name="a5895e3d43f0c5da6890dfbc9ccadacbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5895e3d43f0c5da6890dfbc9ccadacbc">&#9670;&#160;</a></span>fp_real_comm_pack_3d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_real_comm_pack_3d </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:,:,:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a>), dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack 3D real(FP_REAL) allocatable array into communication buffer. </p>

</div>
</div>
<a id="ac35f198a5a8f94451b070643d84e0313" name="ac35f198a5a8f94451b070643d84e0313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac35f198a5a8f94451b070643d84e0313">&#9670;&#160;</a></span>fp_real_comm_size_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function fitpack_core::fp_real_comm_size_1d </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate storage size for 1D real(FP_REAL) allocatable array Header: 1 FP_COMM storing bounds as 2 int32 (or NOT_ALLOC marker) Data: raw transfer of array contents. </p>

</div>
</div>
<a id="a00853ac5a703224d7a3ed343729e9a61" name="a00853ac5a703224d7a3ed343729e9a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00853ac5a703224d7a3ed343729e9a61">&#9670;&#160;</a></span>fp_real_comm_size_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function fitpack_core::fp_real_comm_size_2d </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:,:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate storage size for 2D real(FP_REAL) allocatable array. </p>

</div>
</div>
<a id="ad70615c7f263c0cbd802843d940cfcea" name="ad70615c7f263c0cbd802843d940cfcea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad70615c7f263c0cbd802843d940cfcea">&#9670;&#160;</a></span>fp_real_comm_size_3d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function fitpack_core::fp_real_comm_size_3d </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:,:,:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate storage size for 3D real(FP_REAL) allocatable array. </p>

</div>
</div>
<a id="abba3243913c5e568249cd4d789a2b1d2" name="abba3243913c5e568249cd4d789a2b1d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abba3243913c5e568249cd4d789a2b1d2">&#9670;&#160;</a></span>fp_rotate_2mat_stride()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_rotate_2mat_stride </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(na,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(na,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>na</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nrhs), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ldc,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ldc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nrhs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j1_start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j1_end</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate a split row into the block-triangular periodic system with stride RHS. </p>
<p>Combines the two-matrix periodic decomposition (Eq. 6.13) with the stride (row-access) RHS pattern needed for grid-based surface fitting. Rotates the split row \( [h_1 \mid h_2] \) into  \( [R_{11}^* \mid R_{12}^* 
0 \mid R_{22}^*] \) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_abba3243913c5e568249cd4d789a2b1d2_cgraph.png" border="0" usemap="#anamespacefitpack__core_abba3243913c5e568249cd4d789a2b1d2_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_abba3243913c5e568249cd4d789a2b1d2_cgraph" id="anamespacefitpack__core_abba3243913c5e568249cd4d789a2b1d2_cgraph">
<area shape="rect" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="5,48,173,88"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="443,66,588,92"/>
<area shape="poly" title=" " alt="" coords="130,46,173,28,221,15,269,7,308,3,347,5,395,15,444,33,486,56,483,61,442,38,394,20,346,11,308,8,270,12,222,20,175,33,132,51"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="233,30,383,56"/>
<area shape="poly" title=" " alt="" coords="173,56,220,51,220,56,174,61"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="234,80,382,105"/>
<area shape="poly" title=" " alt="" coords="174,75,221,80,220,85,173,80"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="221,153,395,178"/>
<area shape="poly" title=" " alt="" coords="137,86,267,145,265,150,134,91"/>
<area shape="poly" title=" " alt="" coords="482,68,474,58,478,48,492,42,515,40,544,43,555,53,552,57,542,48,515,45,493,47,482,52,480,57,486,65"/>
<area shape="poly" title=" " alt="" coords="338,150,470,95,472,100,341,155"/>
<area shape="poly" title=" " alt="" coords="274,155,267,145,271,135,285,129,308,126,337,130,348,139,345,143,334,135,308,132,286,134,275,138,272,144,278,151"/>
</map>
</div>

</div>
</div>
<a id="ab4ec4c90b00749bb021a6ec2f3433781" name="ab4ec4c90b00749bb021a6ec2f3433781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4ec4c90b00749bb021a6ec2f3433781">&#9670;&#160;</a></span>fp_rotate_row()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_rotate_row </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:,:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>yi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(:), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j_start</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate an observation row into the upper triangular band matrix. </p>
<p>Incorporates a new observation row \( h \) (containing the \( k+1 \) non-zero B-spline values) into the upper triangular band matrix \( R \) using a sequence of Givens plane rotations (Eq. 4.15). Each rotation eliminates one element of \( h \) while updating the corresponding diagonal and upper elements of \( R \), plus the scalar right-hand side:</p>
<p class="formulaDsp">
\[              \begin{pmatrix} c &amp; s \\ -s &amp; c \end{pmatrix}
              \begin{pmatrix} r_{j,j} \\ h_i \end{pmatrix}
              = \begin{pmatrix} r&#39;_{j,j} \\ 0 \end{pmatrix}
              \tag{4.15}
\]
</p>
<p>This is the standard-walk variant: \( h(i) \) pivots for \( i = 1, \ldots, \texttt{band} \), targeting rows \( j = \texttt{j\_start}+1, \ldots, \texttt{j\_start}+\texttt{band} \) of \( R \). Zero pivots are skipped.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h</td><td>Row to rotate, length <code>band</code>. Modified in place. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>Number of elements in the row (typically \( k+1 \)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Upper triangular band matrix \( R \). <code>a(j,1)</code> is the diagonal; <code>a(j,2:)</code> stores the upper bandwidth. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">yi</td><td>Scalar RHS contribution; updated by each rotation </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>RHS vector; positions <code>j_start+1 : j_start+band</code> updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j_start</td><td>Starting row index minus one (loop begins at <code>j_start+1</code>)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 4, 4.1.2 (pp. 55-58), Eq. 4.15 </dd>
<dd>
<a class="el" href="#a82db002de9c1abeba86fae180dbec079" title="Rotate an observation row into a band matrix with vector RHS.">fp_rotate_row_vec</a>  vector-RHS variant for parametric fitting </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ab4ec4c90b00749bb021a6ec2f3433781_cgraph.png" border="0" usemap="#anamespacefitpack__core_ab4ec4c90b00749bb021a6ec2f3433781_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ab4ec4c90b00749bb021a6ec2f3433781_cgraph" id="anamespacefitpack__core_ab4ec4c90b00749bb021a6ec2f3433781_cgraph">
<area shape="rect" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="5,79,204,104"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="254,29,399,55"/>
<area shape="poly" title=" " alt="" coords="162,76,255,55,256,60,163,81"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="252,79,401,104"/>
<area shape="poly" title=" " alt="" coords="204,89,238,89,238,94,204,94"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="253,128,401,153"/>
<area shape="poly" title=" " alt="" coords="163,101,256,122,255,128,162,107"/>
<area shape="poly" title=" " alt="" coords="291,31,283,21,287,11,302,5,327,3,357,6,370,15,366,20,355,11,327,8,303,10,290,15,288,20,295,28"/>
</map>
</div>

</div>
</div>
<a id="ab3c656c52c7e12d25083b56910547f2c" name="ab3c656c52c7e12d25083b56910547f2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3c656c52c7e12d25083b56910547f2c">&#9670;&#160;</a></span>fp_rotate_row_2mat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_rotate_row_2mat </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>yi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j1_start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j1_end</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate a split observation row into the block-triangular periodic system with scalar RHS. </p>
<p>Scalar-RHS variant of fp_rotate_row_2mat_vec. Identical two-phase algorithm for the periodic block-triangular system (Eq. 6.13) but with a scalar right-hand side \( y_i / z(j) \) instead of the vector \( \xi(d) / z(j, 1{:}d) \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h1</td><td>First block of the observation row, length <code>band1</code>. Shifted left during Phase 1. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band1</td><td>Length of <code>h1</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h2</td><td>Second block (wraparound columns), length <code>band2</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band2</td><td>Length of <code>h2</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a1</td><td>Band matrix \( R_{11}^* \), dimension <code>(nest,*)</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a2</td><td>Band matrix \( R_{12}^* / R_{22}^* \), dimension <code>(nest,*)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Leading dimension of <code>a1</code> and <code>a2</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">yi</td><td>Scalar RHS contribution; updated by rotations </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>RHS vector; entries at rows <code>j1_start : j1_end+band2</code> updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j1_start</td><td>First row index for Phase 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j1_end</td><td>Last row index for Phase 1</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.1.1 (pp. 95-100), Eq. 6.10, 6.13 </dd>
<dd>
<a class="el" href="#a8b4564b1b6353e60d0808091e9efa2e0" title="Rotate a split observation row into the block-triangular periodic system with vector RHS.">fp_rotate_row_2mat_vec</a>  vector-RHS variant </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ab3c656c52c7e12d25083b56910547f2c_cgraph.png" border="0" usemap="#anamespacefitpack__core_ab3c656c52c7e12d25083b56910547f2c_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ab3c656c52c7e12d25083b56910547f2c_cgraph" id="anamespacefitpack__core_ab3c656c52c7e12d25083b56910547f2c_cgraph">
<area shape="rect" title="Rotate a split observation row into the block&#45;triangular periodic system with scalar RHS." alt="" coords="5,71,173,111"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="223,29,369,55"/>
<area shape="poly" title=" " alt="" coords="173,69,228,55,230,60,174,74"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="221,79,371,104"/>
<area shape="poly" title=" " alt="" coords="174,89,207,89,207,94,174,94"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="222,128,370,153"/>
<area shape="poly" title=" " alt="" coords="174,109,230,122,228,127,173,114"/>
<area shape="poly" title=" " alt="" coords="262,31,255,21,259,11,273,5,296,3,325,6,336,15,333,20,322,11,296,8,274,10,263,15,260,20,266,28"/>
</map>
</div>

</div>
</div>
<a id="a8b4564b1b6353e60d0808091e9efa2e0" name="a8b4564b1b6353e60d0808091e9efa2e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b4564b1b6353e60d0808091e9efa2e0">&#9670;&#160;</a></span>fp_rotate_row_2mat_vec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_rotate_row_2mat_vec </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(idim), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>xi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n,idim), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j1_start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j1_end</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate a split observation row into the block-triangular periodic system with vector RHS. </p>
<p>Two-matrix Givens rotation for periodic spline fitting. The periodic B-spline constraint wraps the last \( k \) columns of the observation matrix into the first \( k \), producing a block-triangular structure:</p>
<p class="formulaDsp">
\[              \begin{pmatrix} R_{11}^* &amp; R_{12}^* \\ 0 &amp; R_{22}^* \end{pmatrix}
              \tag{6.13}
\]
</p>
<p>Each observation row is split as \( [h_1 \mid h_2] \) and rotated in two phases:</p>
<ul>
<li><b>Phase 1</b>: Rotate \( h_1 \) through \( R_{11}^* \) using shifted pivots (always \( h_1(1) \)), simultaneously applying cross-rotations to \( h_2 \) and \( R_{12}^* \).</li>
<li><b>Phase 2</b>: Rotate remaining \( h_2 \) through \( R_{22}^* \) using standard walk (diagonal at \( R_{22}^*(j,j) \)).</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h1</td><td>First block of the observation row, length <code>band1</code>. Shifted left during Phase 1. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band1</td><td>Length of <code>h1</code> (main bandwidth) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h2</td><td>Second block (wraparound columns), length <code>band2</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band2</td><td>Length of <code>h2</code> (typically \( k \)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a1</td><td>Band matrix \( R_{11}^* \), dimension <code>(nest,*)</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a2</td><td>Band matrix \( R_{12}^* / R_{22}^* \), dimension <code>(nest,*)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Leading dimension of <code>a1</code> and <code>a2</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">xi</td><td>Vector RHS contribution of length <code>idim</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>RHS array <code>(n, idim)</code>, one column per coordinate dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j1_start</td><td>First row index for Phase 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j1_end</td><td>Last row index for Phase 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Leading dimension of <code>z</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of coordinate dimensions</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.1.1 (pp. 95-100), Eq. 6.10, 6.13, Fig. 6.1 </dd>
<dd>
<a class="el" href="#ab3c656c52c7e12d25083b56910547f2c" title="Rotate a split observation row into the block-triangular periodic system with scalar RHS.">fp_rotate_row_2mat</a>  scalar-RHS variant </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a8b4564b1b6353e60d0808091e9efa2e0_cgraph.png" border="0" usemap="#anamespacefitpack__core_a8b4564b1b6353e60d0808091e9efa2e0_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a8b4564b1b6353e60d0808091e9efa2e0_cgraph" id="anamespacefitpack__core_a8b4564b1b6353e60d0808091e9efa2e0_cgraph">
<area shape="rect" title="Rotate a split observation row into the block&#45;triangular periodic system with vector RHS." alt="" coords="5,71,173,111"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="223,29,369,55"/>
<area shape="poly" title=" " alt="" coords="173,69,228,55,230,60,174,74"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="221,79,371,104"/>
<area shape="poly" title=" " alt="" coords="174,89,207,89,207,94,174,94"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="222,128,370,153"/>
<area shape="poly" title=" " alt="" coords="174,109,230,122,228,127,173,114"/>
<area shape="poly" title=" " alt="" coords="262,31,255,21,259,11,273,5,296,3,325,6,336,15,333,20,322,11,296,8,274,10,263,15,260,20,266,28"/>
</map>
</div>

</div>
</div>
<a id="aed0bf32d459d0a6b5f61a5f43b4a038d" name="aed0bf32d459d0a6b5f61a5f43b4a038d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed0bf32d459d0a6b5f61a5f43b4a038d">&#9670;&#160;</a></span>fp_rotate_row_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_rotate_row_block </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(na,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>na</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nrhs), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nrhs,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nrhs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>irot_start</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate a row into a band matrix with contiguous-block RHS. </p>
<p>Standard-walk Givens rotation for grid-based surface fitting. Rotates row \( h \) into the upper triangular band matrix \( A \), applying the same rotations to a block right-hand side: the vector <code>right(1:nrhs)</code> and the column <code>q(1:nrhs, irot)</code> of a 2D RHS matrix.</p>
<p>This arises from the Kronecker product decomposition of the bivariate system (Eq. 10.4-10.8), where the one-dimensional triangularizations \( A_x \) and \( A_{uu} \) operate on contiguous blocks of the tensor-product RHS.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h</td><td>Row to rotate, length <code>band</code>. Modified in place. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>Bandwidth </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Upper triangular band matrix, dimension <code>(na,*)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">na</td><td>Leading dimension of <code>a</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">right</td><td>Block RHS vector of length <code>nrhs</code>; updated by rotations </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>2D RHS matrix <code>(nrhs,*)</code>; column <code>irot</code> updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrhs</td><td>Number of RHS entries per rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">irot_start</td><td>Starting row index minus one</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 10, 10.2 (pp. 170-172), Eq. 10.4-10.8 </dd>
<dd>
<a class="el" href="#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row-access) RHS.">fp_rotate_row_stride</a>  stride (row-access) RHS variant </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_aed0bf32d459d0a6b5f61a5f43b4a038d_cgraph.png" border="0" usemap="#anamespacefitpack__core_aed0bf32d459d0a6b5f61a5f43b4a038d_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_aed0bf32d459d0a6b5f61a5f43b4a038d_cgraph" id="anamespacefitpack__core_aed0bf32d459d0a6b5f61a5f43b4a038d_cgraph">
<area shape="rect" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="5,71,173,111"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="223,29,369,55"/>
<area shape="poly" title=" " alt="" coords="173,69,228,55,230,60,174,74"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="221,79,371,104"/>
<area shape="poly" title=" " alt="" coords="174,89,207,89,207,94,174,94"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="222,128,370,153"/>
<area shape="poly" title=" " alt="" coords="174,109,230,122,228,127,173,114"/>
<area shape="poly" title=" " alt="" coords="262,31,255,21,259,11,273,5,296,3,325,6,336,15,333,20,322,11,296,8,274,10,263,15,260,20,266,28"/>
</map>
</div>

</div>
</div>
<a id="aa701068a010acc01614dbdb3d2d0af77" name="aa701068a010acc01614dbdb3d2d0af77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa701068a010acc01614dbdb3d2d0af77">&#9670;&#160;</a></span>fp_rotate_row_stride()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_rotate_row_stride </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(na,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>na</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nrhs), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ldc,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ldc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nrhs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>irot_start</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate a row into a band matrix with stride (row-access) RHS. </p>
<p>Standard-walk Givens rotation for grid-based surface fitting. Rotates row \( h \) into the upper triangular band matrix \( A \), applying the same rotations to the vector <code>right(1:nrhs)</code> and the <b>row</b> <code>c(irot, 1:nrhs)</code> of a 2D RHS matrix <code>c(ldc,*)</code>.</p>
<p>Unlike fp_rotate_row_block (which accesses RHS by columns), this routine accesses RHS by rows  the stride pattern needed for the \( A_y \) and \( A_{vv} \) triangularizations and the tensor-product back-substitution (Eq. 10.8) in the Kronecker product decomposition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h</td><td>Row to rotate, length <code>band</code>. Modified in place. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>Bandwidth </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Upper triangular band matrix, dimension <code>(na,*)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">na</td><td>Leading dimension of <code>a</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">right</td><td>Block RHS vector of length <code>nrhs</code>; updated by rotations </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>2D RHS matrix <code>(ldc,*)</code>; row <code>irot</code> updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ldc</td><td>Leading dimension of <code>c</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrhs</td><td>Number of RHS entries per rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">irot_start</td><td>Starting row index minus one</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 10, 10.2 (pp. 170-172), Eq. 10.4-10.8 </dd>
<dd>
<a class="el" href="#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous-block RHS.">fp_rotate_row_block</a>  contiguous-block (column-access) RHS variant </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_aa701068a010acc01614dbdb3d2d0af77_cgraph.png" border="0" usemap="#anamespacefitpack__core_aa701068a010acc01614dbdb3d2d0af77_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_aa701068a010acc01614dbdb3d2d0af77_cgraph" id="anamespacefitpack__core_aa701068a010acc01614dbdb3d2d0af77_cgraph">
<area shape="rect" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="5,71,173,111"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="223,29,369,55"/>
<area shape="poly" title=" " alt="" coords="173,69,228,55,230,60,174,74"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="221,79,371,104"/>
<area shape="poly" title=" " alt="" coords="174,89,207,89,207,94,174,94"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="222,128,370,153"/>
<area shape="poly" title=" " alt="" coords="174,109,230,122,228,127,173,114"/>
<area shape="poly" title=" " alt="" coords="262,31,255,21,259,11,273,5,296,3,325,6,336,15,333,20,322,11,296,8,274,10,263,15,260,20,266,28"/>
</map>
</div>

</div>
</div>
<a id="a82db002de9c1abeba86fae180dbec079" name="a82db002de9c1abeba86fae180dbec079"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82db002de9c1abeba86fae180dbec079">&#9670;&#160;</a></span>fp_rotate_row_vec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_rotate_row_vec </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(idim), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>xi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n,idim), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j_start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate an observation row into a band matrix with vector RHS. </p>
<p>Vector-RHS variant of fp_rotate_row for parametric curve fitting. Rotates a new observation row \( h \) into the upper triangular band matrix \( R \) using Givens rotations (Eq. 4.15), simultaneously transforming \( d \) right-hand side vectors stored column-wise in \( z(n, d) \).</p>
<p>In parametric fitting, all \( d \) coordinate curves share the same knot vector and B-spline basis, so a single triangularization of \( R \) applies the same rotations to each RHS column.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h</td><td>Row to rotate, length <code>band</code>. Modified in place. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>Bandwidth (typically \( k+1 \)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Upper triangular band matrix \( R \), dimension <code>(nest,*)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Leading dimension of <code>a</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">xi</td><td>Vector RHS contribution of length <code>idim</code>; updated by rotations </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>RHS array <code>(n, idim)</code>, one column per coordinate dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j_start</td><td>Starting row index minus one </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Leading dimension of <code>z</code> (number of coefficients) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of coordinate dimensions</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 4, 4.1.2 (pp. 55-58), Eq. 4.15 </dd>
<dd>
<a class="el" href="#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix.">fp_rotate_row</a>  scalar-RHS variant </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a82db002de9c1abeba86fae180dbec079_cgraph.png" border="0" usemap="#anamespacefitpack__core_a82db002de9c1abeba86fae180dbec079_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a82db002de9c1abeba86fae180dbec079_cgraph" id="anamespacefitpack__core_a82db002de9c1abeba86fae180dbec079_cgraph">
<area shape="rect" title="Rotate an observation row into a band matrix with vector RHS." alt="" coords="5,71,173,111"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="223,29,369,55"/>
<area shape="poly" title=" " alt="" coords="173,69,228,55,230,60,174,74"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="221,79,371,104"/>
<area shape="poly" title=" " alt="" coords="174,89,207,89,207,94,174,94"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="222,128,370,153"/>
<area shape="poly" title=" " alt="" coords="174,109,230,122,228,127,173,114"/>
<area shape="poly" title=" " alt="" coords="262,31,255,21,259,11,273,5,296,3,325,6,336,15,333,20,322,11,296,8,274,10,263,15,260,20,266,28"/>
</map>
</div>

</div>
</div>
<a id="aa452051613d61831a99b2f9ef8e21bc8" name="aa452051613d61831a99b2f9ef8e21bc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa452051613d61831a99b2f9ef8e21bc8">&#9670;&#160;</a></span>fp_rotate_shifted()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_rotate_shifted </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>yi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j_start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j_end</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate a smoothing-matrix row into a band matrix using shifted pivots. </p>
<p>Shifted-pivot variant of the Givens rotation for incorporating rows of the smoothing matrix \( P \) into the triangularized observation matrix. Unlike fp_rotate_row (which walks \( h(i) \) for \( i = 1, \ldots, b \)), this routine always pivots on \( h(1) \) and shifts \( h \) left after each rotation step:</p>
<p class="formulaDsp">
\[              h \leftarrow (h_2, h_3, \ldots, h_b, 0)
\]
</p>
<p>The effective bandwidth shrinks as \( j \to \texttt{j\_end} \). This pattern arises because the smoothing matrix \( P \) (Eq. 5.5) has bandwidth \( k+2 \) and its rows are offset relative to \( R \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h</td><td>Row to rotate, length <code>band</code>. Shifted left at each step. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>Bandwidth (typically \( k+2 \)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Upper triangular band matrix \( R^* \), dimension <code>(nest,*)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Leading dimension of <code>a</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">yi</td><td>Scalar RHS contribution; updated by rotations </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>RHS vector; positions <code>j_start : j_end</code> updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j_start</td><td>First row index in \( R^* \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j_end</td><td>Last row index in \( R^* \)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 5, 5.2.2 (pp. 76-79), Eq. 5.5, 5.14-5.16 </dd>
<dd>
<a class="el" href="#a73c05ec35eef6da81086156d5cf0597d" title="Rotate a smoothing-matrix row into a band matrix with vector RHS.">fp_rotate_shifted_vec</a>  vector-RHS variant for parametric fitting </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_aa452051613d61831a99b2f9ef8e21bc8_cgraph.png" border="0" usemap="#anamespacefitpack__core_aa452051613d61831a99b2f9ef8e21bc8_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_aa452051613d61831a99b2f9ef8e21bc8_cgraph" id="anamespacefitpack__core_aa452051613d61831a99b2f9ef8e21bc8_cgraph">
<area shape="rect" title="Rotate a smoothing&#45;matrix row into a band matrix using shifted pivots." alt="" coords="5,71,173,111"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="223,29,369,55"/>
<area shape="poly" title=" " alt="" coords="173,69,228,55,230,60,174,74"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="221,79,371,104"/>
<area shape="poly" title=" " alt="" coords="174,89,207,89,207,94,174,94"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="222,128,370,153"/>
<area shape="poly" title=" " alt="" coords="174,109,230,122,228,127,173,114"/>
<area shape="poly" title=" " alt="" coords="262,31,255,21,259,11,273,5,296,3,325,6,336,15,333,20,322,11,296,8,274,10,263,15,260,20,266,28"/>
</map>
</div>

</div>
</div>
<a id="a73c05ec35eef6da81086156d5cf0597d" name="a73c05ec35eef6da81086156d5cf0597d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73c05ec35eef6da81086156d5cf0597d">&#9670;&#160;</a></span>fp_rotate_shifted_vec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_rotate_shifted_vec </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(band), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>band</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,*), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(idim), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>xi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n,idim), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j_start</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>j_end</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate a smoothing-matrix row into a band matrix with vector RHS. </p>
<p>Shifted-pivot, vector-RHS variant of the Givens rotation. Combines the shifted-pivot pattern of fp_rotate_shifted (always pivot on \( h(1) \), shift left) with the multi-dimensional RHS of fp_rotate_row_vec. Used by smoothing iterations in parametric fitting (fpcons, fppara) where the smoothing-matrix rows \( P \) (Eq. 5.5, bandwidth \( k+2 \)) are rotated into the already-triangularized observation matrix \( R \), with \( d \) coordinate curves sharing the same knot vector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h</td><td>Row to rotate, length <code>band</code>. Shifted left at each step. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">band</td><td>Bandwidth (typically \( k+2 \)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Upper triangular band matrix \( R^* \), dimension <code>(nest,*)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Leading dimension of <code>a</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">xi</td><td>Vector RHS contribution of length <code>idim</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>RHS array <code>(n, idim)</code>, one column per coordinate dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j_start</td><td>First row index in \( R^* \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j_end</td><td>Last row index in \( R^* \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Leading dimension of <code>z</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of coordinate dimensions</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 5, 5.2.2 (pp. 76-79), Eq. 5.5, 5.14-5.16 </dd>
<dd>
<a class="el" href="#aa452051613d61831a99b2f9ef8e21bc8" title="Rotate a smoothing-matrix row into a band matrix using shifted pivots.">fp_rotate_shifted</a>  scalar-RHS variant </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a73c05ec35eef6da81086156d5cf0597d_cgraph.png" border="0" usemap="#anamespacefitpack__core_a73c05ec35eef6da81086156d5cf0597d_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a73c05ec35eef6da81086156d5cf0597d_cgraph" id="anamespacefitpack__core_a73c05ec35eef6da81086156d5cf0597d_cgraph">
<area shape="rect" title="Rotate a smoothing&#45;matrix row into a band matrix with vector RHS." alt="" coords="5,23,173,63"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="221,5,371,31"/>
<area shape="poly" title=" " alt="" coords="173,30,207,26,208,31,174,36"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="222,55,370,80"/>
<area shape="poly" title=" " alt="" coords="174,50,209,55,208,60,173,56"/>
</map>
</div>

</div>
</div>
<a id="a52390a01092c6523bfe60ad85f8390af" name="a52390a01092c6523bfe60ad85f8390af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52390a01092c6523bfe60ad85f8390af">&#9670;&#160;</a></span>fp_size_comm_expand_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_size_comm_expand_1d </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(:), intent(out), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a>), dimension(:), intent(in)</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Expand communication buffer into 1D integer(FP_SIZE) allocatable array. </p>

</div>
</div>
<a id="ab9d993cda2dd2b48893144dc12816a02" name="ab9d993cda2dd2b48893144dc12816a02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9d993cda2dd2b48893144dc12816a02">&#9670;&#160;</a></span>fp_size_comm_pack_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fp_size_comm_pack_1d </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ac9aa06356d8fbf8f4b108db917e429a4">fp_comm</a>), dimension(:), intent(out)</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pack 1D integer(FP_SIZE) allocatable array into communication buffer. </p>

</div>
</div>
<a id="a42f7e37a6f95520f7112ed4437414499" name="a42f7e37a6f95520f7112ed4437414499"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42f7e37a6f95520f7112ed4437414499">&#9670;&#160;</a></span>fp_size_comm_size_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>) function fitpack_core::fp_size_comm_size_1d </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(:), intent(in), allocatable</td>          <td class="paramname"><span class="paramname"><em>array</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate storage size for 1D integer(FP_SIZE) allocatable array. </p>

</div>
</div>
<a id="ab6b368d82e72f0bde7c8a9cc60eb76f2" name="ab6b368d82e72f0bde7c8a9cc60eb76f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6b368d82e72f0bde7c8a9cc60eb76f2">&#9670;&#160;</a></span>fpader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpader </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>l</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(k1), intent(out)</td>          <td class="paramname"><span class="paramname"><em>d</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9bcbf8cf99bfb2ac2f3834891c731be7" name="a9bcbf8cf99bfb2ac2f3834891c731be7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bcbf8cf99bfb2ac2f3834891c731be7">&#9670;&#160;</a></span>fpadno()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpadno </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>up</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>left</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>count</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>merk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(n1), intent(in)</td>          <td class="paramname"><span class="paramname"><em>jbind</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a branch to the constraint-set binary tree. </p>
<p>Adds a new branch of length <code>n1</code> to the triply linked binary tree used by the Theil-Van de Panne convexity procedure (7.2). The branch represents a candidate active-constraint set; its nodes contain constraint indices from <code>jbind(1:n1)</code>.</p>
<p>The tree maintains the ordering invariant \( \text{info}(k) &lt; \text{info}(\text{right}(k)) \) and \( \text{info}(k) &lt; \text{info}(\text{left}(k)) \), preventing duplicate constraint sets. If no free nodes are available, fpfrno is called to reclaim nodes; if that also fails, <code>ier = 1</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">maxtr</td><td>Size of the tree arrays </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">up</td><td>Parent pointers; <code>up(i) = 0</code> marks a free node </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">left</td><td>Left-child pointers </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">right</td><td>Right-child pointers </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">info</td><td>Constraint index stored at each node </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">count</td><td>Next free node pointer </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">merk</td><td>Terminal node of the most recent branch </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jbind</td><td>Constraint indices for the new branch, length <code>n1</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n1</td><td>Length of the new branch </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: 0 = success, 1 = tree full</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 7, 7.2.4 (pp. 125-130) </dd>
<dd>
<a class="el" href="#ad5d82ac791ec6ae19e9b4671ffb734e0" title="Prune short branches from the constraint-set binary tree.">fpdeno</a>, <a class="el" href="#a8006d449287383c5f5c4151086e9a376" title="Collect free nodes from the constraint-set binary tree.">fpfrno</a>, <a class="el" href="#a535f9e04981c794c70a60f728e918472" title="Fetch and advance to the next branch in the constraint-set tree.">fpseno</a>  companion tree operations </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a9bcbf8cf99bfb2ac2f3834891c731be7_cgraph.png" border="0" usemap="#anamespacefitpack__core_a9bcbf8cf99bfb2ac2f3834891c731be7_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a9bcbf8cf99bfb2ac2f3834891c731be7_cgraph" id="anamespacefitpack__core_a9bcbf8cf99bfb2ac2f3834891c731be7_cgraph">
<area shape="rect" title="Add a branch to the constraint&#45;set binary tree." alt="" coords="5,5,160,31"/>
<area shape="rect" href="namespacefitpack__core.html#a8006d449287383c5f5c4151086e9a376" title="Collect free nodes from the constraint&#45;set binary tree." alt="" coords="208,5,356,31"/>
<area shape="poly" title=" " alt="" coords="160,15,194,15,194,21,160,21"/>
</map>
</div>

</div>
</div>
<a id="a8b4b656d4556778559ffea0d15d20e55" name="a8b4b656d4556778559ffea0d15d20e55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b4b656d4556778559ffea0d15d20e55">&#9670;&#160;</a></span>fpadpo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpadpo </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(out)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(np), intent(in)</td>          <td class="paramname"><span class="paramname"><em>cp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>np</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(out)</td>          <td class="paramname"><span class="paramname"><em>cc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(out)</td>          <td class="paramname"><span class="paramname"><em>t1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(out)</td>          <td class="paramname"><span class="paramname"><em>t2</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a polynomial curve to a spline curve in B-spline representation. </p>
<p>Given a \( d \)-dimensional spline curve of degree \( k \) with knots \( t \) and coefficients \( c \), and a polynomial curve with B-spline coefficients \( c_p \) (on the knot vector \( [a, \ldots, a, b, \ldots, b] \)), computes the B-spline coefficients of their sum by inserting knots from \( t \) into the polynomial representation via fpinst, then adding coefficients.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of curve dimensions \( d \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot vector of the spline, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients; on exit, contains the sum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of <code>c</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cp</td><td>Polynomial B-spline coefficients, length <code>np</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">np</td><td>Length of <code>cp</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cc</td><td>Work array, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t1</td><td>Work array, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t2</td><td>Work array, length <code>nest</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 7, 7.1 (pp. 115-120) </dd>
<dd>
<a class="el" href="#a3d51410017bf94f298da66b1d80fe524" title="Insert a single knot into a B-spline representation.">fpinst</a>  single knot insertion; <a class="el" href="#a1c1c9269f27beeddee5d8b680aaa7140" title="Construct a polynomial curve satisfying endpoint derivative constraints.">fppocu</a>  polynomial construction </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a8b4b656d4556778559ffea0d15d20e55_cgraph.png" border="0" usemap="#anamespacefitpack__core_a8b4b656d4556778559ffea0d15d20e55_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a8b4b656d4556778559ffea0d15d20e55_cgraph" id="anamespacefitpack__core_a8b4b656d4556778559ffea0d15d20e55_cgraph">
<area shape="rect" title="Add a polynomial curve to a spline curve in B&#45;spline representation." alt="" coords="5,5,160,31"/>
<area shape="rect" href="namespacefitpack__core.html#a3d51410017bf94f298da66b1d80fe524" title="Insert a single knot into a B&#45;spline representation." alt="" coords="208,5,355,31"/>
<area shape="poly" title=" " alt="" coords="160,15,194,15,194,21,160,21"/>
</map>
</div>

</div>
</div>
<a id="ae590b9ba81851ee9d9c76e1fe127c0d1" name="ae590b9ba81851ee9d9c76e1fe127c0d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae590b9ba81851ee9d9c76e1fe127c0d1">&#9670;&#160;</a></span>fpback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, dimension(n) fitpack_core::fpback </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve an upper triangular banded system by back-substitution. </p>
<p>Computes the B-spline coefficients \( c \) by solving the triangular system:</p>
<p class="formulaDsp">
\[              R_1 \, c = z_1
              \tag{4.14}
\]
</p>
<p>where \( R_1 \) is an \( n \times n \) upper triangular matrix with bandwidth \( k \), obtained from the QR factorization of the observation matrix \( E \).</p>
<h3><a class="anchor" id="autotoc_md0"></a>
Matrix structure</h3>
<p>\( R_1 \) is stored as <code>a(nest, k)</code> where <code>a(i,1)</code> holds the diagonal element \( r_{i,i} \) and <code>a(i,j)</code> for \( j &gt; 1 \) holds \( r_{i,i+j-1} \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Upper triangular band matrix \( R_1 \), stored as <code>a(nest, k)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Right-hand side vector \( z_1 \) of length \( n \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of equations (= number of B-spline coefficients) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Bandwidth of \( R_1 \) (= spline order \( k+1 \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Leading dimension of array <code>a</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Solution vector \( c \) of length \( n \)</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 4, 4.1.2 (pp. 55-58), Eq. 4.14 </dd></dl>

</div>
</div>
<a id="ae7f22eea056465653c17c25aaf23b06f" name="ae7f22eea056465653c17c25aaf23b06f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7f22eea056465653c17c25aaf23b06f">&#9670;&#160;</a></span>fpbacp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, dimension(n) fitpack_core::fpbacp </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k1), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve a bordered upper triangular system by back-substitution. </p>
<p>Computes the solution \( c \) of the system \( G \, c = z \) where \( G \) is an \( n \times n \) upper triangular matrix of the form:</p>
<p class="formulaDsp">
\[              G = \begin{pmatrix} A &amp; \cdot \\ 0 &amp; B \end{pmatrix}
              \tag{6.6}
\]
</p>
<p>with \( A \) an \( (n-k) \times (n-k) \) upper triangular band matrix of bandwidth \( k_1 \), and \( B \) an \( n \times k \) dense matrix accounting for the periodic boundary conditions.</p>
<p>This arises in periodic spline fitting where the periodic B-splines \( \tilde{N}_{i,k+1} \) wrap around the domain, coupling the first and last \( k \) coefficients.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Upper triangular band matrix \( A \), stored as <code>a(nest, k1)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Dense coupling matrix \( B \), stored as <code>b(nest, k)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Right-hand side vector of length \( n \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of equations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Number of periodic coupling columns </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k1</td><td>Bandwidth of the triangular part \( A \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Leading dimension of arrays <code>a</code> and <code>b</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Solution vector \( c \) of length \( n \)</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.1 (pp. 95-100), Eq. 6.6 </dd></dl>

</div>
</div>
<a id="acc0e64bf7c182c225873ce2bfac77ab1" name="acc0e64bf7c182c225873ce2bfac77ab1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc0e64bf7c182c225873ce2bfac77ab1">&#9670;&#160;</a></span>fpbfou()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpbfou </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>par</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(out)</td>          <td class="paramname"><span class="paramname"><em>resc</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute Fourier coefficients of cubic B-splines. </p>
<p>Calculates the Fourier sine and cosine integrals of each cubic B-spline \( N_{j,4}(x) \) over the active knot interval:</p>
<p class="formulaDsp">
\[              \text{ress}(j) = \int_{\lambda_4}^{\lambda_{n-3}} N_{j,4}(x) \sin(\omega x) \, dx
\]
</p>
   <p class="formulaDsp">
\[              \text{resc}(j) = \int_{\lambda_4}^{\lambda_{n-3}} N_{j,4}(x) \cos(\omega x) \, dx
\]
</p>
<p>for \( j = 1, \ldots, n-4 \). Uses fpcsin to evaluate the weighted integrals over each knot span.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot vector, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">par</td><td>Frequency \( \omega \) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ress</td><td>Sine integrals, length <code>n-4</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">resc</td><td>Cosine integrals, length <code>n-4</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 3, 3.3 (Fourier coefficients) </dd>
<dd>
<a class="el" href="#a8c6900d3b80033043b2b73b49ce84fc2" title="Compute weighted Fourier integrals of a cubic polynomial.">fpcsin</a>  weighted Fourier integrals of cubics </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_acc0e64bf7c182c225873ce2bfac77ab1_cgraph.png" border="0" usemap="#anamespacefitpack__core_acc0e64bf7c182c225873ce2bfac77ab1_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_acc0e64bf7c182c225873ce2bfac77ab1_cgraph" id="anamespacefitpack__core_acc0e64bf7c182c225873ce2bfac77ab1_cgraph">
<area shape="rect" title="Compute Fourier coefficients of cubic B&#45;splines." alt="" coords="5,43,156,68"/>
<area shape="rect" href="namespacefitpack__core.html#a8c6900d3b80033043b2b73b49ce84fc2" title="Compute weighted Fourier integrals of a cubic polynomial." alt="" coords="217,5,365,31"/>
<area shape="poly" title=" " alt="" coords="152,40,205,30,206,36,153,45"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="204,79,377,104"/>
<area shape="poly" title=" " alt="" coords="156,65,203,74,203,79,155,71"/>
<area shape="poly" title=" " alt="" coords="257,80,250,70,253,60,267,54,291,52,319,56,331,65,327,69,317,61,291,57,269,59,257,64,255,70,261,77"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="425,79,571,104"/>
<area shape="poly" title=" " alt="" coords="378,89,412,89,412,94,378,94"/>
<area shape="poly" title=" " alt="" coords="464,80,457,70,461,60,475,54,498,52,527,56,538,65,535,69,524,61,498,57,476,59,465,64,462,70,468,77"/>
</map>
</div>

</div>
</div>
<a id="a72432bc4ebc7c5ff0425d188147d7dbb" name="a72432bc4ebc7c5ff0425d188147d7dbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72432bc4ebc7c5ff0425d188147d7dbb">&#9670;&#160;</a></span>fpbisp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpbisp </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nx-kx-1)*(ny-ky-1)), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(my), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>my</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx*my), intent(out)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx,kx+1), intent(out)</td>          <td class="paramname"><span class="paramname"><em>wx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(my,ky+1), intent(out)</td>          <td class="paramname"><span class="paramname"><em>wy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mx), intent(out)</td>          <td class="paramname"><span class="paramname"><em>lx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(my), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ly</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate a tensor product spline on a grid. </p>
<p>Computes the values of a bivariate spline \( s(x, y) \) of degrees \( k_x \) and \( k_y \) at the grid points \( (x_i, y_j) \), \( i = 1, \ldots, m_x \), \( j = 1, \ldots, m_y \).</p>
<p>The evaluation uses the two-step algorithm: first compute the B-spline basis values in each direction, then assemble:</p>
<p class="formulaDsp">
\[              s(x, y) = \sum_{i} \left( \sum_{j} c_{i,j} \, M_{j, k_y+1}(y) \right)
                        N_{i, k_x+1}(x)
              \tag{2.14-2.15}
\]
</p>
<p>The B-spline values and knot interval indices are stored in workspace arrays <code>wx</code>, <code>wy</code>, <code>lx</code>, <code>ly</code> for reuse.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>Knot vector in \( x \), length <code>nx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Number of knots in \( x \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ty</td><td>Knot vector in \( y \), length <code>ny</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Number of knots in \( y \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients \( c_{i,j} \), length \( (n_x - k_x - 1)(n_y - k_y - 1) \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Spline degree in \( x \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Spline degree in \( y \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Evaluation points in \( x \), length <code>mx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Number of evaluation points in \( x \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Evaluation points in \( y \), length <code>my</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">my</td><td>Number of evaluation points in \( y \) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">z</td><td>Spline values at grid points, length <code>mx * my</code>, stored in row-major order: \( z((i-1) m_y + j) = s(x_i, y_j) \) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">wx</td><td>B-spline basis values in \( x \), <code>wx(mx, kx+1)</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">wy</td><td>B-spline basis values in \( y \), <code>wy(my, ky+1)</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lx</td><td>Knot interval indices in \( x \), length <code>mx</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ly</td><td>Knot interval indices in \( y \), length <code>my</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 2, 2.1.2 (pp. 28-30), Eq. 2.14-2.17 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a72432bc4ebc7c5ff0425d188147d7dbb_cgraph.png" border="0" usemap="#anamespacefitpack__core_a72432bc4ebc7c5ff0425d188147d7dbb_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a72432bc4ebc7c5ff0425d188147d7dbb_cgraph" id="anamespacefitpack__core_a72432bc4ebc7c5ff0425d188147d7dbb_cgraph">
<area shape="rect" title="Evaluate a tensor product spline on a grid." alt="" coords="5,42,155,67"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="203,5,361,45"/>
<area shape="poly" title=" " alt="" coords="155,41,189,36,190,41,155,46"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="207,70,357,95"/>
<area shape="poly" title=" " alt="" coords="155,62,194,68,194,73,155,68"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="409,70,583,95"/>
<area shape="poly" title=" " alt="" coords="357,80,396,80,396,85,357,85"/>
<area shape="poly" title=" " alt="" coords="462,72,455,62,459,52,473,46,496,43,525,47,536,56,533,60,522,52,496,49,474,51,463,55,460,61,466,68"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="631,70,776,95"/>
<area shape="poly" title=" " alt="" coords="583,80,617,80,617,85,583,85"/>
<area shape="poly" title=" " alt="" coords="670,72,662,62,666,52,680,46,703,43,732,47,743,56,740,60,730,52,703,49,681,51,670,55,668,61,674,68"/>
</map>
</div>

</div>
</div>
<a id="ac5fb8acceffae7a31a838c1d7ff97d31" name="ac5fb8acceffae7a31a838c1d7ff97d31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5fb8acceffae7a31a838c1d7ff97d31">&#9670;&#160;</a></span>fpbspl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, dimension(<a class="el" href="#a6c5b21fc23625ebfc7f555075c13eb07">max_order</a>+1) fitpack_core::fpbspl </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>l</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate the non-zero B-splines at a given point. </p>
<p>Computes the \( k+1 \) non-zero B-splines of degree \( k \) at the point \( x \) satisfying \( \lambda_l \leq x &lt; \lambda_{l+1} \), using the stable recurrence relation of de Boor and Cox:</p>
<p class="formulaDsp">
\[              N_{i,1}(x) = \begin{cases} 1 &amp; \text{if } \lambda_i \leq x &lt; \lambda_{i+1} \\
                                          0 &amp; \text{otherwise} \end{cases}
\]
</p>
     <p class="formulaDsp">
\[              N_{i,l+1}(x) = \frac{x - \lambda_i}{\lambda_{i+l} - \lambda_i} N_{i,l}(x)
                            + \frac{\lambda_{i+l+1} - x}{\lambda_{i+l+1} - \lambda_{i+1}} N_{i+1,l}(x)
              \tag{1.24}
\]
</p>
<p>The result array <code>h</code> contains \( N_{l-k,k+1}(x), \ldots, N_{l,k+1}(x) \) in positions <code>h(1:k+1)</code>. When knots have multiplicity (coincident knots), zero weights are used in the recurrence (convention \( 0/0 = 0 \)).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot vector \( \lambda_1, \ldots, \lambda_n \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Length of the knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Evaluation point, must satisfy \( \lambda_l \leq x &lt; \lambda_{l+1} \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">l</td><td>Knot interval index, must satisfy \( k \leq l \leq n-k \)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Array of length <code>MAX_ORDER+1</code>; positions <code>1:k+1</code> contain the \( k+1 \) non-zero B-spline values.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Requires \( k \leq l \leq n-k \); this is not checked.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, 1.3 (pp. 8-11), Eq. 1.22-1.24, 1.30 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ac5fb8acceffae7a31a838c1d7ff97d31_cgraph.png" border="0" usemap="#anamespacefitpack__core_ac5fb8acceffae7a31a838c1d7ff97d31_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ac5fb8acceffae7a31a838c1d7ff97d31_cgraph" id="anamespacefitpack__core_ac5fb8acceffae7a31a838c1d7ff97d31_cgraph">
<area shape="rect" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="5,29,155,55"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="203,29,376,55"/>
<area shape="poly" title=" " alt="" coords="155,39,189,39,189,45,155,45"/>
<area shape="poly" title=" " alt="" coords="256,31,248,21,252,11,266,5,289,3,318,6,329,15,326,20,316,11,289,8,267,10,256,15,254,20,260,28"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="424,29,569,55"/>
<area shape="poly" title=" " alt="" coords="376,39,410,39,410,45,376,45"/>
<area shape="poly" title=" " alt="" coords="463,31,456,21,459,11,473,5,497,3,525,6,537,15,533,20,523,11,497,8,475,10,463,15,461,20,467,28"/>
</map>
</div>

</div>
</div>
<a id="a3e1011bf7749aa62d3c05bd1a20e36d1" name="a3e1011bf7749aa62d3c05bd1a20e36d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e1011bf7749aa62d3c05bd1a20e36d1">&#9670;&#160;</a></span>fpchec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>) function fitpack_core::fpchec </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Verify knot positions against data points (Schoenberg-Whitney check). </p>
<p>Checks that the knots \( \lambda_j \), \( j = 1, \ldots, n \), of a spline of degree \( k \) satisfy all conditions required for a well-posed least-squares problem with data points \( x_i \), \( i = 1, \ldots, m \).</p>
<p>The conditions verified are:</p>
<ol type="1">
<li>\( k+1 \leq n-k-1 \leq m \)</li>
<li>\( \lambda_1 \leq \cdots \leq \lambda_{k+1} \) and \( \lambda_{n-k} \leq \cdots \leq \lambda_n \) (boundary knot monotonicity)</li>
<li>\( \lambda_{k+2} &lt; \lambda_{k+3} &lt; \cdots &lt; \lambda_{n-k} \) (interior knots strictly increasing)</li>
<li>\( \lambda_{k+1} \leq x_1 \) and \( x_m \leq \lambda_{n-k} \)</li>
<li>The Schoenberg-Whitney conditions: there exists a subset of data points \( y_j \) such that    <p class="formulaDsp">
\[                 \lambda_j &lt; y_j &lt; \lambda_{j+k+1}, \quad j = 1, \ldots, n-k-1
                 \tag{4.5}
\]
</p>
 guaranteeing full rank of the observation matrix.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data abscissae, strictly increasing: \( x_1 &lt; \cdots &lt; x_m \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot vector \( \lambda_1, \ldots, \lambda_n \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>FITPACK_OK</code> if all conditions hold, <code>FITPACK_INPUT_ERROR</code> otherwise.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 4, 4.1.1 (pp. 53-55), Eq. 4.5, 4.17 </dd></dl>

</div>
</div>
<a id="a7fa29b4729274b28092dd2e3a338f21c" name="a7fa29b4729274b28092dd2e3a338f21c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fa29b4729274b28092dd2e3a338f21c">&#9670;&#160;</a></span>fpched()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure integer function fitpack_core::fpched </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ib</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ie</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="accaa1729715efbe04726699613597c32" name="accaa1729715efbe04726699613597c32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accaa1729715efbe04726699613597c32">&#9670;&#160;</a></span>fpchep()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>) function fitpack_core::fpchep </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a899b48e5e372c91998b53c9f1959d177" name="a899b48e5e372c91998b53c9f1959d177"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a899b48e5e372c91998b53c9f1959d177">&#9670;&#160;</a></span>fpclos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpclos </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>g1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>g2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdata</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core algorithm for closed (periodic) parametric curve fitting. </p>
<p>Fits a \( d \)-dimensional closed parametric spline curve where \( s(u_1) = s(u_m) \) and all derivatives match at the closure point. The periodicity constraint wraps the last \( k \) B-spline columns into the first \( k \), creating the block-triangular structure (Eq. 6.13):</p>
<p class="formulaDsp">
\[              \begin{pmatrix} R_{11}^* &amp; R_{12}^* \\ 0 &amp; R_{22}^* \end{pmatrix}
              \tag{6.13}
\]
</p>
<p>which is factored using two-matrix Givens rotations (fp_rotate_row_2mat_vec). The smoothing-parameter search follows the same rational interpolation scheme as fpcurf.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>0 = new fit, 1 = continue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of curve dimensions \( d \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Parameter values, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Length of <code>x</code> ( \( = m \cdot d \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data coordinates, interleaved, length <code>mx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Data weights, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Max knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Tolerance for smoothing condition </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k1</td><td>\( k + 1 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k2</td><td>\( k + 2 \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot vector, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of coefficient array <code>c</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nc</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpint</td><td>Residual sums per knot interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>Work: transformed RHS </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a1</td><td>Work: band matrix \( R_{11}^* \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a2</td><td>Work: band matrix \( R_{12}^*/R_{22}^* \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b</td><td>Work: smoothing matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g1</td><td>Work: band matrix copy </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g2</td><td>Work: band matrix copy </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: B-spline values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdata</td><td>Interior data-point counts </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.1-6.2 (pp. 95-112), Eq. 6.1-6.13 </dd>
<dd>
<a class="el" href="#a8b4564b1b6353e60d0808091e9efa2e0" title="Rotate a split observation row into the block-triangular periodic system with vector RHS.">fp_rotate_row_2mat_vec</a>  two-matrix Givens rotation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a899b48e5e372c91998b53c9f1959d177_cgraph.png" border="0" usemap="#anamespacefitpack__core_a899b48e5e372c91998b53c9f1959d177_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a899b48e5e372c91998b53c9f1959d177_cgraph" id="anamespacefitpack__core_a899b48e5e372c91998b53c9f1959d177_cgraph">
<area shape="rect" title="Core algorithm for closed (periodic) parametric curve fitting." alt="" coords="5,293,153,318"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="206,5,365,45"/>
<area shape="poly" title=" " alt="" coords="81,292,93,248,115,185,150,116,173,84,199,55,205,51,208,55,203,59,177,87,155,119,120,187,98,249,86,293"/>
<area shape="rect" href="namespacefitpack__core.html#a8b4564b1b6353e60d0808091e9efa2e0" title="Rotate a split observation row into the block&#45;triangular periodic system with vector RHS." alt="" coords="201,285,369,325"/>
<area shape="poly" title=" " alt="" coords="154,303,188,303,188,308,154,308"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="429,182,579,207"/>
<area shape="poly" title=" " alt="" coords="84,291,100,261,125,223,158,185,178,169,200,156,234,144,270,138,306,138,342,141,409,155,463,174,461,179,408,161,341,146,306,143,270,144,235,149,202,161,181,174,162,189,129,226,104,264,89,294"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="430,235,578,261"/>
<area shape="poly" title=" " alt="" coords="121,290,201,271,313,256,416,249,417,254,313,261,202,276,122,295"/>
<area shape="rect" href="namespacefitpack__core.html#a82db002de9c1abeba86fae180dbec079" title="Rotate an observation row into a band matrix with vector RHS." alt="" coords="201,171,369,211"/>
<area shape="poly" title=" " alt="" coords="98,290,200,227,225,214,227,219,203,232,101,295"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="209,350,362,375"/>
<area shape="poly" title=" " alt="" coords="127,315,227,344,225,349,125,321"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="211,70,360,95"/>
<area shape="poly" title=" " alt="" coords="83,291,98,256,123,209,157,158,200,113,222,99,225,103,203,117,161,161,127,211,103,258,88,293"/>
<area shape="rect" href="namespacefitpack__core.html#ae099a69d7fc431841d2de41c38e4fcab" title=" " alt="" coords="211,400,359,440"/>
<area shape="poly" title=" " alt="" coords="98,316,144,350,203,386,215,392,213,397,200,390,141,354,95,320"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="211,465,359,490"/>
<area shape="poly" title=" " alt="" coords="90,317,132,380,165,418,203,450,216,457,213,462,200,454,161,421,128,384,85,320"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="210,514,361,539"/>
<area shape="poly" title=" " alt="" coords="87,317,101,354,125,403,159,456,180,480,203,501,210,506,207,510,200,505,176,483,155,459,120,406,96,356,82,319"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="218,564,353,604"/>
<area shape="poly" title=" " alt="" coords="86,317,98,361,120,423,155,491,177,522,203,550,208,554,205,559,199,554,173,526,150,494,115,425,93,363,81,319"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="639,131,784,157"/>
<area shape="poly" title=" " alt="" coords="370,309,421,308,478,302,535,290,589,270,622,248,651,221,693,167,697,170,655,225,626,252,592,274,537,295,479,308,422,313,370,314"/>
<area shape="poly" title=" " alt="" coords="313,283,360,251,416,220,443,209,445,214,418,225,363,256,316,287"/>
<area shape="poly" title=" " alt="" coords="362,283,441,262,442,267,363,288"/>
<area shape="poly" title=" " alt="" coords="678,133,670,123,674,113,688,107,711,105,740,108,751,117,748,122,738,113,711,110,689,112,678,117,676,122,682,130"/>
<area shape="poly" title=" " alt="" coords="369,174,417,167,624,147,625,152,418,172,370,179"/>
<area shape="poly" title=" " alt="" coords="370,190,416,190,415,196,370,195"/>
<area shape="poly" title=" " alt="" coords="363,208,442,229,441,234,362,213"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="417,75,591,101"/>
<area shape="poly" title=" " alt="" coords="360,82,403,83,403,88,360,87"/>
<area shape="poly" title=" " alt="" coords="552,98,651,125,650,130,551,103"/>
<area shape="poly" title=" " alt="" coords="470,77,463,67,467,57,481,51,504,49,533,52,544,61,541,66,530,57,504,54,482,56,471,61,468,66,474,74"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="432,571,576,597"/>
<area shape="poly" title=" " alt="" coords="353,581,418,581,418,587,353,587"/>
</map>
</div>

</div>
</div>
<a id="ae099a69d7fc431841d2de41c38e4fcab" name="ae099a69d7fc431841d2de41c38e4fcab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae099a69d7fc431841d2de41c38e4fcab">&#9670;&#160;</a></span>fpclos_reset_interp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpclos_reset_interp </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>kk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>kk1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>per</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>fp0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdata</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>done</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a4003dce07901ef7e9b8db9bb2a45b97c" name="a4003dce07901ef7e9b8db9bb2a45b97c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4003dce07901ef7e9b8db9bb2a45b97c">&#9670;&#160;</a></span>fpcoco()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpcoco </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxbin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>sq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>sx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bind</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fit a convexity-constrained cubic smoothing spline. </p>
<p>Determines a cubic spline approximation \( s(x) \) that satisfies the convexity (or concavity) constraints specified by \( v(i) \):</p>
<ul>
<li>\( v(i) = 1 \): \( s&#39;&#39;(x_i) \geq 0 \) (local convexity)</li>
<li>\( v(i) = -1 \): \( s&#39;&#39;(x_i) \leq 0 \) (local concavity)</li>
<li>\( v(i) = 0 \): no constraint at \( x_i \)</li>
</ul>
<p>while minimizing the weighted sum of squared residuals subject to \( \sum (w_i (y_i - s(x_i)))^2 \leq S \). The algorithm uses the Theil-Van de Panne quadratic programming procedure with a binary tree (7.2) to enumerate active-constraint sets.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Option: -1 = least-squares, 0 = new smoothing, 1 = continue from previous </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data abscissae, length <code>m</code> (strictly increasing) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Data ordinates, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Data weights, length <code>m</code> (positive) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Convexity signs, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Max knots (workspace dimension) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxtr</td><td>Max tree nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxbin</td><td>Max active constraints </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot vector, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sq</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sx</td><td>Spline values at data points, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bind</td><td>Active constraint flags, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">e</td><td>Discontinuity coefficients, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Work array, length <code>lwrk</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Length of <code>wrk</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer work array, length <code>kwrk</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kwrk</td><td>Length of <code>iwrk</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Error flags in fpcoco/cocosp do not match the global error messages.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 7, 7.2 (pp. 125-130) </dd>
<dd>
<a class="el" href="#a896928a4fbb29c241426ae61e5f2e69c" title="Core algorithm for convexity-constrained cubic spline fitting.">fpcosp</a>  core convexity-constrained fitting algorithm </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a4003dce07901ef7e9b8db9bb2a45b97c_cgraph.png" border="0" usemap="#anamespacefitpack__core_a4003dce07901ef7e9b8db9bb2a45b97c_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a4003dce07901ef7e9b8db9bb2a45b97c_cgraph" id="anamespacefitpack__core_a4003dce07901ef7e9b8db9bb2a45b97c_cgraph">
<area shape="rect" title="Fit a convexity&#45;constrained cubic smoothing spline." alt="" coords="5,121,157,146"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="835,67,980,93"/>
<area shape="poly" title=" " alt="" coords="94,119,141,81,171,62,204,46,293,20,385,6,478,3,569,8,655,18,733,32,853,61,852,66,732,37,654,23,569,13,478,8,386,12,294,25,206,51,174,66,144,86,98,123"/>
<area shape="rect" href="namespacefitpack__core.html#ab0ebd1c826f330de0103ba72e55260ba" title="Test whether a FITPACK error flag indicates success." alt="" coords="205,84,359,124"/>
<area shape="poly" title=" " alt="" coords="157,120,191,115,192,120,158,125"/>
<area shape="rect" href="namespacefitpack__core.html#a896928a4fbb29c241426ae61e5f2e69c" title="Core algorithm for convexity&#45;constrained cubic spline fitting." alt="" coords="206,149,358,174"/>
<area shape="poly" title=" " alt="" coords="158,141,193,146,192,152,157,147"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="613,161,787,186"/>
<area shape="poly" title=" " alt="" coords="103,144,154,175,227,215,315,254,407,283,452,293,487,298,522,295,564,283,599,266,630,243,678,195,682,199,634,247,602,270,566,288,523,300,487,303,451,298,406,288,313,259,225,220,151,180,101,149"/>
<area shape="poly" title=" " alt="" coords="874,69,866,59,870,49,884,43,907,41,936,45,947,54,944,58,934,49,907,46,885,48,874,53,872,58,878,66"/>
<area shape="poly" title=" " alt="" coords="244,84,242,74,248,65,262,60,282,57,306,60,318,68,316,72,304,65,282,63,263,65,251,69,247,75,249,83"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="407,35,565,75"/>
<area shape="poly" title=" " alt="" coords="331,146,357,134,372,122,381,110,390,98,405,85,414,79,417,84,408,89,394,101,385,113,375,126,360,138,333,151"/>
<area shape="rect" href="namespacefitpack__core.html#a9bcbf8cf99bfb2ac2f3834891c731be7" title="Add a branch to the constraint&#45;set binary tree." alt="" coords="409,99,563,125"/>
<area shape="poly" title=" " alt="" coords="335,146,419,125,420,131,336,151"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="411,149,561,174"/>
<area shape="poly" title=" " alt="" coords="358,159,398,159,398,164,358,164"/>
<area shape="rect" href="namespacefitpack__core.html#ad5d82ac791ec6ae19e9b4671ffb734e0" title="Prune short branches from the constraint&#45;set binary tree." alt="" coords="409,198,563,223"/>
<area shape="poly" title=" " alt="" coords="336,172,420,192,419,197,335,177"/>
<area shape="rect" href="namespacefitpack__core.html#a535f9e04981c794c70a60f728e918472" title="Fetch and advance to the next branch in the constraint&#45;set tree." alt="" coords="409,247,563,273"/>
<area shape="poly" title=" " alt="" coords="303,172,349,202,408,234,425,241,423,245,406,239,347,207,300,177"/>
<area shape="rect" href="namespacefitpack__core.html#a8006d449287383c5f5c4151086e9a376" title="Collect free nodes from the constraint&#45;set binary tree." alt="" coords="626,87,774,113"/>
<area shape="poly" title=" " alt="" coords="563,105,612,102,612,108,564,110"/>
<area shape="poly" title=" " alt="" coords="561,163,600,165,600,171,561,168"/>
<area shape="poly" title=" " alt="" coords="728,158,864,96,866,101,730,163"/>
<area shape="poly" title=" " alt="" coords="666,162,659,152,663,143,677,136,700,134,729,138,740,147,737,151,726,143,700,139,678,141,667,146,664,152,670,159"/>
</map>
</div>

</div>
</div>
<a id="a17a3995cbff15ef64c241c059a40e682" name="a17a3995cbff15ef64c241c059a40e682"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17a3995cbff15ef64c241c059a40e682">&#9670;&#160;</a></span>fpcons()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpcons </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ib</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ie</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>g</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdata</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core algorithm for constrained parametric curve fitting. </p>
<p>Fits a \( d \)-dimensional parametric spline curve \( s(u) = (s_1(u), \ldots, s_d(u)) \) subject to derivative constraints at the endpoints:</p>
<p class="formulaDsp">
\[              s_j^{(l)}(u_1) = x_j^{(l)}, \quad l = 0, \ldots, i_b - 1
\]
</p>
   <p class="formulaDsp">
\[              s_j^{(l)}(u_m) = x_j^{(l)}, \quad l = 0, \ldots, i_e - 1
\]
</p>
<p>The algorithm first constructs a polynomial satisfying the constraints (via fppocu), then iteratively refines the knot set and solves the constrained least-squares system using Givens rotations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>0 = new fit, 1 = continue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of curve dimensions \( d \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Parameter values, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Length of <code>x</code> ( \( = m \cdot d \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data coordinates, interleaved, length <code>mx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Data weights, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>Number of derivative constraints at start </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ie</td><td>Number of derivative constraints at end </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Max knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Tolerance for smoothing condition </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k1</td><td>\( k + 1 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k2</td><td>\( k + 2 \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot vector, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of coefficient array <code>c</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nc</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpint</td><td>Residual sums per knot interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>Work: transformed RHS </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Work: band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b</td><td>Work: smoothing matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>Work: band matrix copy </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: B-spline values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdata</td><td>Interior data-point counts </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 8, 8.2 (pp. 141-146) </dd>
<dd>
<a class="el" href="#a1c1c9269f27beeddee5d8b680aaa7140" title="Construct a polynomial curve satisfying endpoint derivative constraints.">fppocu</a>  initial polynomial; <a class="el" href="#a73c05ec35eef6da81086156d5cf0597d" title="Rotate a smoothing-matrix row into a band matrix with vector RHS.">fp_rotate_shifted_vec</a>  smoothing rotation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a17a3995cbff15ef64c241c059a40e682_cgraph.png" border="0" usemap="#anamespacefitpack__core_a17a3995cbff15ef64c241c059a40e682_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a17a3995cbff15ef64c241c059a40e682_cgraph" id="anamespacefitpack__core_a17a3995cbff15ef64c241c059a40e682_cgraph">
<area shape="rect" title="Core algorithm for constrained parametric curve fitting." alt="" coords="5,221,157,246"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="210,5,369,45"/>
<area shape="poly" title=" " alt="" coords="86,219,128,143,162,96,204,55,211,50,214,54,207,59,166,100,132,146,91,222"/>
<area shape="rect" href="namespacefitpack__core.html#a82db002de9c1abeba86fae180dbec079" title="Rotate an observation row into a band matrix with vector RHS." alt="" coords="205,120,373,160"/>
<area shape="poly" title=" " alt="" coords="106,218,204,170,220,163,222,168,206,174,108,223"/>
<area shape="rect" href="namespacefitpack__core.html#a73c05ec35eef6da81086156d5cf0597d" title="Rotate a smoothing&#45;matrix row into a band matrix with vector RHS." alt="" coords="205,184,373,224"/>
<area shape="poly" title=" " alt="" coords="157,220,191,215,192,220,158,225"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="213,249,366,274"/>
<area shape="poly" title=" " alt="" coords="158,241,200,247,199,252,157,246"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="215,70,364,95"/>
<area shape="poly" title=" " alt="" coords="90,219,134,165,167,133,204,106,219,98,221,103,207,110,170,137,138,168,94,222"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="215,298,363,323"/>
<area shape="poly" title=" " alt="" coords="112,244,206,283,231,291,230,296,204,288,110,249"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="214,347,365,373"/>
<area shape="poly" title=" " alt="" coords="96,244,142,288,173,312,207,334,220,340,218,345,204,338,170,317,138,292,92,248"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="222,397,357,437"/>
<area shape="poly" title=" " alt="" coords="92,245,135,310,168,349,207,383,215,389,212,393,204,387,165,353,131,313,88,248"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="643,81,788,106"/>
<area shape="poly" title=" " alt="" coords="374,128,629,100,629,105,374,133"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="433,206,583,231"/>
<area shape="poly" title=" " alt="" coords="345,158,374,170,422,191,447,199,446,204,420,196,372,174,343,163"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="434,157,582,182"/>
<area shape="poly" title=" " alt="" coords="374,149,421,155,420,160,373,154"/>
<area shape="poly" title=" " alt="" coords="682,82,674,72,678,62,692,56,715,54,744,58,755,67,752,71,742,63,715,59,693,61,682,66,680,72,686,79"/>
<area shape="poly" title=" " alt="" coords="374,207,420,210,419,215,373,212"/>
<area shape="poly" title=" " alt="" coords="373,188,420,181,421,186,374,193"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="421,55,595,81"/>
<area shape="poly" title=" " alt="" coords="364,75,407,72,407,77,365,80"/>
<area shape="poly" title=" " alt="" coords="595,76,629,80,629,85,595,81"/>
<area shape="poly" title=" " alt="" coords="474,57,467,47,471,37,485,31,508,29,537,32,548,41,545,46,534,37,508,34,486,36,475,41,472,46,478,54"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="436,405,580,430"/>
<area shape="poly" title=" " alt="" coords="357,415,422,415,422,420,357,420"/>
</map>
</div>

</div>
</div>
<a id="a896928a4fbb29c241426ae61e5f2e69c" name="a896928a4fbb29c241426ae61e5f2e69c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a896928a4fbb29c241426ae61e5f2e69c">&#9670;&#160;</a></span>fpcosp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpcosp </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxbin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>sq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>sx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bind</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nm,maxbin), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>const</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>zz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(maxbin), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>up</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>left</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mb), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>jbind</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mb), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ibind</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core algorithm for convexity-constrained cubic spline fitting. </p>
<p>Given a fixed knot set, solves the constrained least-squares problem using the Theil-Van de Panne active-set enumeration (7.2). For each candidate active-constraint set (tracked in a binary tree), solves the equality-constrained system and checks feasibility and optimality via the Lagrange multipliers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data abscissae, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Data ordinates, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Data weights, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot vector, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">e</td><td>Discontinuity jump coefficients, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxtr</td><td>Max tree nodes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxbin</td><td>Max active constraints </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sq</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sx</td><td>Spline values at data points, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bind</td><td>Active constraint flags, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nm</td><td>Dimension parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mb</td><td>Dimension parameter </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Work matrix <code>(n, 4)</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b</td><td>Work matrix <code>(nm, maxbin)</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">const</td><td>Constraint vector, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>Work vector, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">zz</td><td>Work vector, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">u</td><td>Work vector, length <code>maxbin</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work matrix <code>(m, 4)</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">info</td><td>Tree info array, length <code>maxtr</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">up</td><td>Tree parent pointers, length <code>maxtr</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">left</td><td>Tree left-child pointers, length <code>maxtr</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">right</td><td>Tree right-child pointers, length <code>maxtr</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">jbind</td><td>Work array for constraint indices, length <code>mb</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ibind</td><td>Work array for constraint indices, length <code>mb</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 7, 7.1-7.2 (pp. 115-130) </dd>
<dd>
<a class="el" href="#a4003dce07901ef7e9b8db9bb2a45b97c" title="Fit a convexity-constrained cubic smoothing spline.">fpcoco</a>  driver routine; <a class="el" href="#a9bcbf8cf99bfb2ac2f3834891c731be7" title="Add a branch to the constraint-set binary tree.">fpadno</a>, <a class="el" href="#ad5d82ac791ec6ae19e9b4671ffb734e0" title="Prune short branches from the constraint-set binary tree.">fpdeno</a>, <a class="el" href="#a535f9e04981c794c70a60f728e918472" title="Fetch and advance to the next branch in the constraint-set tree.">fpseno</a>  tree operations </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a896928a4fbb29c241426ae61e5f2e69c_cgraph.png" border="0" usemap="#anamespacefitpack__core_a896928a4fbb29c241426ae61e5f2e69c_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a896928a4fbb29c241426ae61e5f2e69c_cgraph" id="anamespacefitpack__core_a896928a4fbb29c241426ae61e5f2e69c_cgraph">
<area shape="rect" title="Core algorithm for convexity&#45;constrained cubic spline fitting." alt="" coords="5,119,157,145"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="205,5,364,45"/>
<area shape="poly" title=" " alt="" coords="100,117,147,87,204,55,218,48,220,53,207,60,149,92,103,121"/>
<area shape="rect" href="namespacefitpack__core.html#a9bcbf8cf99bfb2ac2f3834891c731be7" title="Add a branch to the constraint&#45;set binary tree." alt="" coords="207,70,362,95"/>
<area shape="poly" title=" " alt="" coords="134,117,218,96,219,101,135,122"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="210,119,359,145"/>
<area shape="poly" title=" " alt="" coords="157,129,196,129,196,135,157,135"/>
<area shape="rect" href="namespacefitpack__core.html#ad5d82ac791ec6ae19e9b4671ffb734e0" title="Prune short branches from the constraint&#45;set binary tree." alt="" coords="207,169,362,194"/>
<area shape="poly" title=" " alt="" coords="135,142,219,163,218,168,134,147"/>
<area shape="rect" href="namespacefitpack__core.html#a535f9e04981c794c70a60f728e918472" title="Fetch and advance to the next branch in the constraint&#45;set tree." alt="" coords="208,218,361,243"/>
<area shape="poly" title=" " alt="" coords="102,143,148,173,206,204,223,211,221,216,204,209,146,178,99,147"/>
<area shape="rect" href="namespacefitpack__core.html#a8006d449287383c5f5c4151086e9a376" title="Collect free nodes from the constraint&#45;set binary tree." alt="" coords="425,58,573,83"/>
<area shape="poly" title=" " alt="" coords="362,76,411,73,411,78,362,81"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="412,131,585,157"/>
<area shape="poly" title=" " alt="" coords="360,134,399,136,398,141,360,139"/>
<area shape="poly" title=" " alt="" coords="465,133,458,123,461,113,475,107,499,105,527,108,539,117,535,122,525,113,499,110,477,112,465,117,463,122,469,130"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="633,131,779,157"/>
<area shape="poly" title=" " alt="" coords="586,141,620,141,620,147,586,147"/>
<area shape="poly" title=" " alt="" coords="672,133,665,123,669,113,683,107,706,105,735,108,746,117,743,122,732,113,706,110,684,112,673,117,670,122,676,130"/>
</map>
</div>

</div>
</div>
<a id="a8c6900d3b80033043b2b73b49ce84fc2" name="a8c6900d3b80033043b2b73b49ce84fc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c6900d3b80033043b2b73b49ce84fc2">&#9670;&#160;</a></span>fpcsin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure elemental subroutine fitpack_core::fpcsin </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>par</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sia</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>coa</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sib</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>cob</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>resc</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute weighted Fourier integrals of a cubic polynomial. </p>
<p>Calculates the integrals:</p>
<p class="formulaDsp">
\[              \text{ress} = \int_a^b (b-x)^3 \sin(\omega x) \, dx, \quad
              \text{resc} = \int_a^b (b-x)^3 \cos(\omega x) \, dx
\]
</p>
<p>given precomputed trigonometric values at the endpoints. Used by fpbfou to compute Fourier coefficients of B-splines.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Left endpoint </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Right endpoint </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">par</td><td>Frequency \( \omega \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sia</td><td>\( \sin(\omega a) \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coa</td><td>\( \cos(\omega a) \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sib</td><td>\( \sin(\omega b) \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cob</td><td>\( \cos(\omega b) \) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ress</td><td>Sine integral result </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">resc</td><td>Cosine integral result</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 3, 3.3 (Fourier integrals) </dd>
<dd>
<a class="el" href="#acc0e64bf7c182c225873ce2bfac77ab1" title="Compute Fourier coefficients of cubic B-splines.">fpbfou</a>  B-spline Fourier coefficient computation </dd></dl>

</div>
</div>
<a id="a4763622af119a94c3be9390ee5d12eb3" name="a4763622af119a94c3be9390ee5d12eb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4763622af119a94c3be9390ee5d12eb3">&#9670;&#160;</a></span>fpcurf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpcurf </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xe</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>g</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdata</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core algorithm for univariate spline curve fitting. </p>
<p>Determines a smooth spline approximation \( s(x) \) of degree \( k \) on the interval \( [x_b, x_e] \) that satisfies the smoothing criterion:</p>
<p class="formulaDsp">
\[              F_g(p) = \sum_{i=1}^{m} \bigl( w_i (y_i - s(x_i)) \bigr)^2
              \leq S
              \tag{4.12}
\]
</p>
<p>The algorithm iterates over three levels:</p>
<ol type="1">
<li><b>Knot selection</b> (5.3): adds knots at locations of maximum residual (Eq. 5.37-5.43) until the smoothing condition can be met.</li>
<li><b>Weighted least-squares</b> (4.1): for each knot set, solves the banded system via QR with Givens rotations (Eq. 4.14-4.15).</li>
<li><b>Smoothing parameter search</b> (5.2.4): finds \( p \) such that \( F_g(p) = S \) using rational interpolation (Eq. 5.30-5.32).</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>0 = new fit, 1 = continue with more knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data abscissae, length <code>m</code> (strictly increasing) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Data ordinates, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Data weights, length <code>m</code> (positive) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xb</td><td>Left boundary of approximation interval </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xe</td><td>Right boundary of approximation interval </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree ( \( 1 \leq k \leq 5 \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Max number of knots (workspace bound) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Tolerance for the smoothing condition </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum iterations for the \( p \)-search </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k1</td><td>\( k + 1 \) (spline order) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k2</td><td>\( k + 2 \) (smoothing bandwidth) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot vector, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals \( F_g(p) \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpint</td><td>Residual sums per knot interval, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>Work: transformed RHS, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Work: band matrix, <code>(nest, k1)</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b</td><td>Work: smoothing matrix, <code>(nest, k2)</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>Work: band matrix copy, <code>(nest, k2)</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: B-spline values, <code>(m, k1)</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdata</td><td>Interior data-point counts per interval, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 4, 4.1-4.2 (pp. 53-65); Ch. 5, 5.2-5.3 (pp. 73-94) </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a4763622af119a94c3be9390ee5d12eb3_cgraph.png" border="0" usemap="#anamespacefitpack__core_a4763622af119a94c3be9390ee5d12eb3_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a4763622af119a94c3be9390ee5d12eb3_cgraph" id="anamespacefitpack__core_a4763622af119a94c3be9390ee5d12eb3_cgraph">
<area shape="rect" title="Core algorithm for univariate spline curve fitting." alt="" coords="5,209,152,235"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="220,9,379,49"/>
<area shape="poly" title=" " alt="" coords="84,208,125,137,158,95,198,59,207,53,210,57,202,63,162,99,129,140,88,210"/>
<area shape="rect" href="namespacefitpack__core.html#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="200,123,399,148"/>
<area shape="poly" title=" " alt="" coords="100,207,145,183,199,158,226,149,227,154,201,163,147,187,103,212"/>
<area shape="rect" href="namespacefitpack__core.html#aa452051613d61831a99b2f9ef8e21bc8" title="Rotate a smoothing&#45;matrix row into a band matrix using shifted pivots." alt="" coords="215,173,383,213"/>
<area shape="poly" title=" " alt="" coords="152,210,201,203,202,208,153,215"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="223,237,376,263"/>
<area shape="poly" title=" " alt="" coords="153,229,209,236,209,241,152,234"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="225,73,374,99"/>
<area shape="poly" title=" " alt="" coords="88,207,132,158,164,131,199,108,213,101,216,106,201,112,167,135,136,162,92,211"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="225,287,373,312"/>
<area shape="poly" title=" " alt="" coords="106,232,201,273,226,280,224,286,199,278,104,237"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="224,336,375,361"/>
<area shape="poly" title=" " alt="" coords="93,233,138,277,168,302,201,322,217,329,215,334,199,327,165,306,134,281,89,237"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="232,386,367,426"/>
<area shape="poly" title=" " alt="" coords="89,233,131,299,163,338,202,372,221,383,218,387,198,376,159,342,126,302,84,236"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="668,80,813,105"/>
<area shape="poly" title=" " alt="" coords="398,121,446,115,654,97,654,102,447,121,399,126"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="459,131,608,156"/>
<area shape="poly" title=" " alt="" coords="399,136,445,138,445,143,399,141"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="459,180,607,205"/>
<area shape="poly" title=" " alt="" coords="353,145,468,174,467,179,351,151"/>
<area shape="poly" title=" " alt="" coords="707,82,700,72,703,62,717,56,741,53,769,57,781,66,777,70,767,62,741,59,719,61,707,65,705,71,711,78"/>
<area shape="poly" title=" " alt="" coords="359,210,415,224,482,234,552,233,586,227,619,216,652,196,681,169,723,115,727,119,685,173,655,200,621,220,588,232,552,238,482,239,414,230,357,215"/>
<area shape="poly" title=" " alt="" coords="383,172,459,156,460,161,384,178"/>
<area shape="poly" title=" " alt="" coords="384,190,445,190,445,195,384,195"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="447,29,620,55"/>
<area shape="poly" title=" " alt="" coords="367,71,451,55,452,60,368,76"/>
<area shape="poly" title=" " alt="" coords="587,52,676,74,674,79,586,57"/>
<area shape="poly" title=" " alt="" coords="500,31,492,21,496,11,510,5,533,3,562,6,573,15,570,20,560,11,533,8,511,10,500,15,498,20,504,28"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="461,393,605,419"/>
<area shape="poly" title=" " alt="" coords="367,403,448,403,448,409,367,409"/>
</map>
</div>

</div>
</div>
<a id="aef57b5a3a930e0c3aa2eeb311b571aa6" name="aef57b5a3a930e0c3aa2eeb311b571aa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef57b5a3a930e0c3aa2eeb311b571aa6">&#9670;&#160;</a></span>fpcuro()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpcuro </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(3), intent(out)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find the real zeros of a cubic polynomial. </p>
<p>Computes all real roots of the cubic polynomial:</p>
<p class="formulaDsp">
\[              p(x) = a x^3 + b x^2 + c x + d
\]
</p>
<p>Handles the degenerate cases (linear, quadratic) and uses the standard trigonometric method for the irreducible case (three real roots) and Cardano's formula otherwise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Coefficient of \( x^3 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Coefficient of \( x^2 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Coefficient of \( x \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Constant term </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>Array of length 3 containing the real zeros </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">n</td><td>Number of real zeros found ( \( 0 \leq n \leq 3 \)) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a95f95a1ab846dcf0b4035058fdde4bad" name="a95f95a1ab846dcf0b4035058fdde4bad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95f95a1ab846dcf0b4035058fdde4bad">&#9670;&#160;</a></span>fpcyt1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpcyt1 </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nn,6), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nn</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>LU-decompose a cyclic tridiagonal matrix. </p>
<p>Computes the LU decomposition of an \( n \times n \) cyclic tridiagonal matrix arising from periodic spline fitting. The matrix has the structure:</p>
<p class="formulaDsp">
\[              \begin{pmatrix}
              a_{1,2} &amp; a_{1,3} &amp;         &amp;        &amp;         &amp; a_{1,1} \\
              a_{2,1} &amp; a_{2,2} &amp; a_{2,3} &amp;        &amp;         &amp;         \\
                      &amp; \ddots  &amp; \ddots  &amp; \ddots &amp;         &amp;         \\
                      &amp;         &amp; a_{n-1,1} &amp; a_{n-1,2} &amp; a_{n-1,3} \\
              a_{n,3} &amp;         &amp;         &amp;        &amp; a_{n,1} &amp; a_{n,2}
              \end{pmatrix}
\]
</p>
<p>The decomposition factors are stored in columns 4-6 of the array <code>a</code>. The back-substitution is performed by fpcyt2.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Matrix stored as <code>a(nn,6)</code>. Columns 1-3 hold the tridiagonal + cyclic entries; columns 4-6 receive the LU factors. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Matrix dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nn</td><td>Leading dimension of <code>a</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.1 (pp. 95-100), Eq. 6.5-6.6 </dd>
<dd>
<a class="el" href="#a3781580dd8295b2e2a32266fd0fcf027" title="Solve a cyclic tridiagonal system using LU factors from fpcyt1.">fpcyt2</a>  back-substitution using the LU factors </dd></dl>

</div>
</div>
<a id="a3781580dd8295b2e2a32266fd0fcf027" name="a3781580dd8295b2e2a32266fd0fcf027"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3781580dd8295b2e2a32266fd0fcf027">&#9670;&#160;</a></span>fpcyt2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpcyt2 </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nn,6), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(out)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nn</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve a cyclic tridiagonal system using LU factors from fpcyt1. </p>
<p>Solves the \( n \times n \) linear system \( A \, c = b \) where \( A \) is a cyclic tridiagonal matrix whose LU decomposition has been computed by fpcyt1 and stored in columns 4-6 of the array <code>a</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>LU-factored matrix from fpcyt1, dimension <code>(nn, 6)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>System dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Right-hand side vector, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">c</td><td>Solution vector, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nn</td><td>Leading dimension of <code>a</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.1 (pp. 95-100), Eq. 6.5-6.6 </dd>
<dd>
<a class="el" href="#a95f95a1ab846dcf0b4035058fdde4bad" title="LU-decompose a cyclic tridiagonal matrix.">fpcyt1</a>  LU decomposition of the cyclic tridiagonal matrix </dd></dl>

</div>
</div>
<a id="ad5d82ac791ec6ae19e9b4671ffb734e0" name="ad5d82ac791ec6ae19e9b4671ffb734e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d82ac791ec6ae19e9b4671ffb734e0">&#9670;&#160;</a></span>fpdeno()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpdeno </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>up</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>left</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nbind</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>merk</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prune short branches from the constraint-set binary tree. </p>
<p>Frees all branches whose length is less than <code>nbind</code> by setting their <code>up</code> field to zero. This reclaims memory in the triply linked tree used by the Theil-Van de Panne procedure (7.2), keeping only branches at the current search frontier.</p>
<p>On exit, <code>merk</code> points to the terminal node of the leftmost branch of length <code>nbind</code>, or is set to 1 if no such branch exists.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">maxtr</td><td>Size of the tree arrays </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">up</td><td>Parent pointers; freed nodes get <code>up = 0</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">left</td><td>Left-child pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">right</td><td>Right-child pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbind</td><td>Minimum branch length to retain </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">merk</td><td>Terminal node of the leftmost surviving branch, or 1 if none</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 7, 7.2.4 (pp. 125-130) </dd>
<dd>
<a class="el" href="#a9bcbf8cf99bfb2ac2f3834891c731be7" title="Add a branch to the constraint-set binary tree.">fpadno</a>, <a class="el" href="#a8006d449287383c5f5c4151086e9a376" title="Collect free nodes from the constraint-set binary tree.">fpfrno</a>, <a class="el" href="#a535f9e04981c794c70a60f728e918472" title="Fetch and advance to the next branch in the constraint-set tree.">fpseno</a>  companion tree operations </dd></dl>

</div>
</div>
<a id="a57fba861443159865065312aa46b6627" name="a57fba861443159865065312aa46b6627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57fba861443159865065312aa46b6627">&#9670;&#160;</a></span>fpdisc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpdisc </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the discontinuity jumps of the B-spline derivatives. </p>
<p>Calculates the discontinuity jumps of the \( k \)-th derivative of the B-splines of degree \( k \) at the interior knots \( \lambda_{k+2}, \ldots, \lambda_{n-k-1} \). These coefficients \( a_{i,q} \) appear in the smoothness measure:</p>
<p class="formulaDsp">
\[              a_{i,q} = \frac{(-1)^{k+1} \, k! \, (\lambda_{i+k+1} - \lambda_i)}
              {\displaystyle\prod_{\substack{j=q-k \\ j \neq i}}^{q}
              (\lambda_{q+1} - \lambda_{j+1})}
              \tag{5.6}
\]
</p>
<p>for \( q - k - 1 \leq i \leq q \), and zero otherwise. The output matrix \( B \) stores these values for use in evaluating the smoothing functional \( \sum_q [\sum_i c_i \, a_{i,q}]^2 \) (Eq. 5.5).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot vector \( \lambda_1, \ldots, \lambda_n \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Length of the knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k2</td><td>Spline order \( k + 1 \) (= degree + 1) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">b</td><td>Discontinuity jump matrix, stored as <code>b(nest, k2)</code>. Row \( q \) contains the \( k+1 \) non-zero jumps at interior knot \( \lambda_{q+k+1} \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Leading dimension of array <code>b</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 5, 5.2.2 (pp. 76-79), Eq. 5.5-5.6 </dd></dl>

</div>
</div>
<a id="a8006d449287383c5f5c4151086e9a376" name="a8006d449287383c5f5c4151086e9a376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8006d449287383c5f5c4151086e9a376">&#9670;&#160;</a></span>fpfrno()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpfrno </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>up</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>left</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>point</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>merk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>count</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Collect free nodes from the constraint-set binary tree. </p>
<p>Scans the triply linked tree for free nodes (those with <code>up = 0</code>, previously released by fpdeno) and makes them available for reuse. If no free nodes are found, the error flag <code>ier</code> is set to 1.</p>
<p>This routine is called by fpadno when the tree needs a new node but the <code>count</code> pointer has exhausted the pre-allocated array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">maxtr</td><td>Size of the tree arrays </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">up</td><td>Parent pointers; <code>up(i) = 0</code> marks a free node </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">left</td><td>Left-child pointers </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">right</td><td>Right-child pointers </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">info</td><td>Constraint index stored at each node </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">point</td><td>Pointer to the collected free-node chain </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">merk</td><td>Terminal node of the current branch </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n1</td><td>Maximum branch length </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">count</td><td>Number of free nodes found </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: 0 = success, 1 = no free nodes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 7, 7.2.4 (pp. 125-130) </dd>
<dd>
<a class="el" href="#a9bcbf8cf99bfb2ac2f3834891c731be7" title="Add a branch to the constraint-set binary tree.">fpadno</a>, <a class="el" href="#ad5d82ac791ec6ae19e9b4671ffb734e0" title="Prune short branches from the constraint-set binary tree.">fpdeno</a>, <a class="el" href="#a535f9e04981c794c70a60f728e918472" title="Fetch and advance to the next branch in the constraint-set tree.">fpseno</a>  companion tree operations </dd></dl>

</div>
</div>
<a id="aee86d7e7c8bbb38a98dd2dff92861293" name="aee86d7e7c8bbb38a98dd2dff92861293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee86d7e7c8bbb38a98dd2dff92861293">&#9670;&#160;</a></span>fpgivs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental subroutine fitpack_core::fpgivs </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>piv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ww</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>cos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>sin</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute parameters of a Givens plane rotation. </p>
<p>Given a pivot element \( e_i \) and a diagonal element \( r_i \), computes the cosine \( c \) and sine \( s \) of a Givens rotation that eliminates \( e_i \):</p>
<p class="formulaDsp">
\[              r&#39;_i = \sqrt{r_i^2 + e_i^2}, \quad
              c = \frac{r_i}{r&#39;_i}, \quad
              s = \frac{e_i}{r&#39;_i}
              \tag{4.15}
\]
</p>
<p>The rotation preserves orthogonality ( \( c^2 + s^2 = 1 \)) and is used to triangularize the observation matrix \( E \) row by row during the QR decomposition of the least-squares system.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">piv</td><td>Pivot element \( e_i \) to be eliminated </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ww</td><td>On entry, diagonal element \( r_i \). On exit, updated value \( r&#39;_i = \sqrt{r_i^2 + e_i^2} \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cos</td><td>Cosine of rotation angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sin</td><td>Sine of rotation angle</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 4, 4.1.2 (pp. 55-58), Eq. 4.15 </dd></dl>

</div>
</div>
<a id="a03d606165767f7703429cb55181efe11" name="a03d606165767f7703429cb55181efe11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03d606165767f7703429cb55181efe11">&#9670;&#160;</a></span>fpgrdi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpgrdi </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lback</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mz), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(3), intent(in)</td>          <td class="paramname"><span class="paramname"><em>dz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iop0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iop1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>sq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mvnu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mm), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mvnu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>au</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,6), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>av1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>av2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(2,mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>aa</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(2,nv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cosi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nru</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrv</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute spline coefficients on a polar/spherical grid via Kronecker product. </p>
<p>Grid-based variant of the Kronecker product decomposition (Eq. 10.4-10.8) adapted for polar and spherical coordinates. Handles the periodic \( v \)-direction using two-matrix rotations (fp_rotate_2mat_stride) and incorporates origin/pole boundary conditions via the <code>iop0</code>/<code>iop1</code> flags. The <code>dz</code> parameter provides prescribed values at \( u = 0 \) and/or \( u = 1 \).</p>
<p>Uses <code>lback = .true.</code> for back-substitution only (coefficients from a previous triangularization).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsu</td><td>Flag: 0 = recompute \( S_{pu} \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsv</td><td>Flag: 0 = recompute \( S_{pv} \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbu</td><td>Flag: 0 = recompute \( B_u \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbv</td><td>Flag: 0 = recompute \( B_v \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lback</td><td><code>.true.</code> = back-substitution only </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Radial grid values, length <code>mu</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>Number of radial grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Angular grid values, length <code>mv</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mv</td><td>Number of angular grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values, length <code>mz</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mz</td><td>Length of <code>z</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dz</td><td>Boundary values at origin/edge </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iop0</td><td>Boundary condition at \( u = 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iop1</td><td>Boundary condition at \( u = 1 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tu</td><td>Radial knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Number of radial knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tv</td><td>Angular knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nv</td><td>Number of angular knots </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p</td><td>Smoothing parameter (output) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nc</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of <code>c</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sq</td><td>Sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpu</td><td>Residual sums per radial interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpv</td><td>Residual sums per angular interval </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mm</td><td>Work dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mvnu</td><td>Work dimension </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spu</td><td>Radial B-spline observation matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spv</td><td>Angular B-spline observation matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">right</td><td>Work: RHS vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: RHS matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">au</td><td>Work: radial band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">av1</td><td>Work: angular band matrix (main block) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">av2</td><td>Work: angular band matrix (periodic block) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bu</td><td>Work: radial discontinuity jumps </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bv</td><td>Work: angular discontinuity jumps </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aa</td><td>Work: boundary constraint matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bb</td><td>Work: boundary constraint matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cc</td><td>Work: boundary constraint matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cosi</td><td>Work: cosine integrals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nru</td><td>Work: radial knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrv</td><td>Work: angular knot interval indices</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 10, 10.2 (pp. 170-172), Eq. 10.4-10.8 </dd>
<dd>
<a class="el" href="#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block-triangular periodic system with stride RHS.">fp_rotate_2mat_stride</a>  periodic grid Givens rotation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a03d606165767f7703429cb55181efe11_cgraph.png" border="0" usemap="#anamespacefitpack__core_a03d606165767f7703429cb55181efe11_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a03d606165767f7703429cb55181efe11_cgraph" id="anamespacefitpack__core_a03d606165767f7703429cb55181efe11_cgraph">
<area shape="rect" title="Compute spline coefficients on a polar/spherical grid via Kronecker product." alt="" coords="5,287,152,313"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="205,5,363,45"/>
<area shape="poly" title=" " alt="" coords="80,286,92,243,115,181,150,115,172,83,198,55,204,51,207,55,202,59,176,87,154,117,120,183,97,244,85,288"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="200,197,368,237"/>
<area shape="poly" title=" " alt="" coords="110,285,199,248,219,240,221,245,201,253,112,290"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="200,69,368,109"/>
<area shape="poly" title=" " alt="" coords="83,286,98,253,123,209,157,161,198,119,205,114,208,119,202,123,161,165,128,212,103,256,88,288"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="200,133,368,173"/>
<area shape="poly" title=" " alt="" coords="88,285,133,237,164,208,199,183,209,177,212,182,201,188,168,213,137,241,92,289"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="207,311,361,337"/>
<area shape="poly" title=" " alt="" coords="152,306,194,311,194,316,152,311"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="207,361,361,386"/>
<area shape="poly" title=" " alt="" coords="110,310,201,347,224,354,222,359,199,352,108,315"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="209,262,359,287"/>
<area shape="poly" title=" " alt="" coords="152,288,196,283,196,288,152,294"/>
<area shape="rect" href="namespacefitpack__core.html#a95f95a1ab846dcf0b4035058fdde4bad" title="LU&#45;decompose a cyclic tridiagonal matrix." alt="" coords="209,410,359,435"/>
<area shape="poly" title=" " alt="" coords="94,311,139,353,169,376,201,396,216,403,213,408,199,401,166,381,135,357,90,315"/>
<area shape="rect" href="namespacefitpack__core.html#a3781580dd8295b2e2a32266fd0fcf027" title="Solve a cyclic tridiagonal system using LU factors from fpcyt1." alt="" coords="209,459,359,485"/>
<area shape="poly" title=" " alt="" coords="89,311,131,376,163,414,202,446,211,452,209,456,198,450,159,417,127,379,85,314"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="210,509,358,534"/>
<area shape="poly" title=" " alt="" coords="87,312,100,348,124,398,158,450,178,474,202,495,209,500,206,505,198,499,175,478,153,454,119,401,95,350,82,314"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="637,202,783,227"/>
<area shape="poly" title=" " alt="" coords="368,214,624,213,624,218,368,219"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="428,77,577,102"/>
<area shape="poly" title=" " alt="" coords="348,195,366,183,381,166,389,148,398,130,414,113,426,105,429,110,418,117,402,133,394,151,386,169,370,187,351,199"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="429,126,577,151"/>
<area shape="poly" title=" " alt="" coords="339,195,452,154,454,159,341,200"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="416,302,589,327"/>
<area shape="poly" title=" " alt="" coords="338,235,369,248,465,293,463,298,367,253,336,240"/>
<area shape="poly" title=" " alt="" coords="676,204,669,194,673,184,687,178,710,175,739,179,750,188,747,192,736,184,710,181,688,183,677,187,674,193,680,200"/>
<area shape="poly" title=" " alt="" coords="529,299,669,231,671,236,532,304"/>
<area shape="poly" title=" " alt="" coords="469,304,462,294,465,284,479,278,503,275,531,279,543,288,539,292,529,284,503,281,481,283,469,287,467,293,473,300"/>
<area shape="poly" title=" " alt="" coords="338,67,392,52,457,42,525,43,559,50,591,62,628,88,659,122,683,157,700,188,695,191,679,160,655,125,625,92,588,66,557,55,525,48,457,47,393,57,339,72"/>
<area shape="poly" title=" " alt="" coords="368,87,414,87,414,92,368,92"/>
<area shape="poly" title=" " alt="" coords="369,106,433,120,432,126,368,111"/>
<area shape="poly" title=" " alt="" coords="369,163,624,200,623,205,368,168"/>
<area shape="poly" title=" " alt="" coords="352,131,445,103,446,108,354,136"/>
<area shape="poly" title=" " alt="" coords="368,145,415,142,415,147,368,150"/>
<area shape="poly" title=" " alt="" coords="355,285,420,297,419,302,354,290"/>
</map>
</div>

</div>
</div>
<a id="a0cc8f44b08134a5a84ab88c44e86485d" name="a0cc8f44b08134a5a84ab88c44e86485d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cc8f44b08134a5a84ab88c44e86485d">&#9670;&#160;</a></span>fpgrpa()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpgrpa </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ipar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mz*idim), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc*idim), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(out)</td>          <td class="paramname"><span class="paramname"><em>fpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(out)</td>          <td class="paramname"><span class="paramname"><em>fpv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mvnu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mm*idim), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mvnu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>au</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>au1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>av</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>av1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nru</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrv</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute parametric surface spline coefficients on a grid. </p>
<p>Grid-based Kronecker product decomposition (Eq. 10.9-10.12) for \( d \)-dimensional parametric surfaces. Computes the least-squares spline \( s_\infty(u,v) \) and the per-interval residual sums <code>fpu(j)</code> and <code>fpv(j)</code> needed for knot-placement decisions. Handles optional periodicity in \( u \) and/or \( v \) via the <code>ipar</code> flags, using two-matrix variants for periodic directions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsu</td><td>Flag: 0 = recompute \( S_{pu} \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsv</td><td>Flag: 0 = recompute \( S_{pv} \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbu</td><td>Flag: 0 = recompute \( B_u \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbv</td><td>Flag: 0 = recompute \( B_v \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of surface dimensions \( d \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipar</td><td>Periodicity flags (packed) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>\( u \)-grid values, length <code>mu</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>Number of \( u \)-grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>\( v \)-grid values, length <code>mv</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mv</td><td>Number of \( v \)-grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values, length <code>mz</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mz</td><td>Length of <code>z</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tu</td><td>\( u \)-knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Number of \( u \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tv</td><td>\( v \)-knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nv</td><td>Number of \( v \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Smoothing parameter </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nc</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of <code>c</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Total weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpu</td><td>Residual sums per \( u \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpv</td><td>Residual sums per \( v \)-interval </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mm</td><td>Work dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mvnu</td><td>Work dimension </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spu</td><td>\( u \)-B-spline observation matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spv</td><td>\( v \)-B-spline observation matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">right</td><td>Work: RHS vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: RHS matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">au</td><td>Work: \( u \)-band matrix (main) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">au1</td><td>Work: \( u \)-band matrix (periodic) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">av</td><td>Work: \( v \)-band matrix (main) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">av1</td><td>Work: \( v \)-band matrix (periodic) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bu</td><td>Work: \( u \)-discontinuity jumps </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bv</td><td>Work: \( v \)-discontinuity jumps </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nru</td><td>Work: \( u \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrv</td><td>Work: \( v \)-knot interval indices</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 10, 10.3 (pp. 173-178), Eq. 10.9-10.12 </dd>
<dd>
<a class="el" href="#a20ca1b341438d801bc6903c35d1d0e20" title="Triangularize the tensor-product system for non-periodic grids.">fptrnp</a>, <a class="el" href="#aca070414f01b6af3f396f8f3d12bc499" title="Triangularize the tensor-product system for periodic grids.">fptrpe</a>  tensor-product triangularization </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a0cc8f44b08134a5a84ab88c44e86485d_cgraph.png" border="0" usemap="#anamespacefitpack__core_a0cc8f44b08134a5a84ab88c44e86485d_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a0cc8f44b08134a5a84ab88c44e86485d_cgraph" id="anamespacefitpack__core_a0cc8f44b08134a5a84ab88c44e86485d_cgraph">
<area shape="rect" title="Compute parametric surface spline coefficients on a grid." alt="" coords="5,129,156,155"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="204,5,357,31"/>
<area shape="poly" title=" " alt="" coords="93,127,138,85,169,61,203,40,216,33,219,38,205,44,172,65,142,89,96,131"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="204,55,357,80"/>
<area shape="poly" title=" " alt="" coords="110,127,203,89,223,82,225,87,205,94,112,132"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="415,227,564,252"/>
<area shape="poly" title=" " alt="" coords="110,152,154,171,205,189,306,212,402,227,401,232,305,217,203,194,152,176,107,157"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="207,255,355,280"/>
<area shape="poly" title=" " alt="" coords="98,153,144,191,205,233,233,247,231,252,203,238,141,195,94,157"/>
<area shape="rect" href="namespacefitpack__core.html#a20ca1b341438d801bc6903c35d1d0e20" title="Triangularize the tensor&#45;product system for non&#45;periodic grids." alt="" coords="207,104,355,129"/>
<area shape="poly" title=" " alt="" coords="156,130,192,125,193,130,156,135"/>
<area shape="rect" href="namespacefitpack__core.html#aca070414f01b6af3f396f8f3d12bc499" title="Triangularize the tensor&#45;product system for periodic grids." alt="" coords="207,153,355,179"/>
<area shape="poly" title=" " alt="" coords="156,148,193,153,192,158,156,154"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="621,253,795,279"/>
<area shape="poly" title=" " alt="" coords="565,246,608,251,607,256,564,251"/>
<area shape="poly" title=" " alt="" coords="674,255,667,245,671,235,685,229,708,227,737,230,748,239,745,244,734,235,708,232,686,234,675,239,672,244,678,252"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="843,179,988,204"/>
<area shape="poly" title=" " alt="" coords="744,251,866,206,868,211,745,256"/>
<area shape="poly" title=" " alt="" coords="882,180,874,170,878,160,892,154,915,152,944,156,955,165,952,169,942,161,915,157,893,159,882,164,880,170,886,177"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="405,90,573,130"/>
<area shape="poly" title=" " alt="" coords="355,112,391,110,392,116,355,117"/>
<area shape="poly" title=" " alt="" coords="533,87,587,68,654,52,690,48,726,48,761,53,796,64,830,84,860,111,902,165,898,169,856,115,827,88,794,68,760,58,725,53,690,53,655,57,589,73,535,92"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="633,128,783,153"/>
<area shape="poly" title=" " alt="" coords="574,119,620,126,620,131,573,124"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="634,79,782,104"/>
<area shape="poly" title=" " alt="" coords="573,100,620,96,621,101,574,105"/>
<area shape="poly" title=" " alt="" coords="328,151,401,131,402,136,329,156"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="405,154,573,194"/>
<area shape="poly" title=" " alt="" coords="355,166,392,168,391,173,355,172"/>
<area shape="poly" title=" " alt="" coords="539,192,665,245,663,250,537,197"/>
<area shape="poly" title=" " alt="" coords="574,175,829,185,829,191,574,180"/>
<area shape="poly" title=" " alt="" coords="573,159,620,151,620,157,574,164"/>
<area shape="poly" title=" " alt="" coords="545,151,572,140,596,126,620,113,640,106,642,111,622,118,598,131,575,144,547,156"/>
</map>
</div>

</div>
</div>
<a id="a78b0d9c28e76eff73dcf956f4811c257" name="a78b0d9c28e76eff73dcf956f4811c257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78b0d9c28e76eff73dcf956f4811c257">&#9670;&#160;</a></span>fpgrre()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpgrre </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifby</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(my), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>my</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mz), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mynx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx,kx1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(my,ky1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mm), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mynx), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx,kx2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny,ky2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ay</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx,kx2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny,ky2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>by</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mx), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(my), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nry</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute grid-based spline coefficients via Kronecker product decomposition. </p>
<p>For data on a rectangular grid \( \{x_i\} \times \{y_j\} \), solves the smoothing least-squares system using the Kronecker product structure (Eq. 10.4-10.8):</p>
<p class="formulaDsp">
\[              A_y \, C \, A_x^T = Q
              \tag{10.4}
\]
</p>
<p>where the augmented observation matrices are:</p>
<p class="formulaDsp">
\[              A_x = \begin{pmatrix} S_{px} \\ \frac{1}{\sqrt{p}} B_x \end{pmatrix}, \quad
              A_y = \begin{pmatrix} S_{py} \\ \frac{1}{\sqrt{p}} B_y \end{pmatrix}
              \tag{10.5}
\]
</p>
<p>The \( x \)- and \( y \)-direction QR factorizations are performed independently using fp_rotate_row_stride (row-access RHS for \( A_y \)) and fp_rotate_row_block (column-access RHS for \( A_x \)), followed by back-substitution. Also computes residual sums <code>fpx</code>, <code>fpy</code> per knot interval for knot-placement decisions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsx</td><td>Flag: 0 = recompute \( S_{px} \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsy</td><td>Flag: 0 = recompute \( S_{py} \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbx</td><td>Flag: 0 = recompute \( B_x \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifby</td><td>Flag: 0 = recompute \( B_y \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>\( x \)-grid values, length <code>mx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Number of \( x \)-grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>\( y \)-grid values, length <code>my</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">my</td><td>Number of \( y \)-grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values on the grid, length <code>mz</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mz</td><td>Length of <code>z</code> ( \( = mx \cdot my \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Degree in \( x \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Degree in \( y \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>\( x \)-knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Number of \( x \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ty</td><td>\( y \)-knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Number of \( y \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Smoothing parameter </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nc</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of <code>c</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Total weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpx</td><td>Residual sums per \( x \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpy</td><td>Residual sums per \( y \)-interval </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mm</td><td>Work dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mynx</td><td>Work dimension ( \( my \cdot (nx - kx - 1) \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx1</td><td>\( k_x + 1 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx2</td><td>\( k_x + 2 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky1</td><td>\( k_y + 1 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky2</td><td>\( k_y + 2 \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spx</td><td>\( x \)-B-spline observation matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spy</td><td>\( y \)-B-spline observation matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">right</td><td>Work: RHS vector for row rotations </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: RHS matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ax</td><td>Work: \( x \)-band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ay</td><td>Work: \( y \)-band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bx</td><td>Work: \( x \)-discontinuity jumps </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">by</td><td>Work: \( y \)-discontinuity jumps </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrx</td><td>Work: \( x \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nry</td><td>Work: \( y \)-knot interval indices</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 10, 10.2 (pp. 170-172), Eq. 10.4-10.8 </dd>
<dd>
<a class="el" href="#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous-block RHS.">fp_rotate_row_block</a>, <a class="el" href="#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row-access) RHS.">fp_rotate_row_stride</a>  grid Givens rotations </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a78b0d9c28e76eff73dcf956f4811c257_cgraph.png" border="0" usemap="#anamespacefitpack__core_a78b0d9c28e76eff73dcf956f4811c257_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a78b0d9c28e76eff73dcf956f4811c257_cgraph" id="anamespacefitpack__core_a78b0d9c28e76eff73dcf956f4811c257_cgraph">
<area shape="rect" title="Compute grid&#45;based spline coefficients via Kronecker product decomposition." alt="" coords="5,158,153,184"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="201,30,369,70"/>
<area shape="poly" title=" " alt="" coords="94,156,140,119,200,79,213,73,215,78,203,84,143,124,97,160"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="201,94,369,134"/>
<area shape="poly" title=" " alt="" coords="125,156,199,135,201,140,127,161"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="209,208,362,233"/>
<area shape="poly" title=" " alt="" coords="134,181,219,202,218,207,132,186"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="211,158,360,184"/>
<area shape="poly" title=" " alt="" coords="154,168,197,168,197,174,154,174"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="211,257,359,282"/>
<area shape="poly" title=" " alt="" coords="99,182,145,212,202,243,220,250,218,255,200,248,142,217,96,186"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="639,137,784,162"/>
<area shape="poly" title=" " alt="" coords="342,27,396,13,460,4,527,5,560,11,592,22,626,42,656,69,698,124,694,127,652,73,623,47,590,27,559,17,526,11,460,10,397,19,344,32"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="429,86,579,112"/>
<area shape="poly" title=" " alt="" coords="370,66,435,81,433,86,369,71"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="430,37,578,62"/>
<area shape="poly" title=" " alt="" coords="370,47,416,47,416,52,370,52"/>
<area shape="poly" title=" " alt="" coords="678,139,670,129,674,119,688,113,711,110,740,114,751,123,748,127,738,119,711,116,689,118,678,123,676,128,682,135"/>
<area shape="poly" title=" " alt="" coords="370,118,625,140,625,145,370,123"/>
<area shape="poly" title=" " alt="" coords="369,105,415,102,416,108,370,111"/>
<area shape="poly" title=" " alt="" coords="350,91,417,71,442,64,444,69,418,76,352,96"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="417,212,591,237"/>
<area shape="poly" title=" " alt="" coords="339,181,439,206,437,211,338,186"/>
<area shape="poly" title=" " alt="" coords="540,209,662,165,664,170,541,214"/>
<area shape="poly" title=" " alt="" coords="470,213,463,203,467,194,481,187,504,185,533,189,544,198,541,202,530,194,504,190,482,192,471,197,468,203,474,210"/>
</map>
</div>

</div>
</div>
<a id="a74a11f85ace5b032c95c53307fa47913" name="a74a11f85ace5b032c95c53307fa47913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74a11f85ace5b032c95c53307fa47913">&#9670;&#160;</a></span>fpgrsp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpgrsp </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lback</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mr), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(6), intent(in)</td>          <td class="paramname"><span class="paramname"><em>dr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iop0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iop1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>sq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mvnu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mm), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mvnu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>au</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,6), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>av1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>av2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(2,mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(2,mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(2,nv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(2,nv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv,2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cosi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nru</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrv</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute spherical grid spline coefficients via Kronecker product. </p>
<p>Spherical-coordinate variant of fpgrdi for data on a \( \theta \times \phi \) grid. Handles pole-continuity constraints at \( \theta = 0 \) and \( \theta = \pi \) via the <code>iop0</code>/<code>iop1</code> flags, and the periodic \( \phi \)-direction using two-matrix rotations. The <code>dr</code> parameter provides prescribed pole values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsu</td><td>Flag: 0 = recompute \( S_{pu} \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsv</td><td>Flag: 0 = recompute \( S_{pv} \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbu</td><td>Flag: 0 = recompute \( B_u \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbv</td><td>Flag: 0 = recompute \( B_v \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lback</td><td><code>.true.</code> = back-substitution only </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Co-latitude grid values \( \theta \), length <code>mu</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>Number of \( \theta \)-grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Longitude grid values \( \phi \), length <code>mv</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mv</td><td>Number of \( \phi \)-grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Data values, length <code>mr</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mr</td><td>Length of <code>r</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dr</td><td>Pole boundary values </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iop0</td><td>Boundary condition at north pole ( \( \theta = 0 \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iop1</td><td>Boundary condition at south pole ( \( \theta = \pi \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tu</td><td>\( \theta \)-knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Number of \( \theta \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tv</td><td>\( \phi \)-knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nv</td><td>Number of \( \phi \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>Smoothing parameter </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nc</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of <code>c</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sq</td><td>Sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpu</td><td>Residual sums per \( \theta \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpv</td><td>Residual sums per \( \phi \)-interval </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mm</td><td>Work dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mvnu</td><td>Work dimension </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spu</td><td>\( \theta \)-B-spline observation matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spv</td><td>\( \phi \)-B-spline observation matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">right</td><td>Work: RHS vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: RHS matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">au</td><td>Work: \( \theta \)-band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">av1</td><td>Work: \( \phi \)-band matrix (main) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">av2</td><td>Work: \( \phi \)-band matrix (periodic) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bu</td><td>Work: \( \theta \)-discontinuity jumps </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bv</td><td>Work: \( \phi \)-discontinuity jumps </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a0</td><td>Work: north-pole constraint row </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a1</td><td>Work: south-pole constraint row </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b0</td><td>Work: north-pole smoothing row </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b1</td><td>Work: south-pole smoothing row </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c0</td><td>Work: north-pole cosine row </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c1</td><td>Work: south-pole cosine row </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cosi</td><td>Work: cosine integrals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nru</td><td>Work: \( \theta \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrv</td><td>Work: \( \phi \)-knot interval indices</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.2 (pp. 205-213) </dd>
<dd>
<a class="el" href="#a03d606165767f7703429cb55181efe11" title="Compute spline coefficients on a polar/spherical grid via Kronecker product.">fpgrdi</a>  <a class="el" href="#a406065ef7b15f1380c2759e9650355f2" title="Fit a smooth bivariate spline to scattered data on a polar domain.">polar</a> grid variant; <a class="el" href="#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block-triangular periodic system with stride RHS.">fp_rotate_2mat_stride</a>  periodic rotation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a74a11f85ace5b032c95c53307fa47913_cgraph.png" border="0" usemap="#anamespacefitpack__core_a74a11f85ace5b032c95c53307fa47913_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a74a11f85ace5b032c95c53307fa47913_cgraph" id="anamespacefitpack__core_a74a11f85ace5b032c95c53307fa47913_cgraph">
<area shape="rect" title="Compute spherical grid spline coefficients via Kronecker product." alt="" coords="5,287,156,313"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="209,5,367,45"/>
<area shape="poly" title=" " alt="" coords="82,286,95,243,118,181,153,115,176,83,202,55,208,51,211,55,206,59,180,87,158,117,123,183,100,244,88,288"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="204,197,372,237"/>
<area shape="poly" title=" " alt="" coords="113,285,203,248,223,240,225,245,205,253,115,290"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="204,69,372,109"/>
<area shape="poly" title=" " alt="" coords="85,286,101,253,126,209,160,161,202,119,209,114,212,119,206,123,164,165,131,212,106,256,90,288"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="204,133,372,173"/>
<area shape="poly" title=" " alt="" coords="91,285,136,237,168,208,203,183,213,177,216,182,205,188,171,213,140,241,94,289"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="211,311,365,337"/>
<area shape="poly" title=" " alt="" coords="157,306,198,311,197,316,156,311"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="211,361,365,386"/>
<area shape="poly" title=" " alt="" coords="112,310,205,347,228,354,226,359,203,352,110,315"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="213,262,363,287"/>
<area shape="poly" title=" " alt="" coords="156,288,199,283,200,288,157,293"/>
<area shape="rect" href="namespacefitpack__core.html#a95f95a1ab846dcf0b4035058fdde4bad" title="LU&#45;decompose a cyclic tridiagonal matrix." alt="" coords="213,410,363,435"/>
<area shape="poly" title=" " alt="" coords="96,311,142,353,172,376,205,396,220,403,217,408,203,401,169,381,138,357,93,315"/>
<area shape="rect" href="namespacefitpack__core.html#a3781580dd8295b2e2a32266fd0fcf027" title="Solve a cyclic tridiagonal system using LU factors from fpcyt1." alt="" coords="213,459,363,485"/>
<area shape="poly" title=" " alt="" coords="91,311,134,376,167,414,206,446,215,452,213,456,202,450,163,417,130,379,87,314"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="214,509,362,534"/>
<area shape="poly" title=" " alt="" coords="89,312,103,348,127,398,161,450,182,474,206,495,213,500,210,505,202,499,178,478,157,454,122,401,98,350,84,314"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="641,202,787,227"/>
<area shape="poly" title=" " alt="" coords="372,214,628,213,628,218,372,219"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="432,77,581,102"/>
<area shape="poly" title=" " alt="" coords="352,195,370,183,385,166,393,148,402,130,418,113,430,105,433,110,422,117,406,133,398,151,390,169,374,187,355,199"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="433,126,581,151"/>
<area shape="poly" title=" " alt="" coords="343,195,456,154,458,159,345,200"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="420,302,593,327"/>
<area shape="poly" title=" " alt="" coords="342,235,373,248,469,293,467,298,371,253,340,240"/>
<area shape="poly" title=" " alt="" coords="680,204,673,194,677,184,691,178,714,175,743,179,754,188,751,192,740,184,714,181,692,183,681,187,678,193,684,200"/>
<area shape="poly" title=" " alt="" coords="533,299,673,231,675,236,536,304"/>
<area shape="poly" title=" " alt="" coords="473,304,466,294,469,284,483,278,507,275,535,279,547,288,543,292,533,284,507,281,485,283,473,287,471,293,477,300"/>
<area shape="poly" title=" " alt="" coords="342,67,396,52,461,42,529,43,563,50,595,62,632,88,663,122,687,157,704,188,699,191,683,160,659,125,629,92,592,66,561,55,529,48,461,47,397,57,343,72"/>
<area shape="poly" title=" " alt="" coords="372,87,418,87,418,92,372,92"/>
<area shape="poly" title=" " alt="" coords="373,106,437,120,436,126,372,111"/>
<area shape="poly" title=" " alt="" coords="373,163,628,200,627,205,372,168"/>
<area shape="poly" title=" " alt="" coords="356,131,449,103,450,108,358,136"/>
<area shape="poly" title=" " alt="" coords="372,145,419,142,419,147,372,150"/>
<area shape="poly" title=" " alt="" coords="359,285,424,297,423,302,358,290"/>
</map>
</div>

</div>
</div>
<a id="a3d51410017bf94f298da66b1d80fe524" name="a3d51410017bf94f298da66b1d80fe524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d51410017bf94f298da66b1d80fe524">&#9670;&#160;</a></span>fpinst()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpinst </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>l</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(out)</td>          <td class="paramname"><span class="paramname"><em>tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>nn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(out)</td>          <td class="paramname"><span class="paramname"><em>cc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Insert a single knot into a B-spline representation. </p>
<p>Given the B-spline representation \( (t, c) \) of a degree- \( k \) spline, computes the new knot vector \( t&#39; \) and coefficients \( c&#39; \) that represent the <b>same spline</b> after inserting one additional knot \( x \in [\lambda_l, \lambda_{l+1}) \). Uses the Boehm (1980) one-knot-at-a-time algorithm:</p>
<p class="formulaDsp">
\[              d_i = r_i \, c_i + (1 - r_i) \, c_{i-1}
              \tag{1.47}
\]
</p>
<p>where each weight \( r_i \in [0, 1] \) is a convex combination factor:</p>
<p class="formulaDsp">
\[              r_i = \frac{\tau_{j+1} - \tau_i}{\tau_{i+k+1} - \tau_i}
              \tag{1.48}
\]
</p>
<p>For periodic splines (<code>iopt /= 0</code>), the boundary coefficients are wrapped accordingly. At least one of \( l &gt; 2k \) or \( l &lt; n - 2k \) must hold.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>0 = non-periodic spline, otherwise periodic </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Input knot vector, length <code>n</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of input knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Input B-spline coefficients, length <code>n-k-1</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>New knot to insert, \( \lambda_l \leq x &lt; \lambda_{l+1} \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">l</td><td>Knot interval index where <code>x</code> is inserted </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tt</td><td>Output knot vector, length <code>nn</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nn</td><td>Number of output knots ( \( n + 1 \)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cc</td><td>Output B-spline coefficients, length <code>nn-k-1</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Leading dimension of arrays <code>t</code>, <code>c</code>, <code>tt</code>, <code>cc</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, 1.3.4 (pp. 34-37), Eq. 1.46-1.48 </dd></dl>

</div>
</div>
<a id="aaa4be60a77a5e3a8b9e0013517b221b2" name="aaa4be60a77a5e3a8b9e0013517b221b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa4be60a77a5e3a8b9e0013517b221b2">&#9670;&#160;</a></span>fpintb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpintb </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nk1), intent(out)</td>          <td class="paramname"><span class="paramname"><em>bint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nk1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute definite integrals of the normalized B-splines. </p>
<p>Calculates the definite integrals of each of the \( n-k-1 \) normalized B-splines \( N_{j,k+1}(u) \) of degree \( k \) over the interval \( [x, y] \):</p>
<p class="formulaDsp">
\[              \text{bint}(j) = \int_x^y N_{j,k+1}(u) \, du
\]
</p>
<p>Uses the Gaffney formula for indefinite integrals of B-splines, which exploits the identity (Eq. 1.42):</p>
<p class="formulaDsp">
\[              \int_{\lambda_j}^{u} N_{j,k+1}(v) \, dv
              = \frac{\lambda_{j+k+1} - \lambda_j}{k+1}
                \sum_{i=j+1}^{g+k+1} N_{i,k+2}(u)
              \tag{1.42}
\]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot vector \( \lambda_1, \ldots, \lambda_n \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bint</td><td>Array of length <code>nk1</code>; \( \text{bint}(j) = \int_x^y N_{j,k+1}(u)\,du \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nk1</td><td>Number of B-splines ( \( n - k - 1 \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Lower integration limit </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Upper integration limit</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, 1.3.3 (pp. 30-33), Eq. 1.42-1.44 </dd>
<dd>
Dierckx, Ch. 3, 3.2 (pp. 44-46), Eq. 3.8-3.10 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_aaa4be60a77a5e3a8b9e0013517b221b2_cgraph.png" border="0" usemap="#anamespacefitpack__core_aaa4be60a77a5e3a8b9e0013517b221b2_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_aaa4be60a77a5e3a8b9e0013517b221b2_cgraph" id="anamespacefitpack__core_aaa4be60a77a5e3a8b9e0013517b221b2_cgraph">
<area shape="rect" title="Compute definite integrals of the normalized B&#45;splines." alt="" coords="5,59,152,84"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="207,29,352,55"/>
<area shape="poly" title=" " alt="" coords="152,58,192,52,193,57,152,63"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="200,79,359,119"/>
<area shape="poly" title=" " alt="" coords="152,79,187,84,186,89,152,84"/>
<area shape="poly" title=" " alt="" coords="246,31,239,21,243,11,257,5,279,3,307,6,318,16,315,20,305,11,279,8,258,10,247,15,245,20,251,28"/>
</map>
</div>

</div>
</div>
<a id="a8357b7623d6629bc3663f8023fcd6666" name="a8357b7623d6629bc3663f8023fcd6666"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8357b7623d6629bc3663f8023fcd6666">&#9670;&#160;</a></span>fpknot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpknot </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdata</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>istart</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Select and insert a new knot at the location of maximum residual. </p>
<p>Locates the knot interval \( [\lambda_j, \lambda_{j+1}] \) with the largest sum of squared residuals \( \delta_j \) (Eq. 5.43) and inserts a new knot at the midpoint of its interior data points. This is the greedy knot-placement strategy used by the iterative smoothing spline algorithm:</p>
<p class="formulaDsp">
\[              \delta_j = \sideset{}{&#39;&#39;}{\sum}_{r=u_j+1}^{u_j+m_j}
              \bigl( w_r (y_r - S_{g}(x_r)) \bigr)^2
              \tag{5.43}
\]
</p>
<p>Only intervals with at least one interior data point ( \( m_j &gt; 2 \)) are eligible. The new knot is placed at \( x_{u_j + \lceil m_j/2 \rceil + 1} \). After insertion, <code>fpint</code> and <code>nrdata</code> are split to reflect the two new sub-intervals.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data abscissae, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot vector; new knot inserted on exit </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Number of knots; incremented by 1 on exit </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpint</td><td>Residual sum of squares per knot interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdata</td><td>Number of interior data points per interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrint</td><td>Number of knot intervals; incremented by 1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Leading dimension of arrays <code>t</code>, <code>fpint</code>, <code>nrdata</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">istart</td><td>Smallest eligible data index minus one</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 5, 5.3 (pp. 87-94), Eq. 5.37-5.43 </dd></dl>

</div>
</div>
<a id="a07a9d1d759c2a6d39e91039f904c923b" name="a07a9d1d759c2a6d39e91039f904c923b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07a9d1d759c2a6d39e91039f904c923b">&#9670;&#160;</a></span>fpopdi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpopdi </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mz), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(3), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>dz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(3), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ider</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nvest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nru</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute smoothing spline on a polar grid with origin constraints. </p>
<p>Given data on a \( (u, v) \) grid (radial \( \times \) angular), determines the B-spline coefficients of a bicubic smoothing spline \( s_p(u,v) \) periodic in \( v \), satisfying origin-continuity constraints:</p>
<ul>
<li>\( s(\lambda_1^u, v) = z_0 \) (constant at origin)</li>
<li>\( \partial s / \partial u |_{u=0} = dz(2)\cos v + dz(3)\sin v \) (if <code>iopt(2) = 1</code>)</li>
<li>\( s(\lambda_{n_u}^u, v) = 0 \) (if <code>iopt(3) = 1</code>)</li>
</ul>
<p>The unknown boundary parameters <code>dz(i)</code> (when not prescribed) are optimized to minimize the residual sum of squares, which is a quadratic function of <code>dz</code>. Delegates the grid QR factorization to fpgrdi.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsu</td><td>Flag: 0 = recompute radial B-splines </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsv</td><td>Flag: 0 = recompute angular B-splines </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbu</td><td>Flag: 0 = recompute radial discontinuities </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbv</td><td>Flag: 0 = recompute angular discontinuities </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Radial grid values, length <code>mu</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>Number of radial points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Angular grid values, length <code>mv</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mv</td><td>Number of angular points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values, length <code>mz</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mz</td><td>Length of <code>z</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z0</td><td>Value at origin (prescribed or initial guess) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dz</td><td>Boundary derivative parameters (3 values) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Constraint options (3 flags) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ider</td><td>Derivative specification flags </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tu</td><td>Radial knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Number of radial knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tv</td><td>Angular knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nv</td><td>Number of angular knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nuest</td><td>Max radial knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nvest</td><td>Max angular knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>Smoothing parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step</td><td>Search step for boundary parameter optimization </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nc</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of <code>c</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpu</td><td>Residual sums per radial interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpv</td><td>Residual sums per angular interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nru</td><td>Radial knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrv</td><td>Angular knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Work array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Length of <code>wrk</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.1 (pp. 197-205) </dd>
<dd>
<a class="el" href="#a03d606165767f7703429cb55181efe11" title="Compute spline coefficients on a polar/spherical grid via Kronecker product.">fpgrdi</a>  grid QR factorization; <a class="el" href="#a3a3d9c76b5b016414056f18b807aa39f" title="Driver for polar grid smoothing spline with knot selection.">fppogr</a>  <a class="el" href="#a406065ef7b15f1380c2759e9650355f2" title="Fit a smooth bivariate spline to scattered data on a polar domain.">polar</a> grid driver </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a07a9d1d759c2a6d39e91039f904c923b_cgraph.png" border="0" usemap="#anamespacefitpack__core_a07a9d1d759c2a6d39e91039f904c923b_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a07a9d1d759c2a6d39e91039f904c923b_cgraph" id="anamespacefitpack__core_a07a9d1d759c2a6d39e91039f904c923b_cgraph">
<area shape="rect" title="Compute smoothing spline on a polar grid with origin constraints." alt="" coords="5,313,156,338"/>
<area shape="rect" href="namespacefitpack__core.html#a03d606165767f7703429cb55181efe11" title="Compute spline coefficients on a polar/spherical grid via Kronecker product." alt="" coords="207,287,353,313"/>
<area shape="poly" title=" " alt="" coords="156,313,192,308,193,314,157,318"/>
<area shape="rect" href="namespacefitpack__core.html#a0055c06b11885b09b3da8a5b9b24d0bb" title="Solve a small symmetric linear system by Cholesky factorization." alt="" coords="204,337,356,362"/>
<area shape="poly" title=" " alt="" coords="157,332,190,336,190,341,156,337"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="409,5,567,45"/>
<area shape="poly" title=" " alt="" coords="282,286,294,243,318,181,353,115,376,83,402,55,408,51,411,55,406,59,380,87,358,117,323,183,299,244,287,288"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="404,197,572,237"/>
<area shape="poly" title=" " alt="" coords="312,285,423,240,425,245,314,290"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="404,69,572,109"/>
<area shape="poly" title=" " alt="" coords="284,286,300,253,326,209,360,161,402,119,409,114,412,119,406,123,364,165,330,212,305,256,289,288"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="404,133,572,173"/>
<area shape="poly" title=" " alt="" coords="290,285,336,237,368,208,403,183,413,177,416,182,405,188,371,213,340,241,294,289"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="411,311,565,337"/>
<area shape="poly" title=" " alt="" coords="354,306,398,311,397,316,353,311"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="411,361,565,386"/>
<area shape="poly" title=" " alt="" coords="323,310,357,323,405,347,425,354,423,359,403,352,355,328,321,315"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="413,262,563,287"/>
<area shape="poly" title=" " alt="" coords="353,288,400,283,400,288,354,294"/>
<area shape="rect" href="namespacefitpack__core.html#a95f95a1ab846dcf0b4035058fdde4bad" title="LU&#45;decompose a cyclic tridiagonal matrix." alt="" coords="413,410,563,435"/>
<area shape="poly" title=" " alt="" coords="335,310,358,323,374,342,382,361,390,379,406,397,413,402,410,406,402,401,385,382,377,363,370,345,354,327,333,315"/>
<area shape="rect" href="namespacefitpack__core.html#a3781580dd8295b2e2a32266fd0fcf027" title="Solve a cyclic tridiagonal system using LU factors from fpcyt1." alt="" coords="413,459,563,485"/>
<area shape="poly" title=" " alt="" coords="339,310,358,323,371,339,378,355,382,387,387,417,394,432,406,446,411,450,408,454,402,450,389,434,382,419,377,387,373,357,366,342,354,327,336,315"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="414,509,562,534"/>
<area shape="poly" title=" " alt="" coords="340,311,358,323,374,346,381,368,382,412,383,454,390,475,406,496,410,499,406,503,402,499,386,477,378,455,377,412,376,369,369,348,354,327,337,315"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="841,202,987,227"/>
<area shape="poly" title=" " alt="" coords="572,214,828,213,828,218,572,219"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="632,77,781,102"/>
<area shape="poly" title=" " alt="" coords="552,195,570,183,585,166,593,148,602,130,618,113,630,105,633,110,622,117,606,133,598,151,590,169,574,187,555,199"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="633,126,781,151"/>
<area shape="poly" title=" " alt="" coords="543,195,656,154,658,159,545,200"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="620,302,793,327"/>
<area shape="poly" title=" " alt="" coords="542,235,573,248,669,293,667,298,571,253,540,240"/>
<area shape="poly" title=" " alt="" coords="880,204,873,194,877,184,891,178,914,175,943,179,954,188,951,192,940,184,914,181,892,183,881,187,878,193,884,200"/>
<area shape="poly" title=" " alt="" coords="733,299,873,231,875,236,736,304"/>
<area shape="poly" title=" " alt="" coords="673,304,666,294,669,284,683,278,707,275,735,279,747,288,743,292,733,284,707,281,685,283,673,287,671,293,677,300"/>
<area shape="poly" title=" " alt="" coords="542,67,596,52,661,42,729,43,763,50,795,62,832,88,863,122,887,157,904,188,899,191,883,160,859,125,829,92,792,66,761,55,729,48,661,47,597,57,543,72"/>
<area shape="poly" title=" " alt="" coords="572,87,618,87,618,92,572,92"/>
<area shape="poly" title=" " alt="" coords="573,106,637,120,636,126,572,111"/>
<area shape="poly" title=" " alt="" coords="573,163,828,200,827,205,572,168"/>
<area shape="poly" title=" " alt="" coords="556,131,649,103,650,108,558,136"/>
<area shape="poly" title=" " alt="" coords="572,145,619,142,619,147,572,150"/>
<area shape="poly" title=" " alt="" coords="559,285,624,297,623,302,558,290"/>
</map>
</div>

</div>
</div>
<a id="a383ad79ef10f0ff29a9122c3f736178e" name="a383ad79ef10f0ff29a9122c3f736178e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a383ad79ef10f0ff29a9122c3f736178e">&#9670;&#160;</a></span>fpopsp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpopsp </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifsv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ifbv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mr), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(6), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>dr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(3), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(4), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ider</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nvest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nru</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute smoothing spline on a spherical grid with pole constraints. </p>
<p>Spherical counterpart of fpopdi. Given data on a \( (\theta, \phi) \) grid, determines a bicubic smoothing spline \( s_p(\theta,\phi) \) periodic in \( \phi \), satisfying pole-continuity constraints at both poles:</p>
<ul>
<li>\( s(0, \phi) = r_0 \) (north pole value)</li>
<li>\( s(\pi, \phi) = r_1 \) (south pole value)</li>
<li>Optional derivative constraints: \( \partial s / \partial \theta |_{\theta=0} = dr(2)\cos\phi + dr(3)\sin\phi \)</li>
</ul>
<p>Unknown pole parameters <code>dr(i)</code> are optimized to minimize the residual. Delegates to fpgrsp for the grid QR factorization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsu</td><td>Flag: 0 = recompute \( \theta \)-B-splines </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifsv</td><td>Flag: 0 = recompute \( \phi \)-B-splines </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbu</td><td>Flag: 0 = recompute \( \theta \)-discontinuities </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ifbv</td><td>Flag: 0 = recompute \( \phi \)-discontinuities </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Co-latitude grid \( \theta \), length <code>mu</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>Number of \( \theta \)-points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Longitude grid \( \phi \), length <code>mv</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mv</td><td>Number of \( \phi \)-points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Data values, length <code>mr</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mr</td><td>Length of <code>r</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r0</td><td>North-pole value (prescribed or initial guess) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r1</td><td>South-pole value (prescribed or initial guess) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dr</td><td>Pole derivative parameters (6 values) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Constraint options </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ider</td><td>Derivative specification flags </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tu</td><td>\( \theta \)-knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Number of \( \theta \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tv</td><td>\( \phi \)-knot vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nv</td><td>Number of \( \phi \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nuest</td><td>Max \( \theta \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nvest</td><td>Max \( \phi \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>Smoothing parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step</td><td>Search step for pole parameter optimization </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nc</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of <code>c</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpu</td><td>Residual sums per \( \theta \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpv</td><td>Residual sums per \( \phi \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nru</td><td>\( \theta \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrv</td><td>\( \phi \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Work array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Length of <code>wrk</code></td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.2 (pp. 205-213) </dd>
<dd>
<a class="el" href="#a74a11f85ace5b032c95c53307fa47913" title="Compute spherical grid spline coefficients via Kronecker product.">fpgrsp</a>  spherical grid QR factorization; <a class="el" href="#ae2fd0d6545f3ff0cc2019428c3d5ad38" title="Driver for spherical grid smoothing spline with knot selection.">fpspgr</a>  spherical grid driver </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a383ad79ef10f0ff29a9122c3f736178e_cgraph.png" border="0" usemap="#anamespacefitpack__core_a383ad79ef10f0ff29a9122c3f736178e_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a383ad79ef10f0ff29a9122c3f736178e_cgraph" id="anamespacefitpack__core_a383ad79ef10f0ff29a9122c3f736178e_cgraph">
<area shape="rect" title="Compute smoothing spline on a spherical grid with pole constraints." alt="" coords="5,313,159,338"/>
<area shape="rect" href="namespacefitpack__core.html#a74a11f85ace5b032c95c53307fa47913" title="Compute spherical grid spline coefficients via Kronecker product." alt="" coords="207,287,358,313"/>
<area shape="poly" title=" " alt="" coords="158,313,193,309,194,314,159,318"/>
<area shape="rect" href="namespacefitpack__core.html#a0055c06b11885b09b3da8a5b9b24d0bb" title="Solve a small symmetric linear system by Cholesky factorization." alt="" coords="207,337,359,362"/>
<area shape="poly" title=" " alt="" coords="159,332,193,336,193,341,158,337"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="411,5,570,45"/>
<area shape="poly" title=" " alt="" coords="284,286,297,243,320,181,356,115,379,83,405,55,410,51,414,55,408,59,383,87,360,117,325,183,302,244,290,288"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="407,197,575,237"/>
<area shape="poly" title=" " alt="" coords="315,285,426,240,428,245,317,290"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="407,69,575,109"/>
<area shape="poly" title=" " alt="" coords="287,286,303,253,329,209,363,161,405,119,412,114,415,119,408,123,367,165,333,212,308,256,292,288"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="407,133,575,173"/>
<area shape="poly" title=" " alt="" coords="293,285,339,237,370,208,405,183,416,177,418,182,408,188,374,213,342,241,297,289"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="414,311,567,337"/>
<area shape="poly" title=" " alt="" coords="358,306,401,311,400,316,358,311"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="414,361,567,386"/>
<area shape="poly" title=" " alt="" coords="326,310,360,323,408,347,428,354,426,359,406,352,358,328,324,315"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="416,262,565,287"/>
<area shape="poly" title=" " alt="" coords="358,288,402,283,403,288,358,294"/>
<area shape="rect" href="namespacefitpack__core.html#a95f95a1ab846dcf0b4035058fdde4bad" title="LU&#45;decompose a cyclic tridiagonal matrix." alt="" coords="415,410,566,435"/>
<area shape="poly" title=" " alt="" coords="338,310,360,323,377,342,385,361,393,379,408,397,416,402,413,406,405,401,388,382,380,363,372,345,357,327,335,315"/>
<area shape="rect" href="namespacefitpack__core.html#a3781580dd8295b2e2a32266fd0fcf027" title="Solve a cyclic tridiagonal system using LU factors from fpcyt1." alt="" coords="415,459,566,485"/>
<area shape="poly" title=" " alt="" coords="341,310,360,323,373,339,381,355,385,387,389,417,396,432,409,446,414,450,410,454,405,450,392,434,384,419,380,387,375,357,369,342,357,327,338,315"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="417,509,565,534"/>
<area shape="poly" title=" " alt="" coords="343,311,361,323,376,346,384,368,385,412,386,454,393,475,409,496,412,499,409,503,405,499,388,477,381,455,380,412,379,369,372,348,357,327,340,315"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="844,202,989,227"/>
<area shape="poly" title=" " alt="" coords="575,214,831,213,831,218,575,219"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="635,77,784,102"/>
<area shape="poly" title=" " alt="" coords="555,195,573,183,588,166,596,148,604,130,621,113,633,105,635,110,624,117,609,133,601,151,593,169,576,187,557,199"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="635,126,783,151"/>
<area shape="poly" title=" " alt="" coords="546,195,659,154,661,159,548,200"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="623,302,796,327"/>
<area shape="poly" title=" " alt="" coords="544,235,576,248,672,293,669,298,574,253,542,240"/>
<area shape="poly" title=" " alt="" coords="883,204,876,194,879,184,893,178,917,175,945,179,957,188,953,192,943,184,917,181,895,183,883,187,881,193,887,200"/>
<area shape="poly" title=" " alt="" coords="736,299,876,231,878,236,738,304"/>
<area shape="poly" title=" " alt="" coords="676,304,668,294,672,284,686,278,709,275,738,279,749,288,746,292,736,284,709,281,687,283,676,287,674,293,680,300"/>
<area shape="poly" title=" " alt="" coords="544,67,599,52,664,42,732,43,765,50,797,62,835,88,866,122,890,157,907,188,902,191,885,160,862,125,832,92,795,66,764,55,731,48,664,47,600,57,546,72"/>
<area shape="poly" title=" " alt="" coords="575,87,621,87,621,92,575,92"/>
<area shape="poly" title=" " alt="" coords="575,106,640,120,639,126,574,111"/>
<area shape="poly" title=" " alt="" coords="576,163,831,200,830,205,575,168"/>
<area shape="poly" title=" " alt="" coords="559,131,651,103,653,108,561,136"/>
<area shape="poly" title=" " alt="" coords="575,145,622,142,622,147,575,150"/>
<area shape="poly" title=" " alt="" coords="561,285,627,297,626,302,560,290"/>
</map>
</div>

</div>
</div>
<a id="a000e6860b30d66fcc8bf487d934c0f28" name="a000e6860b30d66fcc8bf487d934c0f28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000e6860b30d66fcc8bf487d934c0f28">&#9670;&#160;</a></span>fporde()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fporde </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>nummer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nreg), intent(out)</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nreg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sort scattered data points into rectangular panels. </p>
<p>Assigns each data point \( (x_i, y_i) \), \( i = 1, \ldots, m \), to the rectangular panel \( R_{u,v} \) defined by \( \lambda_u^x \leq x &lt; \lambda_{u+1}^x \) and \( \lambda_v^y \leq y &lt; \lambda_{v+1}^y \).</p>
<p>For each panel, a linked-list stack is built:</p><ul>
<li><code>index(j)</code> points to the first data point in panel \( j \)</li>
<li><code>nummer(i)</code> gives the next data point in the same panel</li>
</ul>
<p>This panel ordering enables efficient row-by-row construction of the observation matrix, since only the \( (k_x+1)(k_y+1) \) B-splines supported on a given panel contribute non-zero entries.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data abscissae, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Data ordinates, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Spline degree in \( x \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Spline degree in \( y \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>Knot vector in \( x \), length <code>nx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Number of knots in \( x \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ty</td><td>Knot vector in \( y \), length <code>ny</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Number of knots in \( y \) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nummer</td><td>Linked-list next pointers, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">index</td><td>Panel head pointers, length <code>nreg</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nreg</td><td>Number of panels \( = (n_x - 2k_x - 1)(n_y - 2k_y - 1) \)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 9, 9.1 (pp. 147-150) </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a000e6860b30d66fcc8bf487d934c0f28_cgraph.png" border="0" usemap="#anamespacefitpack__core_a000e6860b30d66fcc8bf487d934c0f28_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a000e6860b30d66fcc8bf487d934c0f28_cgraph" id="anamespacefitpack__core_a000e6860b30d66fcc8bf487d934c0f28_cgraph">
<area shape="rect" title="Sort scattered data points into rectangular panels." alt="" coords="5,13,156,38"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="204,5,363,45"/>
<area shape="poly" title=" " alt="" coords="156,23,190,23,190,28,156,28"/>
</map>
</div>

</div>
</div>
<a id="a5e667cdc0bc06d8fcf33ec1b61fe50a6" name="a5e667cdc0bc06d8fcf33ec1b61fe50a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e667cdc0bc06d8fcf33ec1b61fe50a6">&#9670;&#160;</a></span>fppara()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fppara </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ub</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ue</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>g</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdata</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core algorithm for open parametric curve fitting. </p>
<p>Fits a \( d \)-dimensional parametric spline curve \( s(u) = (s_1(u), \ldots, s_d(u)) \) of degree \( k \) on the parameter interval \( [u_b, u_e] \). All \( d \) coordinate curves share the same knot vector and are fitted simultaneously:</p>
<p class="formulaDsp">
\[              \sum_{i=1}^{m} w_i^2 \sum_{j=1}^{d} (x_{i,j} - s_j(u_i))^2 \leq S
              \tag{6.9}
\]
</p>
<p>The algorithm follows the same three-level iteration as fpcurf (knot selection, QR factorization, smoothing-parameter search) but uses vector-RHS Givens rotations (fp_rotate_row_vec) to process all dimensions in a single pass.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>0 = new fit, 1 = continue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of curve dimensions \( d \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Parameter values, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Length of <code>x</code> ( \( = m \cdot d \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data coordinates, interleaved, length <code>mx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Data weights, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ub</td><td>Left boundary of parameter interval </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ue</td><td>Right boundary of parameter interval </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Max knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Tolerance for smoothing condition </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k1</td><td>\( k + 1 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k2</td><td>\( k + 2 \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot vector, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nc</td><td>Length of coefficient array <code>c</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nc</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpint</td><td>Residual sums per knot interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>Work: transformed RHS </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Work: band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b</td><td>Work: smoothing matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>Work: band matrix copy </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: B-spline values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdata</td><td>Interior data-point counts </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.3 (pp. 112-114), Eq. 6.9 </dd>
<dd>
<a class="el" href="#a82db002de9c1abeba86fae180dbec079" title="Rotate an observation row into a band matrix with vector RHS.">fp_rotate_row_vec</a>  vector-RHS Givens rotation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a5e667cdc0bc06d8fcf33ec1b61fe50a6_cgraph.png" border="0" usemap="#anamespacefitpack__core_a5e667cdc0bc06d8fcf33ec1b61fe50a6_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a5e667cdc0bc06d8fcf33ec1b61fe50a6_cgraph" id="anamespacefitpack__core_a5e667cdc0bc06d8fcf33ec1b61fe50a6_cgraph">
<area shape="rect" title="Core algorithm for open parametric curve fitting." alt="" coords="5,221,156,246"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="209,5,367,45"/>
<area shape="poly" title=" " alt="" coords="85,219,127,143,161,96,202,55,209,50,212,55,206,59,165,100,131,146,90,222"/>
<area shape="rect" href="namespacefitpack__core.html#a82db002de9c1abeba86fae180dbec079" title="Rotate an observation row into a band matrix with vector RHS." alt="" coords="204,120,372,160"/>
<area shape="poly" title=" " alt="" coords="104,218,203,170,219,163,221,168,205,174,107,223"/>
<area shape="rect" href="namespacefitpack__core.html#a73c05ec35eef6da81086156d5cf0597d" title="Rotate a smoothing&#45;matrix row into a band matrix with vector RHS." alt="" coords="204,184,372,224"/>
<area shape="poly" title=" " alt="" coords="156,220,190,215,191,220,157,225"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="211,249,365,274"/>
<area shape="poly" title=" " alt="" coords="157,241,198,247,197,252,156,246"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="213,70,363,95"/>
<area shape="poly" title=" " alt="" coords="89,219,133,165,166,133,203,106,217,98,220,103,205,110,169,137,137,168,93,222"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="214,298,362,323"/>
<area shape="poly" title=" " alt="" coords="111,244,205,283,230,291,228,296,203,288,109,249"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="213,347,363,373"/>
<area shape="poly" title=" " alt="" coords="95,244,141,288,172,312,205,334,219,340,217,345,203,338,169,317,137,292,92,248"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="221,397,355,437"/>
<area shape="poly" title=" " alt="" coords="91,245,134,310,167,349,206,383,213,388,210,393,202,387,163,353,130,313,87,248"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="641,81,787,106"/>
<area shape="poly" title=" " alt="" coords="372,128,628,100,628,105,373,133"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="432,206,581,231"/>
<area shape="poly" title=" " alt="" coords="343,158,373,170,421,191,446,199,444,204,419,196,371,174,341,163"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="433,157,581,182"/>
<area shape="poly" title=" " alt="" coords="373,149,419,155,419,160,372,154"/>
<area shape="poly" title=" " alt="" coords="680,82,673,72,677,62,691,56,714,54,743,58,754,67,751,71,740,63,714,59,692,61,681,66,678,72,684,79"/>
<area shape="poly" title=" " alt="" coords="372,207,418,210,418,215,372,212"/>
<area shape="poly" title=" " alt="" coords="372,188,419,181,420,186,373,193"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="420,55,593,81"/>
<area shape="poly" title=" " alt="" coords="363,75,406,72,406,77,363,80"/>
<area shape="poly" title=" " alt="" coords="594,76,628,80,627,85,593,81"/>
<area shape="poly" title=" " alt="" coords="473,57,466,47,469,37,483,31,507,29,535,32,547,41,543,46,533,37,507,34,485,36,473,41,471,46,477,54"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="435,405,579,430"/>
<area shape="poly" title=" " alt="" coords="356,415,421,415,421,420,356,420"/>
</map>
</div>

</div>
</div>
<a id="a19127c353493bb69ea3a6c3c382895d7" name="a19127c353493bb69ea3a6c3c382895d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19127c353493bb69ea3a6c3c382895d7">&#9670;&#160;</a></span>fppasu()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fppasu </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ipar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mz*idim), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nvest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc*idim), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpold</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>reducu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>reducv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpintu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpintv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>lastdi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nplusu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nplusv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nru</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdatu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdatv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core algorithm for parametric surface fitting on a grid. </p>
<p>Fits a \( d \)-dimensional parametric tensor-product spline surface \( s(u,v) = (s_1(u,v), \ldots, s_d(u,v)) \) to data on a rectangular grid \( \{u_i\} \times \{v_j\} \). Uses the Kronecker product decomposition (Eq. 10.9-10.12) that separates the bivariate problem into sequences of univariate operations:</p>
<p class="formulaDsp">
\[              (A_u \otimes A_v) \, c = z
              \tag{10.9}
\]
</p>
<p>The \( u \)- and \( v \)-direction triangularizations are performed independently (via fp_rotate_row_block and fp_rotate_row_stride), followed by back-substitution.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>0 = new fit, 1 = continue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipar</td><td>Periodicity flags (packed) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of surface dimensions \( d \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>\( u \)-grid values, length <code>mu</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>Number of \( u \)-grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>\( v \)-grid values, length <code>mv</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mv</td><td>Number of \( v \)-grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values, length <code>mz</code> ( \( = mu \cdot mv \cdot d \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mz</td><td>Length of <code>z</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nuest</td><td>Max \( u \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nvest</td><td>Max \( v \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Smoothing condition tolerance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nc</td><td>Length of coefficient array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nu</td><td>Number of \( u \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tu</td><td>\( u \)-knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nv</td><td>Number of \( v \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tv</td><td>\( v \)-knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp0</td><td>Initial residual sum </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpold</td><td>Previous residual sum </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">reducu</td><td>Residual reduction in \( u \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">reducv</td><td>Residual reduction in \( v \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpintu</td><td>Residual sums per \( u \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpintv</td><td>Residual sums per \( v \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lastdi</td><td>Last direction of knot addition </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nplusu</td><td>Number of \( u \)-knots to add </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nplusv</td><td>Number of \( v \)-knots to add </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nru</td><td>Work: \( u \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrv</td><td>Work: \( v \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdatu</td><td>Interior data counts per \( u \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdatv</td><td>Interior data counts per \( v \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Work array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lwrk</td><td>Length of <code>wrk</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 10, 10.3 (pp. 173-178), Eq. 10.9-10.12 </dd>
<dd>
<a class="el" href="#a78b0d9c28e76eff73dcf956f4811c257" title="Compute grid-based spline coefficients via Kronecker product decomposition.">fpgrre</a>, <a class="el" href="#a03d606165767f7703429cb55181efe11" title="Compute spline coefficients on a polar/spherical grid via Kronecker product.">fpgrdi</a>  grid triangularization helpers </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a19127c353493bb69ea3a6c3c382895d7_cgraph.png" border="0" usemap="#anamespacefitpack__core_a19127c353493bb69ea3a6c3c382895d7_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a19127c353493bb69ea3a6c3c382895d7_cgraph" id="anamespacefitpack__core_a19127c353493bb69ea3a6c3c382895d7_cgraph">
<area shape="rect" title="Core algorithm for parametric surface fitting on a grid." alt="" coords="5,223,159,249"/>
<area shape="rect" href="namespacefitpack__core.html#a0cc8f44b08134a5a84ab88c44e86485d" title="Compute parametric surface spline coefficients on a grid." alt="" coords="217,145,368,170"/>
<area shape="poly" title=" " alt="" coords="109,221,206,180,231,172,233,177,208,185,111,226"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="217,194,368,219"/>
<area shape="poly" title=" " alt="" coords="159,223,203,216,204,222,159,228"/>
<area shape="rect" href="namespacefitpack__core.html#a8c4fa92fbc6556a21d112fbdfbd0f80f" title=" " alt="" coords="207,244,379,284"/>
<area shape="poly" title=" " alt="" coords="159,244,194,248,193,253,159,249"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="225,308,360,348"/>
<area shape="poly" title=" " alt="" coords="109,246,208,294,224,301,222,305,206,298,107,251"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="427,155,580,181"/>
<area shape="poly" title=" " alt="" coords="369,158,413,161,413,166,368,164"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="427,205,580,230"/>
<area shape="poly" title=" " alt="" coords="339,167,446,198,444,203,337,173"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="637,243,787,269"/>
<area shape="poly" title=" " alt="" coords="355,168,380,180,396,196,404,213,412,228,428,240,475,258,526,267,577,269,624,267,624,273,577,275,526,272,474,263,425,245,408,231,400,215,392,199,377,185,352,172"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="429,106,577,131"/>
<area shape="poly" title=" " alt="" coords="362,142,420,131,421,137,363,147"/>
<area shape="rect" href="namespacefitpack__core.html#a20ca1b341438d801bc6903c35d1d0e20" title="Triangularize the tensor&#45;product system for non&#45;periodic grids." alt="" coords="429,7,577,33"/>
<area shape="poly" title=" " alt="" coords="304,143,353,94,388,66,425,42,438,35,441,40,428,46,391,70,357,98,307,146"/>
<area shape="rect" href="namespacefitpack__core.html#aca070414f01b6af3f396f8f3d12bc499" title="Triangularize the tensor&#45;product system for periodic grids." alt="" coords="429,57,577,82"/>
<area shape="poly" title=" " alt="" coords="317,142,426,91,445,84,446,89,428,96,319,147"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="844,213,1017,238"/>
<area shape="poly" title=" " alt="" coords="787,243,830,237,831,242,787,248"/>
<area shape="poly" title=" " alt="" coords="897,214,890,204,893,194,907,188,931,186,959,190,971,199,967,203,957,195,931,191,909,193,897,198,895,204,901,211"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="1065,138,1211,163"/>
<area shape="poly" title=" " alt="" coords="966,210,1088,165,1090,170,968,215"/>
<area shape="poly" title=" " alt="" coords="1104,140,1097,130,1101,120,1115,114,1138,111,1167,115,1178,124,1175,128,1164,120,1138,117,1116,119,1105,123,1102,129,1108,136"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="628,25,796,65"/>
<area shape="poly" title=" " alt="" coords="578,26,615,31,614,36,578,32"/>
<area shape="poly" title=" " alt="" coords="775,23,829,11,891,4,956,6,988,12,1018,23,1053,43,1082,70,1124,125,1120,128,1079,74,1050,48,1016,28,986,18,955,11,891,9,830,16,776,28"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="856,87,1005,113"/>
<area shape="poly" title=" " alt="" coords="793,63,867,81,865,87,792,68"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="857,38,1005,63"/>
<area shape="poly" title=" " alt="" coords="796,45,843,46,843,51,796,50"/>
<area shape="poly" title=" " alt="" coords="578,58,614,54,615,59,578,63"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="628,89,796,129"/>
<area shape="poly" title=" " alt="" coords="571,79,615,88,614,93,570,85"/>
<area shape="poly" title=" " alt="" coords="752,127,895,204,892,208,750,132"/>
<area shape="poly" title=" " alt="" coords="797,116,844,121,1052,141,1051,146,844,127,796,122"/>
<area shape="poly" title=" " alt="" coords="796,103,842,101,842,106,796,108"/>
<area shape="poly" title=" " alt="" coords="786,87,869,64,870,70,788,92"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="431,315,575,341"/>
<area shape="poly" title=" " alt="" coords="360,325,418,325,418,331,360,331"/>
</map>
</div>

</div>
</div>
<a id="a408ada754639be78ba19d10d4e92d560" name="a408ada754639be78ba19d10d4e92d560"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a408ada754639be78ba19d10d4e92d560">&#9670;&#160;</a></span>fpperi()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpperi </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>g1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>g2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,k1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdata</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core algorithm for univariate periodic spline fitting. </p>
<p>Fits a periodic spline \( s(x) \) of degree \( k \) where \( s^{(j)}(x_1) = s^{(j)}(x_m) \) for \( j = 0, \ldots, k-1 \). The periodicity reduces the number of free coefficients to \( n - 2k - 1 \) and wraps the B-spline columns into the block-triangular structure (Eq. 6.13) analogous to fpclos.</p>
<p>This is the scalar-valued counterpart of fpclos (which handles multi-dimensional parametric curves). Uses two-matrix Givens rotations (fp_rotate_row_2mat) for the periodic block structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>0 = new fit, 1 = continue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data abscissae, length <code>m</code> (strictly increasing) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Data ordinates, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Data weights, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Max knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Tolerance for smoothing condition </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k1</td><td>\( k + 1 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k2</td><td>\( k + 2 \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Number of knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot vector, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients, length <code>nest</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpint</td><td>Residual sums per knot interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">z</td><td>Work: transformed RHS </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a1</td><td>Work: band matrix \( R_{11}^* \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a2</td><td>Work: band matrix \( R_{12}^*/R_{22}^* \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b</td><td>Work: smoothing matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g1</td><td>Work: band matrix copy </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g2</td><td>Work: band matrix copy </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: B-spline values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdata</td><td>Interior data-point counts </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.1-6.2 (pp. 95-112), Eq. 6.1-6.8 </dd>
<dd>
<a class="el" href="#ab3c656c52c7e12d25083b56910547f2c" title="Rotate a split observation row into the block-triangular periodic system with scalar RHS.">fp_rotate_row_2mat</a>  two-matrix scalar Givens rotation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a408ada754639be78ba19d10d4e92d560_cgraph.png" border="0" usemap="#anamespacefitpack__core_a408ada754639be78ba19d10d4e92d560_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a408ada754639be78ba19d10d4e92d560_cgraph" id="anamespacefitpack__core_a408ada754639be78ba19d10d4e92d560_cgraph">
<area shape="rect" title="Core algorithm for univariate periodic spline fitting." alt="" coords="5,286,152,311"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="220,5,379,45"/>
<area shape="poly" title=" " alt="" coords="80,285,92,241,114,180,149,113,172,82,198,55,207,49,210,53,202,59,176,86,154,116,119,182,97,243,85,286"/>
<area shape="rect" href="namespacefitpack__core.html#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="200,286,399,311"/>
<area shape="poly" title=" " alt="" coords="153,296,186,296,186,301,153,301"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="459,182,608,207"/>
<area shape="poly" title=" " alt="" coords="84,284,100,256,125,220,158,184,199,156,237,143,277,137,317,136,357,139,432,155,491,174,489,179,430,160,357,144,317,141,277,142,238,148,201,161,161,188,129,223,104,259,88,287"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="459,235,607,261"/>
<area shape="poly" title=" " alt="" coords="132,283,200,271,329,257,446,249,446,254,329,262,200,276,133,289"/>
<area shape="rect" href="namespacefitpack__core.html#ab3c656c52c7e12d25083b56910547f2c" title="Rotate a split observation row into the block&#45;triangular periodic system with scalar RHS." alt="" coords="215,171,383,211"/>
<area shape="poly" title=" " alt="" coords="99,284,199,227,229,213,232,218,201,232,101,288"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="223,335,376,361"/>
<area shape="poly" title=" " alt="" coords="137,309,229,330,228,335,136,314"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="225,70,374,95"/>
<area shape="poly" title=" " alt="" coords="82,285,97,251,122,204,156,155,198,113,223,98,226,103,202,117,160,159,126,207,102,253,87,287"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="225,385,373,410"/>
<area shape="poly" title=" " alt="" coords="98,309,143,340,201,371,221,378,219,383,199,376,140,345,95,314"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="224,434,375,459"/>
<area shape="poly" title=" " alt="" coords="91,310,134,364,165,395,201,420,214,427,212,431,199,425,162,399,130,367,86,313"/>
<area shape="rect" href="namespacefitpack__core.html#a58bbdfcdf11801b4bacf532b022a2815" title=" " alt="" coords="226,484,373,524"/>
<area shape="poly" title=" " alt="" coords="88,311,103,343,128,386,161,431,202,470,215,478,212,483,198,474,157,434,123,389,98,345,83,313"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="232,548,367,588"/>
<area shape="poly" title=" " alt="" coords="85,311,97,354,119,414,154,478,176,508,202,534,220,546,217,551,198,538,172,511,149,481,115,416,92,355,80,312"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="668,131,813,157"/>
<area shape="poly" title=" " alt="" coords="399,306,451,306,508,301,565,289,619,270,652,248,681,221,723,167,727,170,685,225,655,252,621,274,566,295,509,306,451,311,399,311"/>
<area shape="poly" title=" " alt="" coords="321,284,377,253,446,220,475,209,476,214,448,225,379,258,324,288"/>
<area shape="poly" title=" " alt="" coords="358,283,460,261,461,266,360,288"/>
<area shape="poly" title=" " alt="" coords="707,133,700,123,703,113,717,107,741,105,769,108,781,117,777,122,767,113,741,110,719,112,707,117,705,122,711,130"/>
<area shape="poly" title=" " alt="" coords="383,175,446,167,654,147,654,153,447,172,384,180"/>
<area shape="poly" title=" " alt="" coords="384,189,445,190,445,196,383,195"/>
<area shape="poly" title=" " alt="" coords="382,208,468,229,467,235,381,213"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="447,75,620,101"/>
<area shape="poly" title=" " alt="" coords="375,82,433,83,433,88,374,87"/>
<area shape="poly" title=" " alt="" coords="582,98,680,125,679,130,580,103"/>
<area shape="poly" title=" " alt="" coords="500,77,492,67,496,57,510,51,533,49,562,52,573,61,570,66,560,57,533,54,511,56,500,61,498,66,504,74"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="461,555,605,581"/>
<area shape="poly" title=" " alt="" coords="367,565,448,565,448,571,367,571"/>
</map>
</div>

</div>
</div>
<a id="a58bbdfcdf11801b4bacf532b022a2815" name="a58bbdfcdf11801b4bacf532b022a2815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58bbdfcdf11801b4bacf532b022a2815">&#9670;&#160;</a></span>fpperi_reset_interp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpperi_reset_interp </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>kk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>kk1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>per</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>fp0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdata</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>done</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1c1c9269f27beeddee5d8b680aaa7140" name="a1c1c9269f27beeddee5d8b680aaa7140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c1c9269f27beeddee5d8b680aaa7140">&#9670;&#160;</a></span>fppocu()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fppocu </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ib</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nb), intent(in)</td>          <td class="paramname"><span class="paramname"><em>db</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ie</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ne), intent(in)</td>          <td class="paramname"><span class="paramname"><em>de</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ne</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(np), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>np</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a polynomial curve satisfying endpoint derivative constraints. </p>
<p>Finds a \( d \)-dimensional polynomial curve \( p(u) = (p_1(u), \ldots, p_d(u)) \) of degree \( k \) that satisfies prescribed derivative values at the endpoints \( a \) and \( b \):</p>
<p class="formulaDsp">
\[              p_j^{(l)}(a) = \text{db}(d \cdot l + j), \quad l = 0, \ldots, i_b - 1
\]
</p>
   <p class="formulaDsp">
\[              p_j^{(l)}(b) = \text{de}(d \cdot l + j), \quad l = 0, \ldots, i_e - 1
\]
</p>
<p>The result is returned as B-spline coefficients <code>cp(1:np)</code> on the knot vector \( [a, \ldots, a, b, \ldots, b] \) (each with multiplicity \( k+1 \)). Used by concur to build an initial polynomial approximation for constrained parametric curves.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of curve dimensions \( d \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Polynomial degree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Left endpoint </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Right endpoint </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib</td><td>Number of derivative conditions at \( a \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">db</td><td>Derivative values at \( a \), length <code>nb</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nb</td><td>Length of <code>db</code> ( \( = d \cdot i_b \)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ie</td><td>Number of derivative conditions at \( b \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">de</td><td>Derivative values at \( b \), length <code>ne</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ne</td><td>Length of <code>de</code> ( \( = d \cdot i_e \)) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cp</td><td>B-spline coefficients of the polynomial, length <code>np</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">np</td><td>Length of <code>cp</code> ( \( = d \cdot (k+1) \))</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 7, 7.1 (pp. 115-120) </dd></dl>

</div>
</div>
<a id="a3a3d9c76b5b016414056f18b807aa39f" name="a3a3d9c76b5b016414056f18b807aa39f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a3d9c76b5b016414056f18b807aa39f">&#9670;&#160;</a></span>fppogr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fppogr </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(3), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ider</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mz), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nvest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpold</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>reducu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>reducv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpintu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpintv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(3), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>dz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>lastdi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nplusu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nplusv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>lasttu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nru</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdatu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdatv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Driver for polar grid smoothing spline with knot selection. </p>
<p>Outer iteration loop for fitting a smoothing spline on a polar grid. Manages the knot-selection strategy (adding knots in the radial or angular direction based on residuals) and the smoothing-parameter search, delegating the actual grid computation to fpopdi at each step.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Fitting options (3 flags) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ider</td><td>Derivative specification flags </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Radial grid, length <code>mu</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>Number of radial points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Angular grid, length <code>mv</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mv</td><td>Number of angular points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values, length <code>mz</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mz</td><td>Length of <code>z</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z0</td><td>Origin value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Boundary function values, length <code>mv</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nuest</td><td>Max radial knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nvest</td><td>Max angular knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Smoothing condition tolerance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of coefficient array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nu</td><td>Number of radial knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tu</td><td>Radial knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nv</td><td>Number of angular knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tv</td><td>Angular knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp0</td><td>Initial residual </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpold</td><td>Previous residual </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">reducu</td><td>Residual reduction in radial direction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">reducv</td><td>Residual reduction in angular direction </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpintu</td><td>Residual sums per radial interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpintv</td><td>Residual sums per angular interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dz</td><td>Boundary derivative parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step</td><td>Search step for boundary optimization </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lastdi</td><td>Last direction of knot addition </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nplusu</td><td>Number of radial knots to add </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nplusv</td><td>Number of angular knots to add </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lasttu</td><td>Last radial knot change flag </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nru</td><td>Radial knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrv</td><td>Angular knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdatu</td><td>Interior data counts per radial interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdatv</td><td>Interior data counts per angular interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Work array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Length of <code>wrk</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.1 (pp. 197-205) </dd>
<dd>
<a class="el" href="#a07a9d1d759c2a6d39e91039f904c923b" title="Compute smoothing spline on a polar grid with origin constraints.">fpopdi</a>  grid computation; <a class="el" href="#ac854d9583be2e3e162a00fd43dc20314" title="Core algorithm for spline fitting on a polar domain.">fppola</a>  scattered <a class="el" href="#a406065ef7b15f1380c2759e9650355f2" title="Fit a smooth bivariate spline to scattered data on a polar domain.">polar</a> fitting </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a3a3d9c76b5b016414056f18b807aa39f_cgraph.png" border="0" usemap="#anamespacefitpack__core_a3a3d9c76b5b016414056f18b807aa39f_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a3a3d9c76b5b016414056f18b807aa39f_cgraph" id="anamespacefitpack__core_a3a3d9c76b5b016414056f18b807aa39f_cgraph">
<area shape="rect" title="Driver for polar grid smoothing spline with knot selection." alt="" coords="5,291,156,317"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="215,213,365,238"/>
<area shape="poly" title=" " alt="" coords="107,289,203,247,225,240,227,245,205,252,109,294"/>
<area shape="rect" href="namespacefitpack__core.html#a07a9d1d759c2a6d39e91039f904c923b" title="Compute smoothing spline on a polar grid with origin constraints." alt="" coords="215,262,365,287"/>
<area shape="poly" title=" " alt="" coords="156,291,201,284,201,290,156,296"/>
<area shape="rect" href="namespacefitpack__core.html#a8c4fa92fbc6556a21d112fbdfbd0f80f" title=" " alt="" coords="204,312,376,352"/>
<area shape="poly" title=" " alt="" coords="156,311,191,316,190,321,156,317"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="223,376,357,416"/>
<area shape="poly" title=" " alt="" coords="108,314,205,362,222,369,220,373,203,366,105,319"/>
<area shape="rect" href="namespacefitpack__core.html#a03d606165767f7703429cb55181efe11" title="Compute spline coefficients on a polar/spherical grid via Kronecker product." alt="" coords="427,287,573,313"/>
<area shape="poly" title=" " alt="" coords="366,281,413,287,413,292,365,286"/>
<area shape="rect" href="namespacefitpack__core.html#a0055c06b11885b09b3da8a5b9b24d0bb" title="Solve a small symmetric linear system by Cholesky factorization." alt="" coords="424,238,576,263"/>
<area shape="poly" title=" " alt="" coords="365,263,410,258,411,264,366,269"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="629,5,787,45"/>
<area shape="poly" title=" " alt="" coords="558,285,574,273,592,246,600,220,601,193,598,167,595,140,596,112,604,84,622,56,625,52,629,56,626,59,609,86,601,113,601,140,603,166,606,193,605,221,597,248,578,276,561,289"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="624,197,792,237"/>
<area shape="poly" title=" " alt="" coords="542,285,575,272,623,247,639,240,641,245,625,252,577,277,544,290"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="624,69,792,109"/>
<area shape="poly" title=" " alt="" coords="557,285,574,273,588,254,595,236,598,198,600,160,608,140,622,120,626,116,630,120,626,123,612,142,606,161,603,199,600,237,593,257,578,277,560,289"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="624,133,792,173"/>
<area shape="poly" title=" " alt="" coords="554,285,574,273,591,251,598,229,605,207,622,183,628,179,631,183,626,187,609,209,603,231,596,254,578,277,557,289"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="631,311,785,337"/>
<area shape="poly" title=" " alt="" coords="574,306,618,311,617,316,573,311"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="631,361,785,386"/>
<area shape="poly" title=" " alt="" coords="532,310,625,347,648,354,646,359,623,352,530,315"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="633,262,783,287"/>
<area shape="poly" title=" " alt="" coords="573,288,620,283,620,288,574,294"/>
<area shape="rect" href="namespacefitpack__core.html#a95f95a1ab846dcf0b4035058fdde4bad" title="LU&#45;decompose a cyclic tridiagonal matrix." alt="" coords="633,410,783,435"/>
<area shape="poly" title=" " alt="" coords="516,311,561,353,592,376,625,396,640,403,637,408,623,401,589,380,558,357,512,315"/>
<area shape="rect" href="namespacefitpack__core.html#a3781580dd8295b2e2a32266fd0fcf027" title="Solve a cyclic tridiagonal system using LU factors from fpcyt1." alt="" coords="633,459,783,485"/>
<area shape="poly" title=" " alt="" coords="518,311,547,337,578,370,592,392,600,411,609,429,626,446,633,451,630,455,622,450,604,432,595,414,587,395,574,374,544,341,515,315"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="634,509,782,534"/>
<area shape="poly" title=" " alt="" coords="521,311,550,337,578,371,594,406,599,438,605,467,613,481,626,495,631,500,628,504,622,499,609,484,600,469,593,439,589,408,574,373,546,341,517,315"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="1061,202,1207,227"/>
<area shape="poly" title=" " alt="" coords="792,214,1048,213,1048,218,792,219"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="852,77,1001,102"/>
<area shape="poly" title=" " alt="" coords="772,195,790,183,806,166,813,148,821,129,838,111,847,106,849,110,842,115,826,132,818,150,810,169,794,187,775,199"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="853,126,1001,151"/>
<area shape="poly" title=" " alt="" coords="763,195,876,154,878,159,765,200"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="840,302,1013,327"/>
<area shape="poly" title=" " alt="" coords="764,235,793,247,890,293,888,298,791,252,762,240"/>
<area shape="poly" title=" " alt="" coords="1100,204,1093,194,1097,184,1111,178,1134,175,1163,179,1174,188,1171,192,1160,184,1134,181,1112,183,1101,187,1098,193,1104,200"/>
<area shape="poly" title=" " alt="" coords="953,299,1093,231,1095,236,956,304"/>
<area shape="poly" title=" " alt="" coords="893,304,886,294,889,284,903,278,927,275,955,279,967,288,963,292,953,284,927,281,905,283,893,287,891,293,897,300"/>
<area shape="poly" title=" " alt="" coords="762,67,816,52,881,42,949,43,983,50,1015,62,1052,88,1083,122,1107,157,1124,188,1119,191,1103,160,1079,125,1049,92,1012,66,981,55,949,48,881,47,817,57,763,72"/>
<area shape="poly" title=" " alt="" coords="792,87,838,87,838,92,792,92"/>
<area shape="poly" title=" " alt="" coords="793,106,857,120,856,126,792,111"/>
<area shape="poly" title=" " alt="" coords="793,163,1048,200,1047,205,792,168"/>
<area shape="poly" title=" " alt="" coords="773,131,839,111,865,103,867,108,841,116,774,136"/>
<area shape="poly" title=" " alt="" coords="792,145,839,142,839,147,792,150"/>
<area shape="poly" title=" " alt="" coords="779,285,844,297,843,302,778,290"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="428,383,572,409"/>
<area shape="poly" title=" " alt="" coords="358,393,414,393,414,399,358,399"/>
</map>
</div>

</div>
</div>
<a id="ac854d9583be2e3e162a00fd43dc20314" name="ac854d9583be2e3e162a00fd43dc20314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac854d9583be2e3e162a00fd43dc20314">&#9670;&#160;</a></span>fppola()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fppola </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(<a class="el" href="interfacefitpack__core_1_1fitpack__polar__boundary.html">fitpack_polar_boundary</a>)</td>          <td class="paramname"><span class="paramname"><em>rad</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nvest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ib1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ib3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ncc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>intest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nrest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>sup</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(intest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(intest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>coord</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ncc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>row</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(5,nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cosi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ncc,ib1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ncc,ib3), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ib3), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nrest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nummer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core algorithm for spline fitting on a polar domain. </p>
<p>Fits a smooth bivariate spline to data on a polar-like domain \( D = \{(x,y) : x^2 + y^2 \leq r(\theta)^2\} \) by transforming to coordinates \( (u, v) \) where \( u = r/r(\theta) \) (radial) and \( v = \theta \) (angular). The boundary function \( r(\theta) \) is user-supplied.</p>
<p>Continuity at the origin ( \( u = 0 \)) imposes constraints on the B-spline coefficients (Eq. 11.3-11.5):</p>
<ul>
<li>\( s(0, v) \) must be independent of \( v \)</li>
<li>Derivatives at the origin must satisfy symmetry conditions</li>
</ul>
<p>The algorithm uses the same iterative scheme as fpsurf (knot placement, QR factorization with rank-deficiency handling, smoothing search) with additional logic for origin-continuity constraints and the periodic \( v \)-direction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt1</td><td>Fitting option (0 = new, 1 = continue) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt2</td><td>Origin BC option (0 = free, 1 = given) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt3</td><td>Derivative BC option at origin </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Radial coordinates, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Angular coordinates, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Data weights, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rad</td><td>Boundary function values at data angles </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nuest</td><td>Max radial knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nvest</td><td>Max angular knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eta</td><td>Rank-deficiency tolerance factor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Smoothing condition tolerance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib1</td><td>Bandwidth parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib3</td><td>Extended bandwidth parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of coefficient array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncc</td><td>Auxiliary coefficient dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">intest</td><td>Length of <code>fpint</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrest</td><td>Length of <code>index</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nu</td><td>Number of radial knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tu</td><td>Radial knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nv</td><td>Number of angular knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tv</td><td>Angular knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sup</td><td>Upper bound for residual </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpint</td><td>Work: residual sums per panel </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coord</td><td>Work: coordinates </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f</td><td>Work: RHS vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ff</td><td>Work: RHS copy </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">row</td><td>Work: observation row </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cs</td><td>Work: cosine values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cosi</td><td>Work: cosine integrals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Work: band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: extended band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bu</td><td>Work: radial discontinuity coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bv</td><td>Work: angular discontinuity coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spu</td><td>Work: radial B-spline values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spv</td><td>Work: angular B-spline values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h</td><td>Work vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">index</td><td>Work: panel sorting indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nummer</td><td>Work: data-to-panel mapping </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Work array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Length of <code>wrk</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.1 (pp. 197-205), Eq. 11.1-11.9 </dd>
<dd>
<a class="el" href="#a85e2e23efd601e9e1e28c0195664dd16" title="Convert constrained polar spline coefficients to standard form.">fprppo</a>  <a class="el" href="#a406065ef7b15f1380c2759e9650355f2" title="Fit a smooth bivariate spline to scattered data on a polar domain.">polar</a> representation; <a class="el" href="#a07a9d1d759c2a6d39e91039f904c923b" title="Compute smoothing spline on a polar grid with origin constraints.">fpopdi</a>  <a class="el" href="#a406065ef7b15f1380c2759e9650355f2" title="Fit a smooth bivariate spline to scattered data on a polar domain.">polar</a> derivatives </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ac854d9583be2e3e162a00fd43dc20314_cgraph.png" border="0" usemap="#anamespacefitpack__core_ac854d9583be2e3e162a00fd43dc20314_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ac854d9583be2e3e162a00fd43dc20314_cgraph" id="anamespacefitpack__core_ac854d9583be2e3e162a00fd43dc20314_cgraph">
<area shape="rect" title="Core algorithm for spline fitting on a polar domain." alt="" coords="5,316,156,341"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="672,208,817,233"/>
<area shape="poly" title=" " alt="" coords="121,339,161,350,204,358,324,375,420,383,465,380,512,371,564,355,623,330,654,312,682,289,724,242,728,246,685,293,657,316,625,335,566,360,514,377,466,385,420,388,324,380,204,363,160,355,120,344"/>
<area shape="rect" href="namespacefitpack__core.html#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="204,208,403,233"/>
<area shape="poly" title=" " alt="" coords="98,314,144,283,203,250,242,235,244,240,205,255,147,287,101,318"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="463,157,612,183"/>
<area shape="poly" title=" " alt="" coords="87,314,104,288,130,254,163,220,203,193,264,171,329,159,392,155,449,157,449,162,392,161,329,165,265,176,205,198,166,224,134,257,108,291,91,317"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="463,259,611,284"/>
<area shape="poly" title=" " alt="" coords="122,313,204,294,332,278,449,271,450,276,333,284,204,299,123,319"/>
<area shape="rect" href="namespacefitpack__core.html#aa452051613d61831a99b2f9ef8e21bc8" title="Rotate a smoothing&#45;matrix row into a band matrix using shifted pivots." alt="" coords="219,309,387,349"/>
<area shape="poly" title=" " alt="" coords="156,326,206,326,206,331,156,331"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="227,424,380,449"/>
<area shape="poly" title=" " alt="" coords="101,339,147,370,205,402,244,417,242,422,203,407,144,375,98,344"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="229,5,378,31"/>
<area shape="poly" title=" " alt="" coords="81,315,91,266,112,194,128,155,148,116,173,80,202,48,223,34,226,39,206,52,177,83,153,119,133,157,117,196,96,267,86,317"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="451,56,624,81"/>
<area shape="poly" title=" " alt="" coords="82,315,92,270,114,209,130,176,150,144,174,115,202,92,232,75,264,63,331,50,397,47,456,52,456,57,397,53,331,55,265,68,234,80,206,96,178,119,154,147,135,178,119,211,97,272,87,316"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="229,473,377,499"/>
<area shape="poly" title=" " alt="" coords="92,340,136,397,168,430,205,458,221,466,218,471,203,463,165,434,132,401,88,343"/>
<area shape="rect" href="namespacefitpack__core.html#a000e6860b30d66fcc8bf487d934c0f28" title="Sort scattered data points into rectangular panels." alt="" coords="228,523,379,548"/>
<area shape="poly" title=" " alt="" coords="89,340,104,374,129,420,163,468,183,489,206,508,217,515,214,519,202,512,179,493,159,471,124,423,99,377,84,343"/>
<area shape="rect" href="namespacefitpack__core.html#ab08555e9bd2f44d1461e09ba35a7bb22" title="Compute the minimum&#45;norm least&#45;squares solution under rank deficiency." alt="" coords="228,107,379,132"/>
<area shape="poly" title=" " alt="" coords="85,315,100,282,126,237,160,190,202,149,228,135,231,139,206,153,164,194,130,240,105,284,90,317"/>
<area shape="rect" href="namespacefitpack__core.html#a85e2e23efd601e9e1e28c0195664dd16" title="Convert constrained polar spline coefficients to standard form." alt="" coords="228,572,379,597"/>
<area shape="poly" title=" " alt="" coords="87,341,99,383,122,442,157,504,180,533,206,557,217,565,214,569,202,561,176,536,153,507,117,444,94,385,82,342"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="236,622,371,662"/>
<area shape="poly" title=" " alt="" coords="86,341,96,390,117,462,133,502,153,540,177,576,206,608,225,621,222,626,202,612,173,580,148,543,128,504,112,464,91,392,81,342"/>
<area shape="poly" title=" " alt="" coords="711,210,704,200,707,190,721,184,745,181,773,185,785,194,781,198,771,190,745,187,723,189,711,193,709,199,715,206"/>
<area shape="poly" title=" " alt="" coords="403,218,658,218,658,223,403,223"/>
<area shape="poly" title=" " alt="" coords="362,205,464,183,465,188,364,210"/>
<area shape="poly" title=" " alt="" coords="364,231,465,253,464,258,362,236"/>
<area shape="poly" title=" " alt="" coords="387,328,501,320,563,309,623,293,674,268,716,240,719,244,676,273,625,298,564,314,502,325,388,333"/>
<area shape="poly" title=" " alt="" coords="332,306,504,189,507,193,335,311"/>
<area shape="poly" title=" " alt="" coords="385,306,471,285,472,290,386,311"/>
<area shape="poly" title=" " alt="" coords="364,28,465,50,464,56,362,33"/>
<area shape="poly" title=" " alt="" coords="585,79,625,98,656,121,684,147,727,195,723,199,680,151,652,125,623,103,582,84"/>
<area shape="poly" title=" " alt="" coords="504,58,496,48,500,38,514,32,537,29,566,33,577,42,574,46,564,38,537,35,515,37,504,41,502,47,508,54"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="458,515,617,555"/>
<area shape="poly" title=" " alt="" coords="379,533,444,533,444,538,379,538"/>
<area shape="poly" title=" " alt="" coords="379,113,496,117,561,126,625,142,677,167,720,197,716,201,674,172,623,147,560,131,496,122,379,118"/>
<area shape="poly" title=" " alt="" coords="364,130,465,152,464,157,362,135"/>
<area shape="poly" title=" " alt="" coords="325,130,506,249,503,253,323,134"/>
<area shape="poly" title=" " alt="" coords="362,104,464,82,465,87,364,109"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="465,629,609,655"/>
<area shape="poly" title=" " alt="" coords="371,639,452,639,452,645,371,645"/>
</map>
</div>

</div>
</div>
<a id="ab08555e9bd2f44d1461e09ba35a7bb22" name="ab08555e9bd2f44d1461e09ba35a7bb22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab08555e9bd2f44d1461e09ba35a7bb22">&#9670;&#160;</a></span>fprank()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fprank </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(na,m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(out)</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>na</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(out)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>sq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>rank</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n,m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>aa</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the minimum-norm least-squares solution under rank deficiency. </p>
<p>When the QR-triangularized observation matrix \( R \) has rank \( r &lt; n \) (detected by near-zero diagonal elements \( |R_{ii}| &lt; \varepsilon \)), the least-squares solution is not unique. This routine computes the <b>minimum-norm</b> B-spline coefficient vector \( \tilde{c} \) by factoring the reduced upper trapezoidal matrix  \( W = [W_1 \ 
W_2] \) (Eq. 9.9): </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ab08555e9bd2f44d1461e09ba35a7bb22_cgraph.png" border="0" usemap="#anamespacefitpack__core_ab08555e9bd2f44d1461e09ba35a7bb22_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ab08555e9bd2f44d1461e09ba35a7bb22_cgraph" id="anamespacefitpack__core_ab08555e9bd2f44d1461e09ba35a7bb22_cgraph">
<area shape="rect" title="Compute the minimum&#45;norm least&#45;squares solution under rank deficiency." alt="" coords="5,56,156,81"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="425,67,571,92"/>
<area shape="poly" title=" " alt="" coords="104,53,149,32,203,15,252,6,291,3,330,6,378,15,427,34,468,57,466,61,425,38,377,21,329,11,291,8,253,12,205,21,151,37,106,58"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="216,31,365,56"/>
<area shape="poly" title=" " alt="" coords="156,57,202,51,203,57,157,62"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="217,80,365,105"/>
<area shape="poly" title=" " alt="" coords="157,75,203,80,203,85,156,80"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="204,153,377,179"/>
<area shape="poly" title=" " alt="" coords="110,79,251,145,249,150,108,84"/>
<area shape="poly" title=" " alt="" coords="464,68,457,58,461,48,475,42,498,40,527,44,538,53,535,57,524,49,498,45,476,47,465,52,462,58,468,65"/>
<area shape="poly" title=" " alt="" coords="321,151,453,95,455,100,323,156"/>
<area shape="poly" title=" " alt="" coords="257,155,250,145,253,135,267,129,291,127,319,130,331,139,327,144,317,135,291,132,269,134,257,139,255,144,261,152"/>
</map>
</div>

</div>
</div>
<a id="aefb269f6c2a494ba69c10e93334def66" name="aefb269f6c2a494ba69c10e93334def66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefb269f6c2a494ba69c10e93334def66">&#9670;&#160;</a></span>fprati()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental subroutine fitpack_core::fprati </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>p1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>f1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>p2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>f2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>p3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>f3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>p</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rational interpolation for the smoothing parameter search. </p>
<p>Given three points \( (p_1, F_1) \), \( (p_2, F_2) \), \( (p_3, F_3) \) on the curve \( F(p) \), computes the zero of the rational interpolant:</p>
<p class="formulaDsp">
\[              R(p) = \frac{u \, p + v}{p + w}
              \tag{5.30}
\]
</p>
<p>that passes through the three points. The zero \( \tilde{p} \) gives the next estimate of the smoothing parameter \( p \) satisfying \( F(p) = S \) during the iterative knot-placement strategy.</p>
<p>When \( p_3 = \infty \) (indicated by <code>p3 &lt;= 0</code>), the formula simplifies to:</p>
<p class="formulaDsp">
\[              \tilde{p} = \frac{p_1 (F_1 - F_3)(F_2 - S) - p_2 (F_2 - F_3)(F_1 - S)}
                               {(F_1 - F_2)(F_3 - S)}
              \tag{5.31}
\]
</p>
<p>On exit, \( (p_1, F_1) \) and \( (p_3, F_3) \) are updated to bracket the root: \( F_1 &gt; 0 \) and \( F_3 &lt; 0 \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p1</td><td>First abscissa; updated to maintain \( F_1 &gt; 0 \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f1</td><td>First ordinate; updated with \( p_1 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p2</td><td>Second abscissa (most recent iterate) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f2</td><td>Second ordinate \( F(p_2) - S \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p3</td><td>Third abscissa; \( p_3 \leq 0 \) means \( p_3 = \infty \). Updated to maintain \( F_3 &lt; 0 \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f3</td><td>Third ordinate; updated with \( p_3 \) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p</td><td>The new estimate \( \tilde{p} \)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 5, 5.2.4 (pp. 83-86), Eq. 5.30-5.32 </dd></dl>

</div>
</div>
<a id="a26879f854f0e23671e8fd07f9f144410" name="a26879f854f0e23671e8fd07f9f144410"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26879f854f0e23671e8fd07f9f144410">&#9670;&#160;</a></span>fpregr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpregr </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(my), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>my</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mz), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mz</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xe</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>yb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ye</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nxest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nyest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nxest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nyest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpold</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>reducx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>reducy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nxest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpintx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nyest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpinty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>lastdi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nplusx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nplusy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mx), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(my), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nry</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nxest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdatx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nyest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdaty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Driver for rectangular grid smoothing surface with knot selection. </p>
<p>Outer iteration loop for fitting a smoothing spline surface on a rectangular grid \( \{x_i\} \times \{y_j\} \). Manages the knot selection strategy (alternating between \( x \) and \( y \) directions based on residuals) and the smoothing-parameter search, delegating the grid computation to fpgrre at each step.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>0 = new fit, 1 = continue </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>\( x \)-grid values, length <code>mx</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Number of \( x \)-grid points </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">y</td><td>\( y \)-grid values, length <code>my</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">my</td><td>Number of \( y \)-grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values, length <code>mz</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mz</td><td>Length of <code>z</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xb</td><td>Left \( x \)-boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xe</td><td>Right \( x \)-boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yb</td><td>Lower \( y \)-boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>Upper \( y \)-boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Degree in \( x \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Degree in \( y \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nxest</td><td>Max \( x \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nyest</td><td>Max \( y \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Smoothing condition tolerance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of coefficient array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nx</td><td>Number of \( x \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tx</td><td>\( x \)-knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ny</td><td>Number of \( y \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ty</td><td>\( y \)-knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp0</td><td>Initial residual </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpold</td><td>Previous residual </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">reducx</td><td>Residual reduction in \( x \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">reducy</td><td>Residual reduction in \( y \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpintx</td><td>Residual sums per \( x \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpinty</td><td>Residual sums per \( y \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lastdi</td><td>Last direction of knot addition </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nplusx</td><td>Number of \( x \)-knots to add </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nplusy</td><td>Number of \( y \)-knots to add </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrx</td><td>\( x \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nry</td><td>\( y \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdatx</td><td>Interior data counts per \( x \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdaty</td><td>Interior data counts per \( y \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Work array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Length of <code>wrk</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 10, 10.2 (pp. 170-172), Eq. 10.4-10.8 </dd>
<dd>
<a class="el" href="#a78b0d9c28e76eff73dcf956f4811c257" title="Compute grid-based spline coefficients via Kronecker product decomposition.">fpgrre</a>  grid Kronecker product computation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a26879f854f0e23671e8fd07f9f144410_cgraph.png" border="0" usemap="#anamespacefitpack__core_a26879f854f0e23671e8fd07f9f144410_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a26879f854f0e23671e8fd07f9f144410_cgraph" id="anamespacefitpack__core_a26879f854f0e23671e8fd07f9f144410_cgraph">
<area shape="rect" title="Driver for rectangular grid smoothing surface with knot selection." alt="" coords="5,198,153,223"/>
<area shape="rect" href="namespacefitpack__core.html#a78b0d9c28e76eff73dcf956f4811c257" title="Compute grid&#45;based spline coefficients via Kronecker product decomposition." alt="" coords="213,119,361,145"/>
<area shape="poly" title=" " alt="" coords="105,195,200,154,222,146,224,151,202,158,107,200"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="212,169,363,194"/>
<area shape="poly" title=" " alt="" coords="153,198,198,191,199,196,154,203"/>
<area shape="rect" href="namespacefitpack__core.html#a8c4fa92fbc6556a21d112fbdfbd0f80f" title=" " alt="" coords="201,219,373,259"/>
<area shape="poly" title=" " alt="" coords="154,218,188,223,187,228,153,223"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="220,283,355,323"/>
<area shape="poly" title=" " alt="" coords="106,221,202,268,219,275,217,280,200,273,103,226"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="421,169,589,209"/>
<area shape="poly" title=" " alt="" coords="337,142,416,163,415,168,336,147"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="421,5,589,45"/>
<area shape="poly" title=" " alt="" coords="308,117,358,87,420,55,435,48,437,53,422,60,361,92,311,121"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="429,70,582,95"/>
<area shape="poly" title=" " alt="" coords="344,117,435,96,436,101,345,122"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="431,235,580,261"/>
<area shape="poly" title=" " alt="" coords="353,142,375,154,391,170,400,187,408,204,423,219,437,227,434,232,420,223,403,207,395,190,387,173,372,158,351,147"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="431,119,579,145"/>
<area shape="poly" title=" " alt="" coords="362,129,418,129,418,135,362,135"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="859,163,1004,189"/>
<area shape="poly" title=" " alt="" coords="590,184,845,176,845,181,590,189"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="649,63,799,89"/>
<area shape="poly" title=" " alt="" coords="565,167,588,154,602,140,611,126,620,112,636,98,647,92,650,96,639,102,624,115,615,129,606,143,591,158,568,171"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="650,113,798,138"/>
<area shape="poly" title=" " alt="" coords="574,167,666,139,667,144,575,172"/>
<area shape="poly" title=" " alt="" coords="898,165,890,155,894,145,908,139,931,137,960,140,971,149,968,154,958,145,931,142,909,144,898,149,896,154,902,162"/>
<area shape="poly" title=" " alt="" coords="589,14,641,13,698,18,757,28,812,48,846,70,875,97,917,150,913,153,871,100,842,74,809,53,755,34,698,23,641,19,590,19"/>
<area shape="poly" title=" " alt="" coords="590,42,656,58,654,63,589,47"/>
<area shape="poly" title=" " alt="" coords="567,43,591,55,605,66,615,77,625,88,639,98,655,105,653,110,636,102,621,92,611,81,602,70,588,60,565,48"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="637,238,811,263"/>
<area shape="poly" title=" " alt="" coords="580,246,623,247,623,252,580,252"/>
<area shape="poly" title=" " alt="" coords="760,235,882,191,884,196,761,240"/>
<area shape="poly" title=" " alt="" coords="690,240,683,230,687,220,701,214,724,211,753,215,764,224,761,228,750,220,724,217,702,219,691,223,688,229,694,236"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="433,290,577,315"/>
<area shape="poly" title=" " alt="" coords="355,300,419,300,419,305,355,305"/>
</map>
</div>

</div>
</div>
<a id="a3804afa034c5c78f99a71f867d53de7c" name="a3804afa034c5c78f99a71f867d53de7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3804afa034c5c78f99a71f867d53de7c">&#9670;&#160;</a></span>fprota()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental subroutine fitpack_core::fprota </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>cos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Apply a Givens plane rotation to two scalars. </p>
<p>Given the cosine \( c \) and sine \( s \) of a Givens rotation (as computed by fpgivs), transforms a pair of values \( (a, b) \):</p>
<p class="formulaDsp">
\[              a&#39; = c \, a - s \, b, \qquad
              b&#39; = s \, a + c \, b
              \tag{4.15}
\]
</p>
<p>This is used to propagate each Givens rotation through the remaining columns of the observation matrix and the right-hand side vector during QR factorization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cos</td><td>Cosine of the rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sin</td><td>Sine of the rotation angle </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>First element; replaced by \( c \, a - s \, b \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">b</td><td>Second element; replaced by \( s \, a + c \, b \)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 4, 4.1.2 (pp. 55-58), Eq. 4.15 </dd></dl>

</div>
</div>
<a id="a85e2e23efd601e9e1e28c0195664dd16" name="a85e2e23efd601e9e1e28c0195664dd16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85e2e23efd601e9e1e28c0195664dd16">&#9670;&#160;</a></span>fprppo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fprppo </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>if1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>if2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(5,nv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>cosi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ratio</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ncoff), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ncoff), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ncoff</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert constrained polar spline coefficients to standard form. </p>
<p>Transforms the coefficients of a constrained bicubic spline (as computed by fppola with origin-continuity constraints) into the standard B-spline coefficient representation. The constrained form encodes the origin conditions via cosine-weighted combinations; this routine expands them into independent coefficients.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Number of radial knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nv</td><td>Number of angular knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">if1</td><td>Origin constraint type (position) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">if2</td><td>Origin constraint type (derivative) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cosi</td><td>Cosine integral values </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ratio</td><td>Knot ratio for origin constraint </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>Constrained coefficients on entry; work on exit </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f</td><td>Standard B-spline coefficients on exit </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncoff</td><td>Number of coefficients</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.1 (pp. 197-205), Eq. 11.3-11.5 </dd>
<dd>
<a class="el" href="#ac854d9583be2e3e162a00fd43dc20314" title="Core algorithm for spline fitting on a polar domain.">fppola</a>  <a class="el" href="#a406065ef7b15f1380c2759e9650355f2" title="Fit a smooth bivariate spline to scattered data on a polar domain.">polar</a> fitting; <a class="el" href="#a4bd769a20c06ac85da1866ea8ac3e98c" title="Convert constrained spherical spline coefficients to standard form.">fprpsp</a>  spherical variant </dd></dl>

</div>
</div>
<a id="a4bd769a20c06ac85da1866ea8ac3e98c" name="a4bd769a20c06ac85da1866ea8ac3e98c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bd769a20c06ac85da1866ea8ac3e98c">&#9670;&#160;</a></span>fprpsp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fprpsp </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>np</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(np), intent(in)</td>          <td class="paramname"><span class="paramname"><em>co</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(np), intent(in)</td>          <td class="paramname"><span class="paramname"><em>si</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ncoff), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ncoff), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ncoff</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert constrained spherical spline coefficients to standard form. </p>
<p>Transforms the coefficients of a constrained bicubic spline (as computed by fpsphe with pole-continuity constraints) into the standard B-spline coefficient representation. The constrained form encodes pole conditions via cosine/sine-weighted combinations at \( \theta = 0 \) and \( \theta = \pi \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nt</td><td>Number of \( \theta \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">np</td><td>Number of \( \phi \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">co</td><td>Cosine values for pole constraints </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">si</td><td>Sine values for pole constraints </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>Constrained coefficients on entry; work on exit </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f</td><td>Standard B-spline coefficients on exit </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncoff</td><td>Number of coefficients</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.2 (pp. 205-213), Eq. 11.14-11.16 </dd>
<dd>
<a class="el" href="#a6b16cd0ae09d295a9bdf3723c10db8e7" title="Core algorithm for spline fitting on the sphere.">fpsphe</a>  spherical fitting; <a class="el" href="#a85e2e23efd601e9e1e28c0195664dd16" title="Convert constrained polar spline coefficients to standard form.">fprppo</a>  <a class="el" href="#a406065ef7b15f1380c2759e9650355f2" title="Fit a smooth bivariate spline to scattered data on a polar domain.">polar</a> variant </dd></dl>

</div>
</div>
<a id="a535f9e04981c794c70a60f728e918472" name="a535f9e04981c794c70a60f728e918472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a535f9e04981c794c70a60f728e918472">&#9670;&#160;</a></span>fpseno()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpseno </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxtr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(in)</td>          <td class="paramname"><span class="paramname"><em>up</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(in)</td>          <td class="paramname"><span class="paramname"><em>left</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(in)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(maxtr), intent(in)</td>          <td class="paramname"><span class="paramname"><em>info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>merk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nbind), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ibind</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nbind</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fetch and advance to the next branch in the constraint-set tree. </p>
<p>Extracts the constraint indices of the branch ending at terminal node <code>merk</code> (length <code>nbind</code>) into the array <code>ibind(1:nbind)</code>. Then advances <code>merk</code> to point to the next branch of the same length, or sets <code>merk = 1</code> if no further branch exists.</p>
<p>Used by the Theil-Van de Panne procedure (7.2) to enumerate candidate active-constraint sets level by level.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">maxtr</td><td>Size of the tree arrays </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">up</td><td>Parent pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">left</td><td>Left-child pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">right</td><td>Right-child pointers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>Constraint index stored at each node </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">merk</td><td>On entry, terminal node of the branch to fetch. On exit, terminal node of the next branch of length <code>nbind</code>, or 1 if none. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ibind</td><td>Constraint indices of the fetched branch, length <code>nbind</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nbind</td><td>Required branch length</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 7, 7.2.4 (pp. 125-130) </dd>
<dd>
<a class="el" href="#a9bcbf8cf99bfb2ac2f3834891c731be7" title="Add a branch to the constraint-set binary tree.">fpadno</a>, <a class="el" href="#ad5d82ac791ec6ae19e9b4671ffb734e0" title="Prune short branches from the constraint-set binary tree.">fpdeno</a>, <a class="el" href="#a8006d449287383c5f5c4151086e9a376" title="Collect free nodes from the constraint-set binary tree.">fpfrno</a>  companion tree operations </dd></dl>

</div>
</div>
<a id="ae2fd0d6545f3ff0cc2019428c3d5ad38" name="ae2fd0d6545f3ff0cc2019428c3d5ad38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2fd0d6545f3ff0cc2019428c3d5ad38">&#9670;&#160;</a></span>fpspgr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpspgr </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(3), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(4), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ider</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mr), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nvest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpold</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>reducu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>reducv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpintu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpintv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(6), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>dr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>step</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>lastdi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nplusu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nplusv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>lastu0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>lastu1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mu), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nru</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mv), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdatu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nrdatv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Driver for spherical grid smoothing spline with knot selection. </p>
<p>Outer iteration loop for fitting a smoothing spline on a spherical grid. Manages knot selection in \( \theta \) and \( \phi \) directions and the smoothing-parameter search, delegating grid computation to fpopsp. Handles pole constraints at both \( \theta = 0 \) and \( \theta = \pi \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Fitting options </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ider</td><td>Derivative specification flags </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Co-latitude grid \( \theta \), length <code>mu</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>Number of \( \theta \)-points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Longitude grid \( \phi \), length <code>mv</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mv</td><td>Number of \( \phi \)-points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Data values, length <code>mr</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mr</td><td>Length of <code>r</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r0</td><td>North-pole value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r1</td><td>South-pole value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nuest</td><td>Max \( \theta \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nvest</td><td>Max \( \phi \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Smoothing condition tolerance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of coefficient array </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nu</td><td>Number of \( \theta \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tu</td><td>\( \theta \)-knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nv</td><td>Number of \( \phi \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tv</td><td>\( \phi \)-knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp0</td><td>Initial residual </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpold</td><td>Previous residual </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">reducu</td><td>Residual reduction in \( \theta \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">reducv</td><td>Residual reduction in \( \phi \) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpintu</td><td>Residual sums per \( \theta \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpintv</td><td>Residual sums per \( \phi \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dr</td><td>Pole derivative parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step</td><td>Search step for pole parameter optimization </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lastdi</td><td>Last direction of knot addition </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nplusu</td><td>Number of \( \theta \)-knots to add </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nplusv</td><td>Number of \( \phi \)-knots to add </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lastu0</td><td>Last north-pole knot change flag </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lastu1</td><td>Last south-pole knot change flag </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nru</td><td>\( \theta \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrv</td><td>\( \phi \)-knot interval indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdatu</td><td>Interior data counts per \( \theta \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nrdatv</td><td>Interior data counts per \( \phi \)-interval </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Work array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Length of <code>wrk</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.2 (pp. 205-213) </dd>
<dd>
<a class="el" href="#a383ad79ef10f0ff29a9122c3f736178e" title="Compute smoothing spline on a spherical grid with pole constraints.">fpopsp</a>  grid computation; <a class="el" href="#a6b16cd0ae09d295a9bdf3723c10db8e7" title="Core algorithm for spline fitting on the sphere.">fpsphe</a>  scattered spherical fitting </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ae2fd0d6545f3ff0cc2019428c3d5ad38_cgraph.png" border="0" usemap="#anamespacefitpack__core_ae2fd0d6545f3ff0cc2019428c3d5ad38_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ae2fd0d6545f3ff0cc2019428c3d5ad38_cgraph" id="anamespacefitpack__core_ae2fd0d6545f3ff0cc2019428c3d5ad38_cgraph">
<area shape="rect" title="Driver for spherical grid smoothing spline with knot selection." alt="" coords="5,291,156,317"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="215,213,365,238"/>
<area shape="poly" title=" " alt="" coords="107,289,203,247,225,240,227,245,205,252,109,294"/>
<area shape="rect" href="namespacefitpack__core.html#a383ad79ef10f0ff29a9122c3f736178e" title="Compute smoothing spline on a spherical grid with pole constraints." alt="" coords="213,262,367,287"/>
<area shape="poly" title=" " alt="" coords="156,291,199,285,200,290,156,296"/>
<area shape="rect" href="namespacefitpack__core.html#a8c4fa92fbc6556a21d112fbdfbd0f80f" title=" " alt="" coords="204,312,376,352"/>
<area shape="poly" title=" " alt="" coords="156,311,191,316,190,321,156,317"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="223,376,357,416"/>
<area shape="poly" title=" " alt="" coords="108,314,205,362,222,369,220,373,203,366,105,319"/>
<area shape="rect" href="namespacefitpack__core.html#a74a11f85ace5b032c95c53307fa47913" title="Compute spherical grid spline coefficients via Kronecker product." alt="" coords="425,287,575,313"/>
<area shape="poly" title=" " alt="" coords="367,281,411,287,411,292,366,287"/>
<area shape="rect" href="namespacefitpack__core.html#a0055c06b11885b09b3da8a5b9b24d0bb" title="Solve a small symmetric linear system by Cholesky factorization." alt="" coords="424,238,576,263"/>
<area shape="poly" title=" " alt="" coords="366,263,410,258,411,263,367,269"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="629,5,787,45"/>
<area shape="poly" title=" " alt="" coords="558,285,574,273,592,246,600,220,601,193,598,167,595,140,596,112,604,84,622,56,625,52,629,56,626,59,609,86,601,113,601,140,603,166,606,193,605,221,597,248,578,276,561,289"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="624,197,792,237"/>
<area shape="poly" title=" " alt="" coords="542,285,575,272,623,247,639,240,641,245,625,252,577,277,544,290"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="624,69,792,109"/>
<area shape="poly" title=" " alt="" coords="557,285,574,273,588,254,595,236,598,198,600,160,608,140,622,120,626,116,630,120,626,123,612,142,606,161,603,199,600,237,593,257,578,277,560,289"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="624,133,792,173"/>
<area shape="poly" title=" " alt="" coords="554,285,574,273,591,251,598,229,605,207,622,183,628,179,631,183,626,187,609,209,603,231,596,254,578,277,557,289"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="631,311,785,337"/>
<area shape="poly" title=" " alt="" coords="576,306,618,311,618,316,575,311"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="631,361,785,386"/>
<area shape="poly" title=" " alt="" coords="532,310,625,347,648,354,646,359,623,352,530,315"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="633,262,783,287"/>
<area shape="poly" title=" " alt="" coords="575,288,619,283,620,288,576,294"/>
<area shape="rect" href="namespacefitpack__core.html#a95f95a1ab846dcf0b4035058fdde4bad" title="LU&#45;decompose a cyclic tridiagonal matrix." alt="" coords="633,410,783,435"/>
<area shape="poly" title=" " alt="" coords="516,311,561,353,592,376,625,396,640,403,637,408,623,401,589,380,558,357,512,315"/>
<area shape="rect" href="namespacefitpack__core.html#a3781580dd8295b2e2a32266fd0fcf027" title="Solve a cyclic tridiagonal system using LU factors from fpcyt1." alt="" coords="633,459,783,485"/>
<area shape="poly" title=" " alt="" coords="518,311,547,337,578,370,592,392,600,411,609,429,626,446,633,451,630,455,622,450,604,432,595,414,587,395,574,374,544,341,515,315"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="634,509,782,534"/>
<area shape="poly" title=" " alt="" coords="521,311,550,337,578,371,594,406,599,438,605,467,613,481,626,495,631,500,628,504,622,499,609,484,600,469,593,439,589,408,574,373,546,341,517,315"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="1061,202,1207,227"/>
<area shape="poly" title=" " alt="" coords="792,214,1048,213,1048,218,792,219"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="852,77,1001,102"/>
<area shape="poly" title=" " alt="" coords="772,195,790,183,806,166,813,148,821,129,838,111,847,106,849,110,842,115,826,132,818,150,810,169,794,187,775,199"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="853,126,1001,151"/>
<area shape="poly" title=" " alt="" coords="763,195,876,154,878,159,765,200"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="840,302,1013,327"/>
<area shape="poly" title=" " alt="" coords="764,235,793,247,890,293,888,298,791,252,762,240"/>
<area shape="poly" title=" " alt="" coords="1100,204,1093,194,1097,184,1111,178,1134,175,1163,179,1174,188,1171,192,1160,184,1134,181,1112,183,1101,187,1098,193,1104,200"/>
<area shape="poly" title=" " alt="" coords="953,299,1093,231,1095,236,956,304"/>
<area shape="poly" title=" " alt="" coords="893,304,886,294,889,284,903,278,927,275,955,279,967,288,963,292,953,284,927,281,905,283,893,287,891,293,897,300"/>
<area shape="poly" title=" " alt="" coords="762,67,816,52,881,42,949,43,983,50,1015,62,1052,88,1083,122,1107,157,1124,188,1119,191,1103,160,1079,125,1049,92,1012,66,981,55,949,48,881,47,817,57,763,72"/>
<area shape="poly" title=" " alt="" coords="792,87,838,87,838,92,792,92"/>
<area shape="poly" title=" " alt="" coords="793,106,857,120,856,126,792,111"/>
<area shape="poly" title=" " alt="" coords="793,163,1048,200,1047,205,792,168"/>
<area shape="poly" title=" " alt="" coords="773,131,839,111,865,103,867,108,841,116,774,136"/>
<area shape="poly" title=" " alt="" coords="792,145,839,142,839,147,792,150"/>
<area shape="poly" title=" " alt="" coords="779,285,844,297,843,302,778,290"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="428,383,572,409"/>
<area shape="poly" title=" " alt="" coords="358,393,414,393,414,399,358,399"/>
</map>
</div>

</div>
</div>
<a id="a6b16cd0ae09d295a9bdf3723c10db8e7" name="a6b16cd0ae09d295a9bdf3723c10db8e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b16cd0ae09d295a9bdf3723c10db8e7">&#9670;&#160;</a></span>fpsphe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpsphe </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>teta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>phi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ntest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>npest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ib1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ib3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ncc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>intest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nrest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ntest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>np</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(npest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>sup</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(intest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(intest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>coord</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ncc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(npest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>row</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(npest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>coco</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(npest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>cosi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ncc,ib1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ncc,ib3), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ntest,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(npest,5), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,4), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ib3), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nrest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nummer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core algorithm for spline fitting on the sphere. </p>
<p>Fits a smooth bivariate spline to data on the unit sphere using coordinates \( (\theta, \phi) \) where \( \theta \in [0, \pi] \) is co-latitude and \( \phi \in [0, 2\pi) \) is longitude. The spline is periodic in \( \phi \) and must satisfy pole-continuity conditions at \( \theta = 0 \) and \( \theta = \pi \) (Eq. 11.12):</p>
<p class="formulaDsp">
\[              s(0, \phi) = \text{const}, \quad
              s(\pi, \phi) = \text{const}
              \tag{11.12}
\]
</p>
<p>with derivative conditions analogous to the polar case (Eq. 11.14-11.16). The algorithm follows the same iterative framework as fpsurf with additional handling for pole constraints and the periodic \( \phi \)-direction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>0 = new fit, 1 = continue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">teta</td><td>Co-latitude values \( \theta \), length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">phi</td><td>Longitude values \( \phi \), length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Data values, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Data weights, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntest</td><td>Max \( \theta \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npest</td><td>Max \( \phi \)-knots </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eta</td><td>Rank-deficiency tolerance factor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Smoothing condition tolerance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib1</td><td>Bandwidth parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib3</td><td>Extended bandwidth parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of coefficient array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ncc</td><td>Auxiliary coefficient dimension </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">intest</td><td>Length of <code>fpint</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrest</td><td>Length of <code>index</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nt</td><td>Number of \( \theta \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tt</td><td>\( \theta \)-knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">np</td><td>Number of \( \phi \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tp</td><td>\( \phi \)-knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sup</td><td>Upper bound for residual </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpint</td><td>Work: residual sums per panel </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coord</td><td>Work: coordinates </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f</td><td>Work: RHS vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ff</td><td>Work: RHS copy </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">row</td><td>Work: observation row </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coco</td><td>Work: cosine values for pole constraints </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cosi</td><td>Work: cosine integrals for pole constraints </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Work: band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: extended band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bt</td><td>Work: \( \theta \)-discontinuity coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bp</td><td>Work: \( \phi \)-discontinuity coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spt</td><td>Work: \( \theta \)-B-spline values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spp</td><td>Work: \( \phi \)-B-spline values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h</td><td>Work vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">index</td><td>Work: panel sorting indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nummer</td><td>Work: data-to-panel mapping </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Work array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Length of <code>wrk</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.2 (pp. 205-213), Eq. 11.12-11.16 </dd>
<dd>
<a class="el" href="#a4bd769a20c06ac85da1866ea8ac3e98c" title="Convert constrained spherical spline coefficients to standard form.">fprpsp</a>  spherical representation; <a class="el" href="#a383ad79ef10f0ff29a9122c3f736178e" title="Compute smoothing spline on a spherical grid with pole constraints.">fpopsp</a>  spherical operations </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a6b16cd0ae09d295a9bdf3723c10db8e7_cgraph.png" border="0" usemap="#anamespacefitpack__core_a6b16cd0ae09d295a9bdf3723c10db8e7_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a6b16cd0ae09d295a9bdf3723c10db8e7_cgraph" id="anamespacefitpack__core_a6b16cd0ae09d295a9bdf3723c10db8e7_cgraph">
<area shape="rect" title="Core algorithm for spline fitting on the sphere." alt="" coords="5,316,159,341"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="675,208,820,233"/>
<area shape="poly" title=" " alt="" coords="123,339,163,350,207,358,327,375,423,383,468,380,515,371,567,355,625,330,656,312,684,289,727,242,731,246,688,293,659,316,628,335,569,360,516,377,469,385,423,388,326,380,206,363,162,355,122,344"/>
<area shape="rect" href="namespacefitpack__core.html#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="207,208,405,233"/>
<area shape="poly" title=" " alt="" coords="99,314,146,283,206,250,244,235,246,240,208,255,149,287,102,318"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="465,157,615,183"/>
<area shape="poly" title=" " alt="" coords="88,314,105,288,132,254,165,220,205,193,267,171,331,159,395,156,452,157,451,162,395,161,332,165,268,176,208,198,169,224,136,257,110,291,93,317"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="466,259,614,284"/>
<area shape="poly" title=" " alt="" coords="124,313,206,294,335,278,452,271,452,276,335,284,207,299,125,319"/>
<area shape="rect" href="namespacefitpack__core.html#aa452051613d61831a99b2f9ef8e21bc8" title="Rotate a smoothing&#45;matrix row into a band matrix using shifted pivots." alt="" coords="222,309,390,349"/>
<area shape="poly" title=" " alt="" coords="159,326,208,326,208,331,159,331"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="229,424,383,449"/>
<area shape="poly" title=" " alt="" coords="102,339,149,370,208,402,246,417,244,422,206,407,146,375,99,344"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="231,5,381,31"/>
<area shape="poly" title=" " alt="" coords="83,315,93,266,114,194,130,155,151,116,175,80,205,48,225,34,228,39,208,52,179,83,155,119,135,157,119,196,98,267,88,317"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="453,56,627,81"/>
<area shape="poly" title=" " alt="" coords="83,315,94,270,116,209,132,176,152,144,176,115,205,92,235,75,266,63,333,50,399,47,458,52,458,57,399,53,334,55,268,69,237,80,208,96,180,119,156,147,137,178,121,211,99,272,88,316"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="232,473,380,499"/>
<area shape="poly" title=" " alt="" coords="94,340,138,397,170,430,208,458,223,466,221,471,205,463,167,434,134,401,89,343"/>
<area shape="rect" href="namespacefitpack__core.html#a000e6860b30d66fcc8bf487d934c0f28" title="Sort scattered data points into rectangular panels." alt="" coords="231,523,381,548"/>
<area shape="poly" title=" " alt="" coords="91,340,106,374,131,420,165,468,186,489,208,508,220,515,217,519,205,512,182,493,161,471,126,423,101,377,86,343"/>
<area shape="rect" href="namespacefitpack__core.html#ab08555e9bd2f44d1461e09ba35a7bb22" title="Compute the minimum&#45;norm least&#45;squares solution under rank deficiency." alt="" coords="231,107,381,132"/>
<area shape="poly" title=" " alt="" coords="86,315,102,282,128,237,162,190,205,149,231,135,234,139,208,153,166,194,132,240,107,284,91,317"/>
<area shape="rect" href="namespacefitpack__core.html#a4bd769a20c06ac85da1866ea8ac3e98c" title="Convert constrained spherical spline coefficients to standard form." alt="" coords="231,572,381,597"/>
<area shape="poly" title=" " alt="" coords="89,341,101,383,124,442,160,504,182,533,208,557,219,565,216,569,205,561,178,536,155,507,119,444,96,385,84,342"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="239,622,373,662"/>
<area shape="poly" title=" " alt="" coords="88,341,98,390,119,462,135,502,155,540,179,576,208,608,228,621,225,625,205,612,175,580,150,543,130,504,114,464,93,392,83,342"/>
<area shape="poly" title=" " alt="" coords="714,210,706,200,710,190,724,184,747,181,776,185,787,194,784,198,774,190,747,187,725,189,714,193,712,199,718,206"/>
<area shape="poly" title=" " alt="" coords="406,218,661,218,661,223,406,223"/>
<area shape="poly" title=" " alt="" coords="365,205,467,183,468,188,366,210"/>
<area shape="poly" title=" " alt="" coords="366,231,468,253,467,258,365,236"/>
<area shape="poly" title=" " alt="" coords="390,328,504,320,566,309,626,293,676,268,718,240,721,244,679,273,628,298,567,314,504,325,390,333"/>
<area shape="poly" title=" " alt="" coords="335,306,507,189,510,193,338,311"/>
<area shape="poly" title=" " alt="" coords="388,306,474,285,475,290,389,311"/>
<area shape="poly" title=" " alt="" coords="366,28,468,50,467,56,365,33"/>
<area shape="poly" title=" " alt="" coords="587,79,628,98,659,121,687,147,730,195,726,199,683,151,655,125,625,103,585,84"/>
<area shape="poly" title=" " alt="" coords="506,58,499,48,503,38,517,32,540,29,569,33,580,42,577,46,566,38,540,35,518,37,507,41,504,47,510,54"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="461,515,619,555"/>
<area shape="poly" title=" " alt="" coords="382,533,446,533,446,538,382,538"/>
<area shape="poly" title=" " alt="" coords="382,113,499,117,564,126,628,142,680,167,722,197,719,201,677,172,626,147,563,131,498,122,382,118"/>
<area shape="poly" title=" " alt="" coords="366,130,468,152,467,157,365,135"/>
<area shape="poly" title=" " alt="" coords="328,130,509,249,506,253,325,134"/>
<area shape="poly" title=" " alt="" coords="365,104,467,82,468,87,366,109"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="468,629,612,655"/>
<area shape="poly" title=" " alt="" coords="374,639,454,639,454,645,374,645"/>
</map>
</div>

</div>
</div>
<a id="a93f9263090199970a23f6dfca11227cf" name="a93f9263090199970a23f6dfca11227cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93f9263090199970a23f6dfca11227cf">&#9670;&#160;</a></span>fpsuev()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpsuev </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nu-4)*(nv-4)*idim), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu*mv*idim), intent(out)</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu,4), intent(out)</td>          <td class="paramname"><span class="paramname"><em>wu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv,4), intent(out)</td>          <td class="paramname"><span class="paramname"><em>wv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mu), intent(out)</td>          <td class="paramname"><span class="paramname"><em>lu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(mv), intent(out)</td>          <td class="paramname"><span class="paramname"><em>lv</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a93f9263090199970a23f6dfca11227cf_cgraph.png" border="0" usemap="#anamespacefitpack__core_a93f9263090199970a23f6dfca11227cf_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a93f9263090199970a23f6dfca11227cf_cgraph" id="anamespacefitpack__core_a93f9263090199970a23f6dfca11227cf_cgraph">
<area shape="rect" title=" " alt="" coords="5,42,159,67"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="207,5,365,45"/>
<area shape="poly" title=" " alt="" coords="158,41,193,36,193,41,159,46"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="211,70,361,95"/>
<area shape="poly" title=" " alt="" coords="159,63,198,68,197,73,159,68"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="413,70,587,95"/>
<area shape="poly" title=" " alt="" coords="361,80,400,80,400,85,361,85"/>
<area shape="poly" title=" " alt="" coords="466,72,459,62,463,52,477,46,500,43,529,47,540,56,537,60,526,52,500,49,478,51,467,55,464,61,470,68"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="635,70,780,95"/>
<area shape="poly" title=" " alt="" coords="587,80,621,80,621,85,587,85"/>
<area shape="poly" title=" " alt="" coords="674,72,666,62,670,52,684,46,707,43,736,47,747,56,744,60,734,52,707,49,685,51,674,55,672,61,678,68"/>
</map>
</div>

</div>
</div>
<a id="a999c5b98cb9e681f3045c39c6dea7151" name="a999c5b98cb9e681f3045c39c6dea7151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a999c5b98cb9e681f3045c39c6dea7151">&#9670;&#160;</a></span>fpsurf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpsurf </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xe</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>yb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ye</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kxx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kyy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nxest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nyest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>maxit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nmax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>km1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>km2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ib1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ib3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>intest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nrest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nx0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nmax), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ny0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nmax), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(intest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fpint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(intest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>coord</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc,ib1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc,ib3), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nmax,km2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>bx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nmax,km2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>by</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,km1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,km1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>spy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ib3), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nrest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nummer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Core algorithm for bivariate tensor-product spline surface fitting. </p>
<p>Fits a tensor-product spline surface \( s(x,y) \) of degrees \( k_x \) and \( k_y \) to scattered data by minimizing:</p>
<p class="formulaDsp">
\[              \sum_{i=1}^{m} \bigl( w_i (z_i - s(x_i, y_i)) \bigr)^2
              \leq S
              \tag{9.2}
\]
</p>
<p>The B-spline representation has \( (g+k_x+1)(h+k_y+1) \) coefficients on the knot grid \( \{t_x\} \times \{t_y\} \). The algorithm iterates:</p>
<ol type="1">
<li><b>Knot placement</b> in \( x \) and \( y \) based on residuals</li>
<li><b>QR factorization</b> of the observation matrix via Givens rotations, with rank-deficiency handling via fprank (Eq. 9.7-9.10)</li>
<li><b>Smoothing-parameter search</b> via rational interpolation</li>
</ol>
<p>Data points are sorted into knot-interval panels using fporde for efficient row-by-row processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>0 = new fit, 1 = continue </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>Data \( x \)-coordinates, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">y</td><td>Data \( y \)-coordinates, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Data weights, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xb</td><td>Left \( x \)-boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xe</td><td>Right \( x \)-boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yb</td><td>Lower \( y \)-boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>Upper \( y \)-boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kxx</td><td>Degree in \( x \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kyy</td><td>Degree in \( y \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \geq 0 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nxest</td><td>Max knots in \( x \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nyest</td><td>Max knots in \( y \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eta</td><td>Rank-deficiency tolerance factor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tol</td><td>Smoothing condition tolerance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxit</td><td>Maximum smoothing-parameter iterations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nmax</td><td>Max of <code>nxest</code>, <code>nyest</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km1</td><td>\( \max(k_x, k_y) + 1 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km2</td><td>\( k_x + k_y + 2 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib1</td><td>\( k_x k_y + 2 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ib3</td><td>\( k_x k_y + \max(k_x, k_y) + 2 \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Length of coefficient array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">intest</td><td>Length of <code>fpint</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nrest</td><td>Length of <code>index</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nx0</td><td>Number of \( x \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tx</td><td>\( x \)-knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ny0</td><td>Number of \( y \)-knots </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ty</td><td>\( y \)-knot vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp0</td><td>Initial unweighted residual sum </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fpint</td><td>Work: residual sums per panel </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">coord</td><td>Work: coordinates </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">f</td><td>Work: RHS vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ff</td><td>Work: RHS copy </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Work: band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>Work: extended band matrix </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">bx</td><td>Work: \( x \)-discontinuity coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">by</td><td>Work: \( y \)-discontinuity coefficients </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spx</td><td>Work: \( x \)-B-spline values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">spy</td><td>Work: \( y \)-B-spline values </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">h</td><td>Work vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">index</td><td>Work: panel sorting indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nummer</td><td>Work: data-to-panel mapping </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Work array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Length of <code>wrk</code> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 9, 9.1-9.2 (pp. 147-167), Eq. 9.2-9.10 </dd>
<dd>
<a class="el" href="#a000e6860b30d66fcc8bf487d934c0f28" title="Sort scattered data points into rectangular panels.">fporde</a>  panel sorting; <a class="el" href="#ab08555e9bd2f44d1461e09ba35a7bb22" title="Compute the minimum-norm least-squares solution under rank deficiency.">fprank</a>  rank-deficient solver </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a999c5b98cb9e681f3045c39c6dea7151_cgraph.png" border="0" usemap="#anamespacefitpack__core_a999c5b98cb9e681f3045c39c6dea7151_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a999c5b98cb9e681f3045c39c6dea7151_cgraph" id="anamespacefitpack__core_a999c5b98cb9e681f3045c39c6dea7151_cgraph">
<area shape="rect" title="Core algorithm for bivariate tensor&#45;product spline surface fitting." alt="" coords="5,288,152,313"/>
<area shape="rect" href="namespacefitpack__core.html#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="200,173,399,199"/>
<area shape="poly" title=" " alt="" coords="92,286,137,248,167,227,199,209,220,200,222,205,201,214,170,231,140,252,95,290"/>
<area shape="rect" href="namespacefitpack__core.html#aa452051613d61831a99b2f9ef8e21bc8" title="Rotate a smoothing&#45;matrix row into a band matrix using shifted pivots." alt="" coords="215,223,383,263"/>
<area shape="poly" title=" " alt="" coords="128,285,208,264,210,269,129,291"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="223,288,376,313"/>
<area shape="poly" title=" " alt="" coords="153,298,209,298,209,303,153,303"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="225,52,374,77"/>
<area shape="poly" title=" " alt="" coords="83,287,123,206,157,155,198,109,221,93,245,80,247,85,224,98,202,113,161,158,128,208,87,289"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="225,337,373,363"/>
<area shape="poly" title=" " alt="" coords="137,311,229,332,228,337,136,316"/>
<area shape="rect" href="namespacefitpack__core.html#a000e6860b30d66fcc8bf487d934c0f28" title="Sort scattered data points into rectangular panels." alt="" coords="224,387,375,412"/>
<area shape="poly" title=" " alt="" coords="98,311,143,342,201,373,221,380,219,385,199,378,140,347,95,316"/>
<area shape="rect" href="namespacefitpack__core.html#ab08555e9bd2f44d1461e09ba35a7bb22" title="Compute the minimum&#45;norm least&#45;squares solution under rank deficiency." alt="" coords="224,124,375,149"/>
<area shape="poly" title=" " alt="" coords="85,286,128,225,160,190,199,160,213,152,216,157,201,164,164,194,132,229,90,289"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="232,437,367,477"/>
<area shape="poly" title=" " alt="" coords="91,312,135,365,166,396,201,422,220,432,218,437,199,427,163,400,131,369,87,315"/>
<area shape="rect" href="fitpack__core_8_f90.html#aa91d9195d5c1268da8985c5f63cde0aa" title="Restore original x/y ordering if axes were interchanged." alt="" coords="264,501,335,527"/>
<area shape="poly" title=" " alt="" coords="87,313,101,348,125,395,158,445,179,467,201,486,225,499,251,506,250,512,223,504,199,491,175,471,154,448,120,398,96,350,82,315"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="668,105,813,131"/>
<area shape="poly" title=" " alt="" coords="382,171,654,128,655,134,383,176"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="459,231,608,256"/>
<area shape="poly" title=" " alt="" coords="353,196,468,225,467,230,351,201"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="459,181,607,207"/>
<area shape="poly" title=" " alt="" coords="399,187,445,188,445,194,399,192"/>
<area shape="poly" title=" " alt="" coords="707,107,700,97,703,87,717,81,741,79,769,82,781,91,777,96,767,87,741,84,719,86,707,91,705,96,711,104"/>
<area shape="poly" title=" " alt="" coords="355,261,412,276,480,287,515,288,551,286,586,279,619,266,656,241,686,208,709,173,726,142,731,144,714,175,690,211,659,245,621,271,587,284,552,291,516,294,479,292,411,282,353,266"/>
<area shape="poly" title=" " alt="" coords="384,241,445,241,445,246,384,246"/>
<area shape="poly" title=" " alt="" coords="383,223,459,207,460,212,384,228"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="447,29,620,55"/>
<area shape="poly" title=" " alt="" coords="374,55,433,49,433,54,375,60"/>
<area shape="poly" title=" " alt="" coords="570,52,693,98,691,103,568,57"/>
<area shape="poly" title=" " alt="" coords="500,31,492,21,496,11,510,5,533,3,562,6,573,15,570,20,560,11,533,8,511,10,500,15,498,20,504,28"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="454,379,613,419"/>
<area shape="poly" title=" " alt="" coords="375,397,440,397,440,402,375,402"/>
<area shape="poly" title=" " alt="" coords="375,127,447,122,654,116,654,121,447,127,375,132"/>
<area shape="poly" title=" " alt="" coords="373,147,400,160,416,174,425,189,433,204,448,217,458,223,456,227,445,221,429,207,420,192,412,178,397,164,371,152"/>
<area shape="poly" title=" " alt="" coords="353,147,468,175,467,181,351,152"/>
<area shape="poly" title=" " alt="" coords="329,121,446,72,483,57,485,62,448,76,331,126"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="461,444,605,469"/>
<area shape="poly" title=" " alt="" coords="367,454,448,454,448,459,367,459"/>
</map>
</div>

</div>
</div>
<a id="a0055c06b11885b09b3da8a5b9b24d0bb" name="a0055c06b11885b09b3da8a5b9b24d0bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0055c06b11885b09b3da8a5b9b24d0bb">&#9670;&#160;</a></span>fpsysy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fpsysy </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(6,6), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(6), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>g</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve a small symmetric linear system by Cholesky factorization. </p>
<p>Solves the \( n \times n \) symmetric positive definite system \( A \, b = g \) with \( n \leq 6 \) using Cholesky decomposition. On exit, <code>g</code> contains the solution \( b \).</p>
<p>Used by fpopdi and fpopsp for the small optimization problems that determine the optimal origin/pole boundary parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">a</td><td>Symmetric matrix, dimension <code>(6, 6)</code>. Only the first <code>n</code> rows and columns are used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>System dimension ( \( n \leq 6 \)) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">g</td><td>On entry, right-hand side. On exit, solution. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a20ca1b341438d801bc6903c35d1d0e20" name="a20ca1b341438d801bc6903c35d1d0e20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20ca1b341438d801bc6903c35d1d0e20">&#9670;&#160;</a></span>fptrnp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fptrnp </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,4), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n,5), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m*mm*idim), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n,5), intent(out)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((n-4)*mm*idim), intent(out)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mm*idim), intent(out)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Triangularize the tensor-product system for non-periodic grids. </p>
<p>Reduces the \( (m + n - 7) \times (n - 4) \) augmented observation matrix to upper triangular form using Givens rotations (Eq. 10.8), simultaneously transforming the \( m \times mm \times d \) data matrix \( Z \) into the \( (n-4) \times mm \times d \) RHS matrix \( Q \). Used in the second phase of the Kronecker product decomposition for parametric grid surfaces (fppasu via fpgrpa).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of grid points in this direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mm</td><td>Number of columns in the RHS (other direction size) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of surface dimensions \( d \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of knots in this direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nr</td><td>Knot interval indices, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sp</td><td>B-spline values at grid points, <code>(m, 4)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Smoothing parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Discontinuity jump matrix, <code>(n, 5)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data matrix, length \( m \cdot mm \cdot d \) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a</td><td>Triangularized band matrix, <code>(n, 5)</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">q</td><td>Transformed RHS, length \( (n-4) \cdot mm \cdot d \) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">right</td><td>Work: RHS row vector, length \( mm \cdot d \)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 10, 10.2 (pp. 170-172), Eq. 10.8 </dd>
<dd>
<a class="el" href="#aca070414f01b6af3f396f8f3d12bc499" title="Triangularize the tensor-product system for periodic grids.">fptrpe</a>  periodic variant; <a class="el" href="#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row-access) RHS.">fp_rotate_row_stride</a>  stride rotation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a20ca1b341438d801bc6903c35d1d0e20_cgraph.png" border="0" usemap="#anamespacefitpack__core_a20ca1b341438d801bc6903c35d1d0e20_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a20ca1b341438d801bc6903c35d1d0e20_cgraph" id="anamespacefitpack__core_a20ca1b341438d801bc6903c35d1d0e20_cgraph">
<area shape="rect" title="Triangularize the tensor&#45;product system for non&#45;periodic grids." alt="" coords="5,79,153,104"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="201,71,369,111"/>
<area shape="poly" title=" " alt="" coords="154,89,188,89,188,94,154,94"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="419,29,565,55"/>
<area shape="poly" title=" " alt="" coords="369,69,424,55,426,60,370,74"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="417,79,567,104"/>
<area shape="poly" title=" " alt="" coords="370,89,403,89,403,94,370,94"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="418,128,566,153"/>
<area shape="poly" title=" " alt="" coords="370,109,426,122,424,127,369,114"/>
<area shape="poly" title=" " alt="" coords="458,31,451,21,455,11,469,5,492,3,521,6,532,15,529,20,518,11,492,8,470,10,459,15,456,20,462,28"/>
</map>
</div>

</div>
</div>
<a id="aca070414f01b6af3f396f8f3d12bc499" name="aca070414f01b6af3f396f8f3d12bc499"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca070414f01b6af3f396f8f3d12bc499">&#9670;&#160;</a></span>fptrpe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine fitpack_core::fptrpe </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mm</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m,4), intent(in)</td>          <td class="paramname"><span class="paramname"><em>sp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n,5), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m*mm*idim), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n,5), intent(out)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n,4), intent(out)</td>          <td class="paramname"><span class="paramname"><em>aa</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((n-7)*mm*idim), intent(out)</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mm*idim), intent(out)</td>          <td class="paramname"><span class="paramname"><em>right</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Triangularize the tensor-product system for periodic grids. </p>
<p>Periodic variant of fptrnp. Reduces the \( (m + n - 7) \times (n - 7) \) cyclic band matrix to upper triangular form using two-matrix Givens rotations (fp_rotate_2mat_stride), simultaneously transforming the data matrix \( Z \) into the RHS matrix \( Q \). The periodicity wraps the last columns into the first, creating the block-triangular structure stored in <code>a</code> (main) and <code>aa</code> (periodic block).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of grid points in this direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mm</td><td>Number of columns in the RHS </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Number of surface dimensions \( d \) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of knots in this direction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nr</td><td>Knot interval indices, length <code>m</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sp</td><td>B-spline values at grid points, <code>(m, 4)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>Smoothing parameter </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Discontinuity jump matrix, <code>(n, 5)</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data matrix, length \( m \cdot mm \cdot d \) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">a</td><td>Triangularized band matrix (main block), <code>(n, 5)</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">aa</td><td>Triangularized periodic block, <code>(n, 4)</code> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">q</td><td>Transformed RHS, length \( (n-7) \cdot mm \cdot d \) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">right</td><td>Work: RHS row vector, length \( mm \cdot d \)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 10, 10.2 (pp. 170-172), Eq. 10.8 (periodic) </dd>
<dd>
<a class="el" href="#a20ca1b341438d801bc6903c35d1d0e20" title="Triangularize the tensor-product system for non-periodic grids.">fptrnp</a>  non-periodic variant; <a class="el" href="#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block-triangular periodic system with stride RHS.">fp_rotate_2mat_stride</a>  periodic rotation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_aca070414f01b6af3f396f8f3d12bc499_cgraph.png" border="0" usemap="#anamespacefitpack__core_aca070414f01b6af3f396f8f3d12bc499_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_aca070414f01b6af3f396f8f3d12bc499_cgraph" id="anamespacefitpack__core_aca070414f01b6af3f396f8f3d12bc499_cgraph">
<area shape="rect" title="Triangularize the tensor&#45;product system for periodic grids." alt="" coords="5,71,153,97"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="201,96,369,136"/>
<area shape="poly" title=" " alt="" coords="154,93,188,98,187,103,153,98"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="201,32,369,72"/>
<area shape="poly" title=" " alt="" coords="153,70,187,64,188,70,154,75"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="639,162,784,187"/>
<area shape="poly" title=" " alt="" coords="311,134,358,169,387,185,418,197,481,208,544,207,605,200,656,188,657,194,605,205,545,213,480,213,417,203,385,190,355,173,308,138"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="429,89,579,114"/>
<area shape="poly" title=" " alt="" coords="369,108,415,105,416,110,370,113"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="430,39,578,65"/>
<area shape="poly" title=" " alt="" coords="354,93,446,66,447,71,355,98"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="417,162,591,187"/>
<area shape="poly" title=" " alt="" coords="361,133,443,156,442,161,360,139"/>
<area shape="poly" title=" " alt="" coords="678,164,670,154,674,144,688,138,711,135,740,139,751,148,748,152,738,144,711,141,689,143,678,147,676,153,682,160"/>
<area shape="poly" title=" " alt="" coords="591,172,625,172,625,177,591,177"/>
<area shape="poly" title=" " alt="" coords="470,164,463,154,467,144,481,138,504,135,533,139,544,148,541,152,530,144,504,141,482,143,471,147,468,153,474,160"/>
<area shape="poly" title=" " alt="" coords="339,29,394,14,459,4,527,6,560,12,592,24,629,50,660,83,684,118,701,148,696,151,680,121,656,86,626,54,589,29,559,18,526,11,459,10,395,20,341,34"/>
<area shape="poly" title=" " alt="" coords="370,68,435,83,433,88,369,74"/>
<area shape="poly" title=" " alt="" coords="370,49,416,49,416,55,370,55"/>
</map>
</div>

</div>
</div>
<a id="af9c168cddc6b453b8a23cd0d27e899e2" name="af9c168cddc6b453b8a23cd0d27e899e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9c168cddc6b453b8a23cd0d27e899e2">&#9670;&#160;</a></span>get_smoothing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fitpack_core::get_smoothing </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>old_smoothing</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in), optional</td>          <td class="paramname"><span class="paramname"><em>user_smoothing</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>nit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(3), intent(out)</td>          <td class="paramname"><span class="paramname"><em>smooth_now</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Choose the smoothing parameter(s) for an iterative fit. </p>
<p>Selects one or more values of the smoothing factor \( s \) for the next fitting iteration(s). If a user-supplied value is present it is used directly; if a previous value exists it is re-used; otherwise a default decreasing trajectory is applied.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">old_smoothing</td><td>Previous smoothing factor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user_smoothing</td><td>Optional user-supplied value. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nit</td><td>Number of smoothing iterations to perform. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">smooth_now</td><td>Array of 3 smoothing values for the iterations. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4a396967312954458c7a650aa76ea906" name="a4a396967312954458c7a650aa76ea906"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a396967312954458c7a650aa76ea906">&#9670;&#160;</a></span>insert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::insert </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(out)</td>          <td class="paramname"><span class="paramname"><em>tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>nn</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(out)</td>          <td class="paramname"><span class="paramname"><em>cc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert a single knot into a spline, returning a new B-spline representation. </p>
<p>Inserts the knot \( x \) into the B-spline representation of \( s(x) \) using the Boehm knot insertion algorithm. The spline itself is unchanged; only its representation (knots and coefficients) is updated.</p>
<p>Can be called with output arrays aliased to input arrays to replace the representation in place: <code>call insert(iopt,t,n,c,k,x,t,n,c,nest,ier)</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Periodicity flag: <code>0</code> = non-periodic; <code>/=0</code> = periodic spline. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Input knot positions (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Number of knots before insertion. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>Input B-spline coefficients (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Degree of the spline. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Location of the knot to insert. Must satisfy \( t_{k+1} \le x \le t_{n-k} \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tt</td><td>Output knot positions (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nn</td><td>Number of knots after insertion ( \( n + 1 \)). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cc</td><td>Output B-spline coefficients (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Array dimension. Must satisfy <code>nest &gt; n</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, 1.3.4 (pp. 13&ndash;14), Eq. 1.46&ndash;1.48; <a class="el" href="#a3d51410017bf94f298da66b1d80fe524" title="Insert a single knot into a B-spline representation.">fpinst</a>  knot insertion kernel </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a4a396967312954458c7a650aa76ea906_cgraph.png" border="0" usemap="#anamespacefitpack__core_a4a396967312954458c7a650aa76ea906_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a4a396967312954458c7a650aa76ea906_cgraph" id="anamespacefitpack__core_a4a396967312954458c7a650aa76ea906_cgraph">
<area shape="rect" title="Insert a single knot into a spline, returning a new B&#45;spline representation." alt="" coords="5,42,152,67"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="200,5,359,45"/>
<area shape="poly" title=" " alt="" coords="152,41,186,36,187,42,152,47"/>
<area shape="rect" href="namespacefitpack__core.html#a3d51410017bf94f298da66b1d80fe524" title="Insert a single knot into a B&#45;spline representation." alt="" coords="206,70,353,95"/>
<area shape="poly" title=" " alt="" coords="152,62,193,68,192,73,152,67"/>
</map>
</div>

</div>
</div>
<a id="a5408515a66457ab26ce615842e24a526" name="a5408515a66457ab26ce615842e24a526"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5408515a66457ab26ce615842e24a526">&#9670;&#160;</a></span>insert_inplace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::insert_inplace </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert a single knot into a spline in place (avoiding aliasing issues). </p>
<p>Wrapper around insert that uses temporary arrays to safely update the knot and coefficient arrays in place, avoiding the aliasing of input/output arguments present in the original Fortran 77 calling convention.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Periodicity flag: <code>0</code> = non-periodic; <code>/=0</code> = periodic. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot positions (length <code>nest</code>). Updated on exit. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Number of knots. Updated to \( n + 1 \) on exit. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients (length <code>nest</code>). Updated on exit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Degree of the spline. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Location of the knot to insert. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Array dimension. Must satisfy <code>nest &gt; n</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a4a396967312954458c7a650aa76ea906" title="Insert a single knot into a spline, returning a new B-spline representation.">insert</a>  non-aliased variant </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a5408515a66457ab26ce615842e24a526_cgraph.png" border="0" usemap="#anamespacefitpack__core_a5408515a66457ab26ce615842e24a526_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a5408515a66457ab26ce615842e24a526_cgraph" id="anamespacefitpack__core_a5408515a66457ab26ce615842e24a526_cgraph">
<area shape="rect" title="Insert a single knot into a spline in place (avoiding aliasing issues)." alt="" coords="5,35,152,75"/>
<area shape="rect" href="namespacefitpack__core.html#a4a396967312954458c7a650aa76ea906" title="Insert a single knot into a spline, returning a new B&#45;spline representation." alt="" coords="200,42,347,67"/>
<area shape="poly" title=" " alt="" coords="152,52,186,52,186,57,152,57"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="395,5,553,45"/>
<area shape="poly" title=" " alt="" coords="346,41,381,36,382,42,347,47"/>
<area shape="rect" href="namespacefitpack__core.html#a3d51410017bf94f298da66b1d80fe524" title="Insert a single knot into a B&#45;spline representation." alt="" coords="401,70,547,95"/>
<area shape="poly" title=" " alt="" coords="347,62,387,68,387,73,346,67"/>
</map>
</div>

</div>
</div>
<a id="ab71e638faa5a4457d12026be93f6588c" name="ab71e638faa5a4457d12026be93f6588c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab71e638faa5a4457d12026be93f6588c">&#9670;&#160;</a></span>iopt_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure character(len=:) function, allocatable, public fitpack_core::iopt_message </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert an <code>iopt</code> computation-mode flag to a human-readable string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Computation mode flag (<code>-1</code> = Least-Squares, <code>0</code> = Smoothing, <code>1</code> = Old). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Allocatable character string describing the mode. </dd></dl>

</div>
</div>
<a id="ab9e559a7491e780d631b07d895b4ff98" name="ab9e559a7491e780d631b07d895b4ff98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9e559a7491e780d631b07d895b4ff98">&#9670;&#160;</a></span>is_after()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function fitpack_core::is_after </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test \( a &gt; b \) (strict greater-than). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ab9e559a7491e780d631b07d895b4ff98_cgraph.png" border="0" usemap="#anamespacefitpack__core_ab9e559a7491e780d631b07d895b4ff98_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ab9e559a7491e780d631b07d895b4ff98_cgraph" id="anamespacefitpack__core_ab9e559a7491e780d631b07d895b4ff98_cgraph">
<area shape="rect" title="Test &#160;(strict greater&#45;than)." alt="" coords="5,29,163,55"/>
<area shape="poly" title=" " alt="" coords="57,31,52,21,55,11,66,5,84,3,106,6,115,15,111,19,103,11,84,8,68,10,59,15,57,20,62,28"/>
</map>
</div>

</div>
</div>
<a id="a69c35a8032dd7dfa0b593ce00610d36f" name="a69c35a8032dd7dfa0b593ce00610d36f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c35a8032dd7dfa0b593ce00610d36f">&#9670;&#160;</a></span>is_before()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function fitpack_core::is_before </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test \( a &lt; b \) (strict less-than). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a69c35a8032dd7dfa0b593ce00610d36f_cgraph.png" border="0" usemap="#anamespacefitpack__core_a69c35a8032dd7dfa0b593ce00610d36f_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a69c35a8032dd7dfa0b593ce00610d36f_cgraph" id="anamespacefitpack__core_a69c35a8032dd7dfa0b593ce00610d36f_cgraph">
<area shape="rect" title="Test &#160;(strict less&#45;than)." alt="" coords="5,29,175,55"/>
<area shape="poly" title=" " alt="" coords="62,31,56,21,59,11,71,5,90,3,113,6,123,15,119,19,111,11,90,8,72,10,63,15,61,20,66,28"/>
</map>
</div>

</div>
</div>
<a id="a82ac0d242da9cc1d0a21148c54a5e64f" name="a82ac0d242da9cc1d0a21148c54a5e64f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82ac0d242da9cc1d0a21148c54a5e64f">&#9670;&#160;</a></span>is_ge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function fitpack_core::is_ge </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test \( a \ge b \). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a82ac0d242da9cc1d0a21148c54a5e64f_cgraph.png" border="0" usemap="#anamespacefitpack__core_a82ac0d242da9cc1d0a21148c54a5e64f_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a82ac0d242da9cc1d0a21148c54a5e64f_cgraph" id="anamespacefitpack__core_a82ac0d242da9cc1d0a21148c54a5e64f_cgraph">
<area shape="rect" title="Test ." alt="" coords="5,29,148,55"/>
<area shape="poly" title=" " alt="" coords="53,30,48,21,50,11,60,5,77,3,96,6,105,15,101,18,94,11,77,8,62,10,55,15,53,20,57,28"/>
</map>
</div>

</div>
</div>
<a id="ad5edd55a10f2aebf05e8a9d8c68b36d8" name="ad5edd55a10f2aebf05e8a9d8c68b36d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5edd55a10f2aebf05e8a9d8c68b36d8">&#9670;&#160;</a></span>is_le()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function fitpack_core::is_le </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test \( a \le b \). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ad5edd55a10f2aebf05e8a9d8c68b36d8_cgraph.png" border="0" usemap="#anamespacefitpack__core_ad5edd55a10f2aebf05e8a9d8c68b36d8_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ad5edd55a10f2aebf05e8a9d8c68b36d8_cgraph" id="anamespacefitpack__core_ad5edd55a10f2aebf05e8a9d8c68b36d8_cgraph">
<area shape="rect" title="Test ." alt="" coords="5,29,144,55"/>
<area shape="poly" title=" " alt="" coords="51,30,46,21,49,11,59,5,75,3,94,6,102,15,98,18,91,11,75,8,60,10,53,15,51,20,56,28"/>
</map>
</div>

</div>
</div>
<a id="a8c4fa92fbc6556a21d112fbdfbd0f80f" name="a8c4fa92fbc6556a21d112fbdfbd0f80f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c4fa92fbc6556a21d112fbdfbd0f80f">&#9670;&#160;</a></span>new_knot_dimension()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental integer function fitpack_core::new_knot_dimension </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n1add</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n1max</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n2add</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n2max</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>last</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2509dd629f972935555488cd2db1bff2" name="a2509dd629f972935555488cd2db1bff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2509dd629f972935555488cd2db1bff2">&#9670;&#160;</a></span>not_equal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>) function fitpack_core::not_equal </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test whether two reals differ beyond machine precision. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a2509dd629f972935555488cd2db1bff2_cgraph.png" border="0" usemap="#anamespacefitpack__core_a2509dd629f972935555488cd2db1bff2_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a2509dd629f972935555488cd2db1bff2_cgraph" id="anamespacefitpack__core_a2509dd629f972935555488cd2db1bff2_cgraph">
<area shape="rect" title="Test whether two reals differ beyond machine precision." alt="" coords="5,29,179,55"/>
<area shape="poly" title=" " alt="" coords="58,31,51,21,55,11,69,5,92,3,121,6,132,15,129,20,118,11,92,8,70,10,59,15,56,20,62,28"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="227,29,372,55"/>
<area shape="poly" title=" " alt="" coords="179,39,213,39,213,45,179,45"/>
<area shape="poly" title=" " alt="" coords="266,31,258,21,262,11,276,5,299,3,328,6,339,15,336,20,326,11,299,8,277,10,266,15,264,20,270,28"/>
</map>
</div>

</div>
</div>
<a id="ae2ad7fd4cae431c05938a167488df6f0" name="ae2ad7fd4cae431c05938a167488df6f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2ad7fd4cae431c05938a167488df6f0">&#9670;&#160;</a></span>parcur()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::parcur </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ipar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(idim,m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ub</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ue</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nc), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine a smooth parametric spline curve approximation. </p>
<p>Given \( m \) ordered points \( \mathbf{x}_i \in \mathbb{R}^{\text{idim}} \) with weights \( w_i &gt; 0 \) and parameter values \( u_i \), computes an open parametric spline curve \( \mathbf{s}(u) = (s_1(u),\ldots,s_{\text{idim}}(u)) \) of degree \( k \) on \( [u_b, u_e] \).</p>
<p>If <code>ipar=0</code>, parameter values are computed automatically from cumulative chord lengths: \( u_i = v_i / v_m \) where \( v_i = v_{i-1} + \|\mathbf{x}_i - \mathbf{x}_{i-1}\| \), with \( u_b = 0 \) and \( u_e = 1 \).</p>
<p>Smoothness is controlled by requiring \( F(p) = \sum w_i^2 \|\mathbf{x}_i - \mathbf{s}(u_i)\|^2 \le S \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Computation mode: <code>-1</code> (LSQ), <code>0</code> (new smoothing), <code>1</code> (continue). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipar</td><td>Parameter mode: <code>0</code> = automatic, <code>1</code> = user-supplied. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idim</td><td>Dimension of the curve, \( 1 \le \text{idim} \le 10 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points, \( m &gt; k \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">u</td><td>Parameter values (length \( m \)). Output when <code>ipar=0</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Declared dimension of <code>x</code>, \( \ge \text{idim} \times m \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Data coordinates (length <code>mx</code>): <code>x(idim*(i-1)+j)</code> = \( j \)-th coordinate of point \( i \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">w</td><td>Weights (length \( m \)), strictly positive. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ub</td><td>Lower parameter bound. Set to 0 when <code>ipar=0</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ue</td><td>Upper parameter bound. Set to 1 when <code>ipar=0</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree, \( 1 \le k \le 5 \). Cubic recommended. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">s</td><td>Smoothing factor \( S \ge 0 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Over-estimate of total knots. <code>nest=m+k+1</code> always suffices. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot positions (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nc</td><td>Declared dimension of <code>c</code>, \( \ge \text{nest} \times \text{idim} \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients (length <code>nc</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace, length \( \ge m(k+1) + \text{nest}(6+\text{idim}+3k) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Declared dimension of <code>wrk</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer workspace (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag (same codes as curfit).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.3; <a class="el" href="#a5e667cdc0bc06d8fcf33ec1b61fe50a6" title="Core algorithm for open parametric curve fitting.">fppara</a>  core parametric fitting algorithm </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ae2ad7fd4cae431c05938a167488df6f0_cgraph.png" border="0" usemap="#anamespacefitpack__core_ae2ad7fd4cae431c05938a167488df6f0_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ae2ad7fd4cae431c05938a167488df6f0_cgraph" id="anamespacefitpack__core_ae2ad7fd4cae431c05938a167488df6f0_cgraph">
<area shape="rect" title="Determine a smooth parametric spline curve approximation." alt="" coords="5,203,156,228"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="841,188,987,213"/>
<area shape="poly" title=" " alt="" coords="95,201,143,163,216,112,305,61,354,40,403,23,463,10,515,4,562,4,605,12,648,25,693,45,795,100,849,137,892,176,888,180,845,141,792,104,690,50,646,30,604,17,561,10,515,9,464,15,405,29,356,45,308,66,219,116,146,167,98,205"/>
<area shape="rect" href="namespacefitpack__core.html#a3e1011bf7749aa62d3c05bd1a20e36d1" title="Verify knot positions against data points (Schoenberg&#45;Whitney check)." alt="" coords="204,252,356,277"/>
<area shape="poly" title=" " alt="" coords="133,225,215,246,214,251,132,231"/>
<area shape="rect" href="namespacefitpack__core.html#a5e667cdc0bc06d8fcf33ec1b61fe50a6" title="Core algorithm for open parametric curve fitting." alt="" coords="205,203,355,228"/>
<area shape="poly" title=" " alt="" coords="156,213,191,213,191,218,156,218"/>
<area shape="poly" title=" " alt="" coords="880,190,873,180,877,170,891,164,914,161,943,165,954,174,951,178,940,170,914,167,892,169,881,173,878,179,884,186"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="409,381,567,421"/>
<area shape="poly" title=" " alt="" coords="341,226,358,237,371,254,379,271,383,303,387,335,394,351,406,367,410,371,407,375,402,370,389,354,382,337,378,304,374,272,367,257,354,241,338,230"/>
<area shape="rect" href="namespacefitpack__core.html#a82db002de9c1abeba86fae180dbec079" title="Rotate an observation row into a band matrix with vector RHS." alt="" coords="404,253,572,293"/>
<area shape="poly" title=" " alt="" coords="328,225,403,246,401,252,326,231"/>
<area shape="rect" href="namespacefitpack__core.html#a73c05ec35eef6da81086156d5cf0597d" title="Rotate a smoothing&#45;matrix row into a band matrix with vector RHS." alt="" coords="404,317,572,357"/>
<area shape="poly" title=" " alt="" coords="336,226,358,237,374,254,383,270,391,287,406,303,413,308,410,312,402,307,386,290,378,273,370,257,354,241,334,230"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="411,445,565,471"/>
<area shape="poly" title=" " alt="" coords="343,226,358,237,375,262,383,287,384,312,382,336,381,360,382,384,389,407,406,431,411,436,408,440,402,434,385,410,377,385,375,360,377,336,379,312,378,288,371,265,354,241,339,230"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="413,203,563,228"/>
<area shape="poly" title=" " alt="" coords="355,213,400,213,400,218,355,218"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="414,39,562,64"/>
<area shape="poly" title=" " alt="" coords="287,201,331,140,364,104,403,73,414,67,416,72,405,78,367,108,335,143,291,204"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="413,88,563,113"/>
<area shape="poly" title=" " alt="" coords="294,201,340,163,403,124,422,115,424,120,405,128,343,167,297,205"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="421,138,555,178"/>
<area shape="poly" title=" " alt="" coords="326,200,407,178,408,183,328,205"/>
<area shape="poly" title=" " alt="" coords="572,258,793,222,838,213,839,219,794,227,572,263"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="632,339,781,364"/>
<area shape="poly" title=" " alt="" coords="544,290,573,302,621,325,642,332,641,337,619,330,571,307,542,295"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="633,289,781,315"/>
<area shape="poly" title=" " alt="" coords="573,281,619,288,619,293,572,287"/>
<area shape="poly" title=" " alt="" coords="572,340,618,343,618,348,572,345"/>
<area shape="poly" title=" " alt="" coords="572,321,619,313,620,318,573,326"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="620,188,793,213"/>
<area shape="poly" title=" " alt="" coords="563,208,606,205,606,210,563,213"/>
<area shape="poly" title=" " alt="" coords="794,198,828,198,828,203,794,203"/>
<area shape="poly" title=" " alt="" coords="673,190,666,180,669,170,683,164,707,161,735,165,747,174,743,178,733,170,707,167,685,169,673,173,671,179,677,186"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="635,115,779,140"/>
<area shape="poly" title=" " alt="" coords="556,146,621,137,622,142,556,151"/>
</map>
</div>

</div>
</div>
<a id="a01477d82a007d0853de3bc8247ef8c27" name="a01477d82a007d0853de3bc8247ef8c27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01477d82a007d0853de3bc8247ef8c27">&#9670;&#160;</a></span>parder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::parder </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nx-kx-1)*(ny-ky-1)), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nux</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(my), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>my</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx*my), intent(out)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate a partial derivative of a bivariate spline on a rectangular grid. </p>
<p>Computes the partial derivative  \( \frac{\partial^{\nu_x+\nu_y}}{\partial x^{\nu_x}\,\partial
          y^{\nu_y}} s(x,y) \) of a bivariate spline of degrees \( k_x \) and \( k_y \) on the grid \( (x_i, y_j) \),  \( i=1,\ldots,m_x;\ 
j=1,\ldots,m_y \). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a01477d82a007d0853de3bc8247ef8c27_cgraph.png" border="0" usemap="#anamespacefitpack__core_a01477d82a007d0853de3bc8247ef8c27_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a01477d82a007d0853de3bc8247ef8c27_cgraph" id="anamespacefitpack__core_a01477d82a007d0853de3bc8247ef8c27_cgraph">
<area shape="rect" title="Evaluate a partial derivative of a bivariate spline on a rectangular grid." alt="" coords="5,42,156,67"/>
<area shape="rect" href="namespacefitpack__core.html#a72432bc4ebc7c5ff0425d188147d7dbb" title="Evaluate a tensor product spline on a grid." alt="" coords="204,42,353,67"/>
<area shape="poly" title=" " alt="" coords="156,52,190,52,190,57,156,57"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="401,5,560,45"/>
<area shape="poly" title=" " alt="" coords="353,41,388,36,388,41,354,46"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="406,70,555,95"/>
<area shape="poly" title=" " alt="" coords="354,62,393,68,392,73,353,68"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="608,70,781,95"/>
<area shape="poly" title=" " alt="" coords="556,80,594,80,594,85,556,85"/>
<area shape="poly" title=" " alt="" coords="661,72,654,62,657,52,671,46,695,43,723,47,735,56,731,60,721,52,695,49,673,51,661,55,659,61,665,68"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="829,70,975,95"/>
<area shape="poly" title=" " alt="" coords="782,80,816,80,816,85,782,85"/>
<area shape="poly" title=" " alt="" coords="868,72,861,62,865,52,879,46,902,43,931,47,942,56,939,60,928,52,902,49,880,51,869,55,866,61,872,68"/>
</map>
</div>

</div>
</div>
<a id="a1fd21985777d3dd9a85782026ff7aeba" name="a1fd21985777d3dd9a85782026ff7aeba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fd21985777d3dd9a85782026ff7aeba">&#9670;&#160;</a></span>pardeu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::pardeu </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nx-kx-1)*(ny-ky-1)), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nux</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate a partial derivative of a bivariate spline at scattered points. </p>
<p>Computes  \( \frac{\partial^{\nu_x+\nu_y}}{\partial x^{\nu_x}\,\partial y^{\nu_y}} s(x_i,y_i)
\) for \( i=1,\ldots,m \) at arbitrary (unstructured) points. This is the scattered-point counterpart of parder, which evaluates on a rectangular grid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>Knot positions in \( x \)-direction (length \( n_x \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Total number of knots in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ty</td><td>Knot positions in \( y \)-direction (length \( n_y \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Total number of knots in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients, length \( (n_x{-}k_x{-}1)(n_y{-}k_y{-}1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Degree in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Degree in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nux</td><td>Derivative order in \( x \), \( 0 \le \nu_x &lt; k_x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nuy</td><td>Derivative order in \( y \), \( 0 \le \nu_y &lt; k_y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>\( x \)-coordinates of evaluation points (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>\( y \)-coordinates of evaluation points (length \( m \)). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">z</td><td>Derivative values (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of evaluation points, \( m \ge 1 \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace, length  \( \ge m(k_x{+}1{-}\nu_x) + m(k_y{+}1{-}\nu_y)
                               + (n_x{-}k_x{-}1)(n_y{-}k_y{-}1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Declared dimension of <code>wrk</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer workspace (length \( \ge 2m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kwrk</td><td>Declared dimension of <code>iwrk</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a01477d82a007d0853de3bc8247ef8c27" title="Evaluate a partial derivative of a bivariate spline on a rectangular grid.">parder</a>  grid variant; <a class="el" href="#ae277d8a029f43ac5702946468c8bd54f" title="Transform B-spline coefficients to obtain the partial derivative spline.">pardtc</a>  coefficient transformation only; de Boor (1972), <em>J. Approx. Theory</em> 6, 5062 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a1fd21985777d3dd9a85782026ff7aeba_cgraph.png" border="0" usemap="#anamespacefitpack__core_a1fd21985777d3dd9a85782026ff7aeba_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a1fd21985777d3dd9a85782026ff7aeba_cgraph" id="anamespacefitpack__core_a1fd21985777d3dd9a85782026ff7aeba_cgraph">
<area shape="rect" title="Evaluate a partial derivative of a bivariate spline at scattered points." alt="" coords="5,42,160,67"/>
<area shape="rect" href="namespacefitpack__core.html#a72432bc4ebc7c5ff0425d188147d7dbb" title="Evaluate a tensor product spline on a grid." alt="" coords="208,42,357,67"/>
<area shape="poly" title=" " alt="" coords="160,52,194,52,194,57,160,57"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="405,5,564,45"/>
<area shape="poly" title=" " alt="" coords="357,41,392,36,392,41,358,46"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="410,70,559,95"/>
<area shape="poly" title=" " alt="" coords="358,62,397,68,396,73,357,68"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="612,70,785,95"/>
<area shape="poly" title=" " alt="" coords="560,80,598,80,598,85,560,85"/>
<area shape="poly" title=" " alt="" coords="665,72,658,62,661,52,675,46,699,43,727,47,739,56,735,60,725,52,699,49,677,51,665,55,663,61,669,68"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="833,70,979,95"/>
<area shape="poly" title=" " alt="" coords="786,80,820,80,820,85,786,85"/>
<area shape="poly" title=" " alt="" coords="872,72,865,62,869,52,883,46,906,43,935,47,946,56,943,60,932,52,906,49,884,51,873,55,870,61,876,68"/>
</map>
</div>

</div>
</div>
<a id="ae277d8a029f43ac5702946468c8bd54f" name="ae277d8a029f43ac5702946468c8bd54f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae277d8a029f43ac5702946468c8bd54f">&#9670;&#160;</a></span>pardtc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::pardtc </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nx-kx-1)*(ny-ky-1)), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nux</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuy</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nx-kx-1)*(ny-ky-1)), intent(out)</td>          <td class="paramname"><span class="paramname"><em>newc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transform B-spline coefficients to obtain the partial derivative spline. </p>
<p>Given a bivariate spline \( s(x,y) \) of degrees \( k_x, k_y \), computes the B-spline coefficients of the derivative spline \( \frac{\partial^{\nu_x+\nu_y}}{\partial x^{\nu_x}\,\partial y^{\nu_y}} s(x,y) \) of degrees \( k_x - \nu_x, k_y - \nu_y \).</p>
<p>Unlike parder / pardeu, this routine does <b>not</b> evaluate the derivative at any point; it only transforms the coefficient array. The resulting spline can then be evaluated with bispev or bispeu.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>Knot positions in \( x \)-direction (length \( n_x \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Total number of knots in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ty</td><td>Knot positions in \( y \)-direction (length \( n_y \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Total number of knots in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients, length \( (n_x{-}k_x{-}1)(n_y{-}k_y{-}1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Degree in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Degree in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nux</td><td>Derivative order in \( x \), \( 0 \le \nu_x &lt; k_x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nuy</td><td>Derivative order in \( y \), \( 0 \le \nu_y &lt; k_y \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">newc</td><td>Derivative-spline coefficients, dimension \( (n_x{-}\nu_x{-}k_x{-}1)(n_y{-}\nu_y{-}k_y{-}1) \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a01477d82a007d0853de3bc8247ef8c27" title="Evaluate a partial derivative of a bivariate spline on a rectangular grid.">parder</a>  evaluate derivative on a grid; <a class="el" href="#a1fd21985777d3dd9a85782026ff7aeba" title="Evaluate a partial derivative of a bivariate spline at scattered points.">pardeu</a>  evaluate at scattered points; de Boor (1972), <em>J. Approx. Theory</em> 6, 5062 </dd></dl>

</div>
</div>
<a id="a900e08c9d4a7e79e93c9c25c80ad967b" name="a900e08c9d4a7e79e93c9c25c80ad967b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a900e08c9d4a7e79e93c9c25c80ad967b">&#9670;&#160;</a></span>parsur()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::parsur </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ipar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu*mv*idim), intent(in)</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nvest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nuest-4)*(nvest-4)*idim), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit a smooth parametric surface to gridded data. </p>
<p>Given data points \( \mathbf{f}(i,j) \in \mathbb{R}^d \) at the grid nodes \( (u_i, v_j) \),  \( i=1,\ldots,m_u;\ 
j=1,\ldots,m_v \), determines a smooth \( d \)-dimensional bicubic spline </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a900e08c9d4a7e79e93c9c25c80ad967b_cgraph.png" border="0" usemap="#anamespacefitpack__core_a900e08c9d4a7e79e93c9c25c80ad967b_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a900e08c9d4a7e79e93c9c25c80ad967b_cgraph" id="anamespacefitpack__core_a900e08c9d4a7e79e93c9c25c80ad967b_cgraph">
<area shape="rect" title="Fit a smooth parametric surface to gridded data." alt="" coords="5,383,156,408"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="1264,179,1409,204"/>
<area shape="poly" title=" " alt="" coords="156,385,310,374,490,367,912,367,972,363,1032,349,1090,330,1145,306,1240,254,1306,210,1309,214,1242,259,1147,311,1092,335,1033,355,973,368,912,373,490,373,310,379,157,391"/>
<area shape="rect" href="namespacefitpack__core.html#a3e1011bf7749aa62d3c05bd1a20e36d1" title="Verify knot positions against data points (Schoenberg&#45;Whitney check)." alt="" coords="205,408,357,433"/>
<area shape="poly" title=" " alt="" coords="156,402,191,407,190,412,156,407"/>
<area shape="rect" href="namespacefitpack__core.html#accaa1729715efbe04726699613597c32" title=" " alt="" coords="204,457,357,483"/>
<area shape="poly" title=" " alt="" coords="112,406,205,444,225,451,223,456,203,448,110,411"/>
<area shape="rect" href="namespacefitpack__core.html#a19127c353493bb69ea3a6c3c382895d7" title="Core algorithm for parametric surface fitting on a grid." alt="" coords="204,127,357,152"/>
<area shape="poly" title=" " alt="" coords="90,381,259,161,263,164,94,384"/>
<area shape="poly" title=" " alt="" coords="1303,180,1296,170,1299,160,1313,154,1337,152,1365,156,1377,165,1373,169,1363,161,1337,157,1315,159,1303,164,1301,170,1307,177"/>
<area shape="rect" href="namespacefitpack__core.html#a0cc8f44b08134a5a84ab88c44e86485d" title="Compute parametric surface spline coefficients on a grid." alt="" coords="416,184,567,209"/>
<area shape="poly" title=" " alt="" coords="329,149,432,178,430,183,327,155"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="416,5,567,31"/>
<area shape="poly" title=" " alt="" coords="293,125,340,84,371,61,404,41,422,33,425,38,407,46,374,65,343,88,297,129"/>
<area shape="rect" href="namespacefitpack__core.html#a8c4fa92fbc6556a21d112fbdfbd0f80f" title=" " alt="" coords="405,119,577,159"/>
<area shape="poly" title=" " alt="" coords="358,137,392,137,392,142,358,142"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="424,55,559,95"/>
<area shape="poly" title=" " alt="" coords="323,124,411,97,412,102,324,129"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="625,208,779,233"/>
<area shape="poly" title=" " alt="" coords="567,203,612,208,611,213,567,208"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="625,257,779,283"/>
<area shape="poly" title=" " alt="" coords="527,207,626,243,648,251,646,256,624,249,525,212"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="836,52,985,77"/>
<area shape="poly" title=" " alt="" coords="553,182,576,169,591,151,598,132,606,112,624,94,671,72,723,59,774,54,822,53,822,58,774,59,724,65,673,77,627,99,610,115,603,134,596,154,579,173,556,186"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="628,307,776,332"/>
<area shape="poly" title=" " alt="" coords="508,208,559,249,627,293,640,299,638,304,624,298,555,253,505,212"/>
<area shape="rect" href="namespacefitpack__core.html#a20ca1b341438d801bc6903c35d1d0e20" title="Triangularize the tensor&#45;product system for non&#45;periodic grids." alt="" coords="628,159,776,184"/>
<area shape="poly" title=" " alt="" coords="567,185,614,179,615,185,567,190"/>
<area shape="rect" href="namespacefitpack__core.html#aca070414f01b6af3f396f8f3d12bc499" title="Triangularize the tensor&#45;product system for periodic grids." alt="" coords="628,109,776,135"/>
<area shape="poly" title=" " alt="" coords="540,181,576,169,624,144,643,136,645,141,626,148,578,174,542,186"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="1043,52,1216,77"/>
<area shape="poly" title=" " alt="" coords="986,62,1029,62,1029,67,986,67"/>
<area shape="poly" title=" " alt="" coords="1174,75,1217,94,1271,131,1314,167,1310,171,1267,135,1215,99,1172,80"/>
<area shape="poly" title=" " alt="" coords="1096,54,1088,44,1092,34,1106,28,1129,25,1158,29,1169,38,1166,42,1156,34,1129,31,1107,33,1096,37,1094,43,1100,50"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="827,166,995,206"/>
<area shape="poly" title=" " alt="" coords="777,174,813,176,813,182,776,179"/>
<area shape="poly" title=" " alt="" coords="950,204,994,223,1043,238,1091,247,1129,249,1167,246,1215,238,1259,225,1299,208,1301,213,1261,230,1217,243,1168,252,1129,255,1091,252,1042,243,992,228,948,209"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="1055,153,1204,179"/>
<area shape="poly" title=" " alt="" coords="995,176,1041,171,1041,177,995,181"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="1055,203,1203,228"/>
<area shape="poly" title=" " alt="" coords="995,195,1042,201,1041,206,995,200"/>
<area shape="poly" title=" " alt="" coords="745,132,833,159,831,164,744,137"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="827,102,995,142"/>
<area shape="poly" title=" " alt="" coords="777,119,813,119,813,125,777,125"/>
<area shape="poly" title=" " alt="" coords="995,117,1101,121,1160,127,1217,138,1261,152,1301,170,1299,175,1259,157,1215,143,1159,133,1101,126,995,122"/>
<area shape="poly" title=" " alt="" coords="987,99,1066,78,1067,84,988,105"/>
<area shape="poly" title=" " alt="" coords="995,136,1053,148,1052,153,994,141"/>
<area shape="poly" title=" " alt="" coords="971,140,996,152,1020,170,1044,188,1063,196,1061,201,1041,192,1017,174,993,156,969,144"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="630,8,774,33"/>
<area shape="poly" title=" " alt="" coords="558,55,638,34,640,39,560,60"/>
</map>
</div>

</div>
</div>
<a id="ad0afe8a4afa89245ec1ec1447ef7b556" name="ad0afe8a4afa89245ec1ec1447ef7b556"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0afe8a4afa89245ec1ec1447ef7b556">&#9670;&#160;</a></span>percur()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::percur </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(nest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine a smooth periodic spline approximation to data. </p>
<p>Given data points \( (x_i, y_i) \) with weights \( w_i &gt; 0 \), \( i=1,\ldots,m \), computes a periodic spline \( s(x) \) of degree \( k \) with period \( P = x_m - x_1 \). The periodicity means \( s(x_1) = s(x_m) \) and all derivatives match at the boundary.</p>
<ul>
<li>If <code>iopt=-1</code>: weighted least-squares spline with user-specified knots.</li>
<li>If <code>iopt&gt;=0</code>: automatic knot placement minimizing the discontinuity jumps of the \( k \)-th derivative, subject to \( F(p) \le S \).</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Computation mode: <code>-1</code> (LSQ), <code>0</code> (new smoothing), <code>1</code> (continue). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points, \( m &gt; 1 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Abscissae (strictly ascending). \( x_m \) defines the period length. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Ordinates \( y_1,\ldots,y_{m-1} \) (element \( y_m \) not used). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Weights \( w_1,\ldots,w_{m-1} &gt; 0 \) ( \( w_m \) not used). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Spline degree, \( 1 \le k \le 5 \). Cubic ( \( k=3 \)) recommended. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor \( S \ge 0 \) (used when <code>iopt&gt;=0</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nest</td><td>Over-estimate of total knots. <code>nest&gt;=2*k+2</code>; <code>nest=m+2*k</code> always suffices. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>Knot positions (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">c</td><td>B-spline coefficients (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace, length \( \ge m(k+1) + \text{nest}(8+5k) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Declared dimension of <code>wrk</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer workspace (length <code>nest</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ier</td><td>Error flag (same codes as curfit, plus periodic constraints).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, 6.1&ndash;6.2; <a class="el" href="#a408ada754639be78ba19d10d4e92d560" title="Core algorithm for univariate periodic spline fitting.">fpperi</a>  core periodic fitting algorithm </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ad0afe8a4afa89245ec1ec1447ef7b556_cgraph.png" border="0" usemap="#anamespacefitpack__core_ad0afe8a4afa89245ec1ec1447ef7b556_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ad0afe8a4afa89245ec1ec1447ef7b556_cgraph" id="anamespacefitpack__core_ad0afe8a4afa89245ec1ec1447ef7b556_cgraph">
<area shape="rect" title="Determine a smooth periodic spline approximation to data." alt="" coords="5,613,156,639"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="873,431,1019,456"/>
<area shape="poly" title=" " alt="" coords="156,634,289,644,371,646,460,643,553,634,646,617,738,591,824,554,855,535,882,511,925,465,929,469,886,515,858,539,827,559,740,596,648,622,554,639,460,648,371,651,288,650,156,639"/>
<area shape="rect" href="namespacefitpack__core.html#accaa1729715efbe04726699613597c32" title=" " alt="" coords="204,664,357,689"/>
<area shape="poly" title=" " alt="" coords="132,636,217,658,216,663,131,641"/>
<area shape="rect" href="namespacefitpack__core.html#a408ada754639be78ba19d10d4e92d560" title="Core algorithm for univariate periodic spline fitting." alt="" coords="207,315,354,340"/>
<area shape="poly" title=" " alt="" coords="88,612,261,350,266,353,93,615"/>
<area shape="poly" title=" " alt="" coords="912,432,905,422,909,412,923,406,946,404,975,408,986,417,983,421,972,413,946,409,924,411,913,416,910,422,916,429"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="425,399,584,439"/>
<area shape="poly" title=" " alt="" coords="307,338,406,385,426,392,424,397,404,390,305,342"/>
<area shape="rect" href="namespacefitpack__core.html#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="405,235,604,260"/>
<area shape="poly" title=" " alt="" coords="312,312,404,277,449,262,451,267,406,282,314,317"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="664,209,813,235"/>
<area shape="poly" title=" " alt="" coords="290,313,335,264,367,239,404,220,470,203,538,197,603,198,661,205,660,210,603,204,538,202,471,208,406,224,370,243,338,268,294,316"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="665,311,813,336"/>
<area shape="poly" title=" " alt="" coords="354,322,405,321,651,320,651,325,405,326,354,327"/>
<area shape="rect" href="namespacefitpack__core.html#ab3c656c52c7e12d25083b56910547f2c" title="Rotate a split observation row into the block&#45;triangular periodic system with scalar RHS." alt="" coords="421,335,589,375"/>
<area shape="poly" title=" " alt="" coords="355,334,407,340,407,346,354,339"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="428,464,581,489"/>
<area shape="poly" title=" " alt="" coords="293,338,338,392,370,423,407,449,423,457,421,462,404,454,367,427,334,396,289,342"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="430,563,579,588"/>
<area shape="poly" title=" " alt="" coords="288,340,300,381,324,438,359,498,381,526,407,549,419,557,416,561,404,553,377,529,354,501,319,440,295,383,283,341"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="431,513,579,539"/>
<area shape="poly" title=" " alt="" coords="290,339,305,372,330,416,364,461,407,500,419,507,416,511,404,504,360,465,326,419,300,375,285,341"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="429,5,580,31"/>
<area shape="poly" title=" " alt="" coords="281,314,290,263,311,189,327,149,348,110,373,73,404,41,415,33,418,37,407,45,377,76,352,113,332,151,316,191,295,264,286,315"/>
<area shape="rect" href="namespacefitpack__core.html#a58bbdfcdf11801b4bacf532b022a2815" title=" " alt="" coords="431,119,578,159"/>
<area shape="poly" title=" " alt="" coords="287,313,331,249,365,210,404,176,425,163,428,168,407,180,369,214,336,252,292,316"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="437,55,572,95"/>
<area shape="poly" title=" " alt="" coords="283,313,297,273,321,217,356,157,378,130,404,105,423,93,426,97,407,109,382,133,360,160,325,220,302,275,288,315"/>
<area shape="poly" title=" " alt="" coords="604,242,658,246,715,256,773,271,827,296,862,322,893,355,934,417,930,420,888,358,859,326,824,300,771,276,714,261,657,252,604,248"/>
<area shape="poly" title=" " alt="" coords="604,234,650,229,651,234,604,239"/>
<area shape="poly" title=" " alt="" coords="546,258,605,277,687,304,685,309,603,282,544,263"/>
<area shape="poly" title=" " alt="" coords="590,369,869,425,868,431,589,375"/>
<area shape="poly" title=" " alt="" coords="540,333,702,239,705,244,542,337"/>
<area shape="poly" title=" " alt="" coords="588,341,651,333,652,338,589,347"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="652,519,825,544"/>
<area shape="poly" title=" " alt="" coords="572,560,657,544,658,549,573,565"/>
<area shape="poly" title=" " alt="" coords="769,516,902,459,904,464,771,521"/>
<area shape="poly" title=" " alt="" coords="705,520,698,510,701,500,715,494,739,492,767,496,779,505,775,509,765,501,739,497,717,499,705,504,703,510,709,517"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="667,63,811,88"/>
<area shape="poly" title=" " alt="" coords="572,73,653,73,653,78,572,78"/>
</map>
</div>

</div>
</div>
<a id="a11ecdd724a417576c9d5529941633da4" name="a11ecdd724a417576c9d5529941633da4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11ecdd724a417576c9d5529941633da4">&#9670;&#160;</a></span>pogrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public fitpack_core::pogrid </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(3), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(2), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ider</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu*mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nvest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nuest-4)*(nvest-4)), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit a smooth bivariate spline to gridded data on a polar (disc) domain. </p>
<p>Fits a function \( f(x,y) \) to data \( z_{ij} \) at the nodes  \( (x,y) = (u_i \cos v_j,\ 
u_i \sin v_j) \) of a radius-angle grid over the disc </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a11ecdd724a417576c9d5529941633da4_cgraph.png" border="0" usemap="#anamespacefitpack__core_a11ecdd724a417576c9d5529941633da4_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a11ecdd724a417576c9d5529941633da4_cgraph" id="anamespacefitpack__core_a11ecdd724a417576c9d5529941633da4_cgraph">
<area shape="rect" title="Fit a smooth bivariate spline to gridded data on a polar (disc) domain." alt="" coords="5,126,156,151"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="1263,263,1408,289"/>
<area shape="poly" title=" " alt="" coords="103,124,167,91,261,51,315,32,373,17,431,6,490,3,911,3,975,12,1060,36,1147,70,1185,90,1216,110,1252,143,1282,181,1324,249,1320,252,1278,184,1248,147,1213,114,1182,94,1145,75,1058,41,974,17,910,8,490,8,432,12,374,22,317,37,263,56,169,95,105,128"/>
<area shape="rect" href="namespacefitpack__core.html#a3e1011bf7749aa62d3c05bd1a20e36d1" title="Verify knot positions against data points (Schoenberg&#45;Whitney check)." alt="" coords="205,150,357,175"/>
<area shape="poly" title=" " alt="" coords="156,145,191,149,190,155,156,150"/>
<area shape="rect" href="namespacefitpack__core.html#accaa1729715efbe04726699613597c32" title=" " alt="" coords="204,199,357,225"/>
<area shape="poly" title=" " alt="" coords="114,149,205,184,228,192,226,197,203,189,112,154"/>
<area shape="rect" href="namespacefitpack__core.html#a3a3d9c76b5b016414056f18b807aa39f" title="Driver for polar grid smoothing spline with knot selection." alt="" coords="205,101,356,126"/>
<area shape="poly" title=" " alt="" coords="156,127,191,122,192,127,156,132"/>
<area shape="poly" title=" " alt="" coords="1302,265,1294,255,1298,245,1312,239,1335,237,1364,240,1375,249,1372,254,1362,245,1335,242,1313,244,1302,249,1300,254,1306,262"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="416,43,567,69"/>
<area shape="poly" title=" " alt="" coords="327,98,430,70,432,75,329,103"/>
<area shape="rect" href="namespacefitpack__core.html#a07a9d1d759c2a6d39e91039f904c923b" title="Compute smoothing spline on a polar grid with origin constraints." alt="" coords="416,222,567,247"/>
<area shape="poly" title=" " alt="" coords="339,124,359,135,376,154,384,172,391,190,407,207,418,214,415,219,404,211,387,193,379,174,371,157,356,139,336,128"/>
<area shape="rect" href="namespacefitpack__core.html#a8c4fa92fbc6556a21d112fbdfbd0f80f" title=" " alt="" coords="405,93,577,133"/>
<area shape="poly" title=" " alt="" coords="357,111,391,111,391,116,357,116"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="424,157,559,197"/>
<area shape="poly" title=" " alt="" coords="324,124,412,151,411,156,323,129"/>
<area shape="rect" href="namespacefitpack__core.html#a03d606165767f7703429cb55181efe11" title="Compute spline coefficients on a polar/spherical grid via Kronecker product." alt="" coords="628,267,775,293"/>
<area shape="poly" title=" " alt="" coords="552,245,629,262,628,267,550,250"/>
<area shape="rect" href="namespacefitpack__core.html#a0055c06b11885b09b3da8a5b9b24d0bb" title="Solve a small symmetric linear system by Cholesky factorization." alt="" coords="625,218,777,243"/>
<area shape="poly" title=" " alt="" coords="567,231,612,230,612,235,567,236"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="830,436,989,476"/>
<area shape="poly" title=" " alt="" coords="713,291,757,353,789,390,827,422,835,427,832,432,824,426,786,393,752,356,708,295"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="825,321,993,361"/>
<area shape="poly" title=" " alt="" coords="746,290,829,315,827,320,744,295"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="825,257,993,297"/>
<area shape="poly" title=" " alt="" coords="775,276,811,276,811,281,775,282"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="825,93,993,133"/>
<area shape="poly" title=" " alt="" coords="759,265,776,254,787,241,794,228,799,201,805,172,812,158,823,143,828,139,832,143,827,147,816,161,810,174,804,202,799,230,791,244,779,258,762,270"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="833,501,986,526"/>
<area shape="poly" title=" " alt="" coords="709,292,723,330,747,383,782,438,803,464,827,486,837,492,834,497,824,490,799,467,777,441,742,385,718,332,704,294"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="833,550,986,575"/>
<area shape="poly" title=" " alt="" coords="708,292,718,339,740,405,776,476,799,508,827,537,833,541,830,546,824,541,795,512,771,479,735,407,713,340,702,294"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="835,386,984,411"/>
<area shape="poly" title=" " alt="" coords="718,291,764,330,827,371,844,379,842,384,824,376,761,334,715,295"/>
<area shape="rect" href="namespacefitpack__core.html#a95f95a1ab846dcf0b4035058fdde4bad" title="LU&#45;decompose a cyclic tridiagonal matrix." alt="" coords="834,43,985,69"/>
<area shape="poly" title=" " alt="" coords="761,265,775,254,791,233,798,212,799,168,799,124,807,102,823,80,830,74,833,78,827,83,812,104,805,125,804,169,803,213,795,235,779,258,764,269"/>
<area shape="rect" href="namespacefitpack__core.html#a3781580dd8295b2e2a32266fd0fcf027" title="Solve a cyclic tridiagonal system using LU factors from fpcyt1." alt="" coords="834,158,985,183"/>
<area shape="poly" title=" " alt="" coords="755,265,776,254,791,239,799,224,808,208,824,193,834,187,836,191,827,197,812,211,804,226,795,242,779,258,757,270"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="835,207,983,233"/>
<area shape="poly" title=" " alt="" coords="745,265,851,234,852,239,747,270"/>
<area shape="poly" title=" " alt="" coords="993,326,1249,286,1250,292,994,331"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="1053,213,1203,238"/>
<area shape="poly" title=" " alt="" coords="966,319,992,307,1048,275,1096,244,1099,248,1051,280,995,312,968,324"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="1054,163,1202,189"/>
<area shape="poly" title=" " alt="" coords="976,319,992,307,1003,294,1009,281,1014,253,1020,226,1027,212,1040,198,1045,194,1049,198,1043,202,1032,215,1025,228,1019,254,1014,283,1007,297,995,311,979,323"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="1041,389,1215,414"/>
<area shape="poly" title=" " alt="" coords="984,359,1069,382,1067,388,982,364"/>
<area shape="poly" title=" " alt="" coords="1149,386,1300,294,1303,298,1151,391"/>
<area shape="poly" title=" " alt="" coords="1094,390,1087,380,1091,370,1105,364,1128,362,1157,366,1168,375,1165,379,1154,371,1128,367,1106,369,1095,374,1092,380,1098,387"/>
<area shape="poly" title=" " alt="" coords="994,274,1249,274,1249,279,994,280"/>
<area shape="poly" title=" " alt="" coords="993,255,1060,239,1061,244,994,260"/>
<area shape="poly" title=" " alt="" coords="969,255,992,243,1006,232,1015,221,1025,209,1040,198,1053,191,1055,196,1043,202,1028,213,1019,224,1010,236,995,248,972,260"/>
<area shape="poly" title=" " alt="" coords="994,106,1046,108,1103,114,1161,127,1216,148,1249,170,1278,197,1321,250,1317,253,1274,201,1246,174,1213,153,1159,132,1102,119,1045,113,994,111"/>
<area shape="poly" title=" " alt="" coords="974,131,995,143,1010,158,1019,172,1028,185,1043,198,1057,205,1054,210,1040,202,1024,188,1015,175,1006,161,992,147,971,136"/>
<area shape="poly" title=" " alt="" coords="980,131,1070,157,1069,162,979,136"/>
<area shape="poly" title=" " alt="" coords="984,397,1027,397,1027,403,984,402"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="629,165,773,190"/>
<area shape="poly" title=" " alt="" coords="559,175,616,175,616,180,559,180"/>
</map>
</div>

</div>
</div>
<a id="a406065ef7b15f1380c2759e9650355f2" name="a406065ef7b15f1380c2759e9650355f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a406065ef7b15f1380c2759e9650355f2">&#9670;&#160;</a></span>polar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::polar </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(3), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">procedure(<a class="el" href="interfacefitpack__core_1_1fitpack__polar__boundary.html">fitpack_polar_boundary</a>)</td>          <td class="paramname"><span class="paramname"><em>rad</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nvest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(out)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(out)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nuest-4)*(nvest-4)), intent(out)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit a smooth bivariate spline to scattered data on a polar domain. </p>
<p>Given weighted data points \( (x_i, y_i, z_i, w_i) \) on a polar domain bounded by  \( x = r(v)\cos v,\ 
y = r(v)\sin v \) for \( -\pi \le v \le \pi \), determines a </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a406065ef7b15f1380c2759e9650355f2_cgraph.png" border="0" usemap="#anamespacefitpack__core_a406065ef7b15f1380c2759e9650355f2_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a406065ef7b15f1380c2759e9650355f2_cgraph" id="anamespacefitpack__core_a406065ef7b15f1380c2759e9650355f2_cgraph">
<area shape="rect" title="Fit a smooth bivariate spline to scattered data on a polar domain." alt="" coords="5,316,148,341"/>
<area shape="rect" href="namespacefitpack__core.html#ac854d9583be2e3e162a00fd43dc20314" title="Core algorithm for spline fitting on a polar domain." alt="" coords="196,316,347,341"/>
<area shape="poly" title=" " alt="" coords="148,326,182,326,182,331,148,331"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="863,208,1008,233"/>
<area shape="poly" title=" " alt="" coords="312,339,352,350,395,358,515,375,611,383,656,380,703,371,755,355,813,330,844,312,872,289,915,242,919,246,876,293,847,316,816,335,757,360,704,377,657,385,611,388,514,380,394,363,351,355,310,344"/>
<area shape="rect" href="namespacefitpack__core.html#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="395,208,593,233"/>
<area shape="poly" title=" " alt="" coords="289,314,335,283,394,250,432,235,434,240,396,255,338,287,292,318"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="653,157,803,183"/>
<area shape="poly" title=" " alt="" coords="278,314,294,288,320,254,354,220,393,193,455,171,519,159,583,155,640,157,639,162,583,161,520,165,456,176,396,198,357,224,324,257,299,291,282,317"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="654,259,802,284"/>
<area shape="poly" title=" " alt="" coords="313,313,394,294,523,278,640,271,640,276,523,284,395,299,314,319"/>
<area shape="rect" href="namespacefitpack__core.html#aa452051613d61831a99b2f9ef8e21bc8" title="Rotate a smoothing&#45;matrix row into a band matrix using shifted pivots." alt="" coords="410,309,578,349"/>
<area shape="poly" title=" " alt="" coords="347,326,396,326,396,331,347,331"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="417,424,571,449"/>
<area shape="poly" title=" " alt="" coords="292,339,338,370,396,402,434,417,432,422,394,407,335,375,289,344"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="419,5,569,31"/>
<area shape="poly" title=" " alt="" coords="272,315,282,266,303,194,319,155,339,116,363,80,393,48,413,34,416,39,396,52,368,83,344,119,324,157,308,196,287,267,277,317"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="641,56,815,81"/>
<area shape="poly" title=" " alt="" coords="272,315,283,270,305,209,321,176,340,144,365,115,393,92,423,75,455,63,521,50,587,47,647,52,646,57,587,53,522,55,456,68,425,80,396,96,368,119,345,147,325,178,310,211,288,272,278,316"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="420,473,568,499"/>
<area shape="poly" title=" " alt="" coords="283,340,326,397,359,430,396,458,411,466,409,471,393,463,355,434,322,401,279,343"/>
<area shape="rect" href="namespacefitpack__core.html#a000e6860b30d66fcc8bf487d934c0f28" title="Sort scattered data points into rectangular panels." alt="" coords="419,523,569,548"/>
<area shape="poly" title=" " alt="" coords="280,340,295,374,319,420,353,468,374,489,396,508,408,515,405,519,393,512,370,493,349,471,315,423,290,377,275,343"/>
<area shape="rect" href="namespacefitpack__core.html#ab08555e9bd2f44d1461e09ba35a7bb22" title="Compute the minimum&#45;norm least&#45;squares solution under rank deficiency." alt="" coords="419,107,569,132"/>
<area shape="poly" title=" " alt="" coords="276,315,291,282,316,237,351,190,393,149,419,135,421,139,396,153,355,194,321,240,296,284,280,317"/>
<area shape="rect" href="namespacefitpack__core.html#a85e2e23efd601e9e1e28c0195664dd16" title="Convert constrained polar spline coefficients to standard form." alt="" coords="419,572,569,597"/>
<area shape="poly" title=" " alt="" coords="278,341,290,383,313,442,348,504,370,533,396,557,407,565,404,569,393,561,366,536,343,507,308,444,285,385,273,342"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="427,622,561,662"/>
<area shape="poly" title=" " alt="" coords="277,341,287,390,308,462,323,502,343,540,367,576,396,608,416,621,413,626,393,612,363,580,339,543,319,504,303,464,282,392,272,342"/>
<area shape="poly" title=" " alt="" coords="902,210,894,200,898,190,912,184,935,181,964,185,975,194,972,198,962,190,935,187,913,189,902,193,900,199,906,206"/>
<area shape="poly" title=" " alt="" coords="594,218,849,218,849,223,594,223"/>
<area shape="poly" title=" " alt="" coords="553,205,655,183,656,188,554,210"/>
<area shape="poly" title=" " alt="" coords="554,231,656,253,655,258,553,236"/>
<area shape="poly" title=" " alt="" coords="578,328,692,320,754,309,814,293,864,268,906,240,909,244,867,273,816,298,755,314,692,325,578,333"/>
<area shape="poly" title=" " alt="" coords="523,306,695,189,698,193,526,311"/>
<area shape="poly" title=" " alt="" coords="576,306,662,285,663,290,577,311"/>
<area shape="poly" title=" " alt="" coords="554,28,656,50,655,56,553,33"/>
<area shape="poly" title=" " alt="" coords="775,79,816,98,847,121,875,147,918,195,914,199,871,151,843,125,813,103,773,84"/>
<area shape="poly" title=" " alt="" coords="694,58,687,48,691,38,705,32,728,29,757,33,768,42,765,46,754,38,728,35,706,37,695,41,692,47,698,54"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="649,515,807,555"/>
<area shape="poly" title=" " alt="" coords="570,533,634,533,634,538,570,538"/>
<area shape="poly" title=" " alt="" coords="570,113,687,117,752,126,816,142,868,167,910,197,907,201,865,172,814,147,751,131,686,122,570,118"/>
<area shape="poly" title=" " alt="" coords="554,130,656,152,655,157,553,135"/>
<area shape="poly" title=" " alt="" coords="516,130,697,249,694,253,513,134"/>
<area shape="poly" title=" " alt="" coords="553,104,655,82,656,87,554,109"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="656,629,800,655"/>
<area shape="poly" title=" " alt="" coords="562,639,642,639,642,645,562,645"/>
</map>
</div>

</div>
</div>
<a id="a7ea4ba8b0cda533eb078e95b28d782db" name="a7ea4ba8b0cda533eb078e95b28d782db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ea4ba8b0cda533eb078e95b28d782db">&#9670;&#160;</a></span>profil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::profil </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ny), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nx-kx-1)*(ny-ky-1)), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(out)</td>          <td class="paramname"><span class="paramname"><em>cu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract a cross-section (profile) of a bivariate spline. </p>
<p>Given a bivariate spline \( s(x,y) \), computes the B-spline coefficients of a univariate cross-section:</p>
<ul>
<li><code>iopt=0</code>: \( f(y) = s(u, y) \)  profile at fixed \( x = u \).</li>
<li><code>iopt=1</code>: \( g(x) = s(x, u) \)  profile at fixed \( y = u \).</li>
</ul>
<p>The resulting 1-D spline can be evaluated using splev or other univariate routines.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Profile direction: <code>0</code> = fix \( x \), extract \( f(y) \); <code>1</code> = fix \( y \), extract \( g(x) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>Knot positions in \( x \)-direction (length \( n_x \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Total number of knots in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ty</td><td>Knot positions in \( y \)-direction (length \( n_y \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Total number of knots in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients, length \( (n_x{-}k_x{-}1)(n_y{-}k_y{-}1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Degree in \( x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Degree in \( y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Cross-section coordinate. Must satisfy \( t_{k_x+1} \le u \le t_{n_x-k_x} \) if <code>iopt=0</code>, or \( t_{k_y+1} \le u \le t_{n_y-k_y} \) if <code>iopt=1</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Declared dimension of <code>cu</code>. Must be \( \ge n_y \) if <code>iopt=0</code>, \( \ge n_x \) if <code>iopt=1</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cu</td><td>B-spline coefficients of the 1-D cross-section (length <code>nu</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#aac8fa7ec692eb2758290f050c302d22d" title="Evaluate a bivariate spline on a rectangular grid.">bispev</a>  full surface evaluation; <a class="el" href="#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non-zero B-splines at a given point.">fpbspl</a>  B-spline basis evaluation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a7ea4ba8b0cda533eb078e95b28d782db_cgraph.png" border="0" usemap="#anamespacefitpack__core_a7ea4ba8b0cda533eb078e95b28d782db_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a7ea4ba8b0cda533eb078e95b28d782db_cgraph" id="anamespacefitpack__core_a7ea4ba8b0cda533eb078e95b28d782db_cgraph">
<area shape="rect" title="Extract a cross&#45;section (profile) of a bivariate spline." alt="" coords="5,29,148,55"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="196,29,345,55"/>
<area shape="poly" title=" " alt="" coords="148,39,183,39,183,45,148,45"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="393,29,567,55"/>
<area shape="poly" title=" " alt="" coords="345,39,380,39,380,45,345,45"/>
<area shape="poly" title=" " alt="" coords="446,31,439,21,443,11,457,5,480,3,509,6,520,15,517,20,506,11,480,8,458,10,447,15,444,20,450,28"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="615,29,760,55"/>
<area shape="poly" title=" " alt="" coords="567,39,601,39,601,45,567,45"/>
<area shape="poly" title=" " alt="" coords="654,31,646,21,650,11,664,5,687,3,716,6,727,15,724,20,714,11,687,8,665,10,654,15,652,20,658,28"/>
</map>
</div>

</div>
</div>
<a id="adba4c1c277c572cad2725b326b896ef8" name="adba4c1c277c572cad2725b326b896ef8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adba4c1c277c572cad2725b326b896ef8">&#9670;&#160;</a></span>regrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::regrid </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>my</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(my), intent(in)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mx*my), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xe</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>yb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ye</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nxest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nyest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nxest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nyest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nxest-kx-1)*(nyest-ky-1)), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit a smoothing bivariate spline to data on a rectangular grid. </p>
<p>Determines a smooth bivariate spline \( s(x,y) \) of degrees \( k_x, k_y \) approximating data values \( z_{ij} \) at the grid nodes \( (x_i, y_j) \),   \( i=1,\ldots,m_x;\ 

          j=1,\ldots,m_y \), on the rectangle \( [x_b, x_e] \times [y_b, y_e] \).</p>
<p>The smoothing factor \( s \ge 0 \) controls the trade-off: the routine minimizes discontinuity jumps in the spline derivatives subject to   </p><p class="formulaDsp">
\[              \sum_{i=1}^{m_x} \sum_{j=1}^{m_y} \bigl(z_{ij} - s(x_i, y_j)\bigr)^2 \le s.
\]
</p>
<p> Setting \( s = 0 \) produces an interpolating spline.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Computation mode: <code>-1</code> = least-squares with user knots; <code>0</code> = smoothing, fresh start; <code>1</code> = smoothing, continue with previous knots. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Number of grid points along \( x \), \( m_x &gt; k_x \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Strictly increasing \( x \)-grid coordinates (length \( m_x \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">my</td><td>Number of grid points along \( y \), \( m_y &gt; k_y \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>Strictly increasing \( y \)-grid coordinates (length \( m_y \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values, length \( m_x \cdot m_y \): <code>z(my*(i-1)+j)</code> = value at \( (x_i, y_j) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xb</td><td>Lower \( x \)-boundary, \( x_b \le x_1 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xe</td><td>Upper \( x \)-boundary, \( x_e \ge x_{m_x} \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yb</td><td>Lower \( y \)-boundary, \( y_b \le y_1 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>Upper \( y \)-boundary, \( y_e \ge y_{m_y} \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Degree in \( x \), \( 1 \le k_x \le 5 \) (bicubic \( k_x{=}3 \) recommended). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Degree in \( y \), \( 1 \le k_y \le 5 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor, \( s \ge 0 \) (ignored when <code>iopt=-1</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nxest</td><td>Upper bound for \( n_x \), \( \ge 2(k_x{+}1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nyest</td><td>Upper bound for \( n_y \), \( \ge 2(k_y{+}1) \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nx</td><td>Total number of knots in \( x \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tx</td><td>Knot positions in \( x \) (length <code>nxest</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ny</td><td>Total number of knots in \( y \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ty</td><td>Knot positions in \( y \) (length <code>nyest</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">c</td><td>B-spline coefficients, length \( (n_x{-}k_x{-}1)(n_y{-}k_y{-}1) \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fp</td><td>Sum of squared residuals \( F_p \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace (length <code>lwrk</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk</td><td>Declared dimension of <code>wrk</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer workspace (length <code>kwrk</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kwrk</td><td>Declared dimension of <code>iwrk</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: \( \le 0 \) = success, <code>1</code><code>5</code> = convergence warnings, <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Unlike surfit, this routine exploits the grid structure for a significantly faster algorithm.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 5, 5.4 (pp. 117121); <a class="el" href="#ac3ec431477bdf8868e8aff1cc3f5ab51" title="Fit a smoothing bivariate spline to scattered data.">surfit</a>  scattered-data variant; Dierckx (1982), <em>SIAM J. Numer. Anal.</em> 19, 12861304 </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_adba4c1c277c572cad2725b326b896ef8_cgraph.png" border="0" usemap="#anamespacefitpack__core_adba4c1c277c572cad2725b326b896ef8_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_adba4c1c277c572cad2725b326b896ef8_cgraph" id="anamespacefitpack__core_adba4c1c277c572cad2725b326b896ef8_cgraph">
<area shape="rect" title="Fit a smoothing bivariate spline to data on a rectangular grid." alt="" coords="5,341,152,366"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="1057,174,1203,199"/>
<area shape="poly" title=" " alt="" coords="152,351,485,351,705,351,765,346,824,334,881,316,936,294,1031,246,1098,205,1101,209,1033,251,938,299,883,321,825,339,765,352,705,356,485,356,152,356"/>
<area shape="rect" href="namespacefitpack__core.html#a3e1011bf7749aa62d3c05bd1a20e36d1" title="Verify knot positions against data points (Schoenberg&#45;Whitney check)." alt="" coords="200,391,352,417"/>
<area shape="poly" title=" " alt="" coords="130,364,213,385,212,390,128,369"/>
<area shape="rect" href="namespacefitpack__core.html#a26879f854f0e23671e8fd07f9f144410" title="Driver for rectangular grid smoothing surface with knot selection." alt="" coords="202,127,350,153"/>
<area shape="poly" title=" " alt="" coords="90,339,252,161,256,165,94,342"/>
<area shape="poly" title=" " alt="" coords="1096,176,1089,166,1093,156,1107,150,1130,147,1159,151,1170,160,1167,164,1156,156,1130,153,1108,155,1097,159,1094,165,1100,172"/>
<area shape="rect" href="namespacefitpack__core.html#a78b0d9c28e76eff73dcf956f4811c257" title="Compute grid&#45;based spline coefficients via Kronecker product decomposition." alt="" coords="412,185,560,210"/>
<area shape="poly" title=" " alt="" coords="324,150,427,178,425,184,323,155"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="411,70,561,95"/>
<area shape="poly" title=" " alt="" coords="323,125,425,96,427,102,324,130"/>
<area shape="rect" href="namespacefitpack__core.html#a8c4fa92fbc6556a21d112fbdfbd0f80f" title=" " alt="" coords="400,120,572,160"/>
<area shape="poly" title=" " alt="" coords="350,137,386,137,386,143,350,143"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="419,5,553,45"/>
<area shape="poly" title=" " alt="" coords="292,125,339,91,399,55,412,48,415,53,401,60,342,96,295,129"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="620,176,788,216"/>
<area shape="poly" title=" " alt="" coords="560,194,606,194,606,199,560,200"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="620,112,788,152"/>
<area shape="poly" title=" " alt="" coords="529,182,571,169,624,153,625,159,573,175,531,187"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="627,241,781,266"/>
<area shape="poly" title=" " alt="" coords="537,207,641,235,640,240,536,213"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="629,62,779,87"/>
<area shape="poly" title=" " alt="" coords="547,182,570,170,586,153,594,135,602,116,618,98,630,91,633,95,622,102,606,119,598,137,590,156,574,174,550,187"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="630,290,778,315"/>
<area shape="poly" title=" " alt="" coords="506,208,557,242,621,276,639,283,637,288,619,281,554,246,503,212"/>
<area shape="poly" title=" " alt="" coords="759,214,797,225,836,233,923,243,961,241,1009,233,1053,220,1092,203,1094,208,1055,225,1010,239,961,247,923,249,836,239,796,230,758,219"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="848,149,997,174"/>
<area shape="poly" title=" " alt="" coords="788,180,834,173,835,178,789,185"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="849,198,997,223"/>
<area shape="poly" title=" " alt="" coords="788,199,835,202,835,207,788,204"/>
<area shape="poly" title=" " alt="" coords="788,122,894,120,953,125,1010,133,1055,147,1095,165,1093,170,1053,152,1009,139,952,130,894,126,788,127"/>
<area shape="poly" title=" " alt="" coords="789,141,835,147,834,152,788,146"/>
<area shape="poly" title=" " alt="" coords="759,150,789,162,837,183,862,191,860,196,835,188,787,166,757,155"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="836,47,1009,73"/>
<area shape="poly" title=" " alt="" coords="779,67,822,64,822,69,779,72"/>
<area shape="poly" title=" " alt="" coords="967,70,1011,90,1064,126,1107,162,1104,166,1061,130,1008,94,965,75"/>
<area shape="poly" title=" " alt="" coords="889,49,882,39,885,29,899,23,923,21,951,24,963,33,959,38,949,29,923,26,901,28,889,33,887,38,893,46"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="632,13,776,38"/>
<area shape="poly" title=" " alt="" coords="554,23,618,23,618,28,554,28"/>
</map>
</div>

</div>
</div>
<a id="afd90889b0d56592815337f99a849bc7a" name="afd90889b0d56592815337f99a849bc7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd90889b0d56592815337f99a849bc7a">&#9670;&#160;</a></span>root_finding_iterate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental subroutine fitpack_core::root_finding_iterate </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>p1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>f1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>p2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>f2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>p3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>f3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>fpms</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>acc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>check1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>check3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>success</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_afd90889b0d56592815337f99a849bc7a_cgraph.png" border="0" usemap="#anamespacefitpack__core_afd90889b0d56592815337f99a849bc7a_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_afd90889b0d56592815337f99a849bc7a_cgraph" id="anamespacefitpack__core_afd90889b0d56592815337f99a849bc7a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,140,45"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="188,13,332,38"/>
<area shape="poly" title=" " alt="" coords="140,23,175,23,175,28,140,28"/>
</map>
</div>

</div>
</div>
<a id="a0c64b88d2d403641e200a68c9604f425" name="a0c64b88d2d403641e200a68c9604f425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c64b88d2d403641e200a68c9604f425">&#9670;&#160;</a></span>spalde()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::spalde </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(k1), intent(out)</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate all derivatives of a spline at a single point. </p>
<p>Given a spline \( s(x) \) of order \( k_1 = k + 1 \) (degree \( k \)) in B-spline representation, computes \( d_j = s^{(j-1)}(x) \) for \( j = 1,\ldots,k_1 \) using the stable recurrence scheme of de Boor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot positions (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k1</td><td>Order of the spline ( \( k_1 = k + 1 \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Point where derivatives are evaluated. Must satisfy \( t_{k_1} \le x \le t_{n-k_1+1} \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d</td><td>Derivative values (length \( k_1 \)): \( d(j) = s^{(j-1)}(x) \) for \( j = 1,\ldots,k_1 \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>At a knot, right derivatives are computed (left derivatives at the right boundary).</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, 1.3; <a class="el" href="#ab6b368d82e72f0bde7c8a9cc60eb76f2">fpader</a>  derivative computation kernel </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a0c64b88d2d403641e200a68c9604f425_cgraph.png" border="0" usemap="#anamespacefitpack__core_a0c64b88d2d403641e200a68c9604f425_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a0c64b88d2d403641e200a68c9604f425_cgraph" id="anamespacefitpack__core_a0c64b88d2d403641e200a68c9604f425_cgraph">
<area shape="rect" title="Evaluate all derivatives of a spline at a single point." alt="" coords="5,42,157,67"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="205,5,364,45"/>
<area shape="poly" title=" " alt="" coords="157,41,191,36,192,41,158,46"/>
<area shape="rect" href="namespacefitpack__core.html#ab6b368d82e72f0bde7c8a9cc60eb76f2" title=" " alt="" coords="209,70,360,95"/>
<area shape="poly" title=" " alt="" coords="158,62,196,68,196,73,157,68"/>
</map>
</div>

</div>
</div>
<a id="a30c8a4cf89f70ba6c63596bfdcdc3d4e" name="a30c8a4cf89f70ba6c63596bfdcdc3d4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30c8a4cf89f70ba6c63596bfdcdc3d4e">&#9670;&#160;</a></span>spgrid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::spgrid </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(3), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(4), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ider</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu*mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nuest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nvest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nuest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nvest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nuest-4)*(nvest-4)), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit a smooth bivariate spline to gridded data on a sphere (latitude-longitude grid). </p>
<p>Given data values \( r_{ij} \) on the latitude-longitude grid \( (u_i, v_j) \) with \( 0 &lt; u_i &lt; \pi \) (colatitude), \( v_b \le v_j &lt; v_b + 2\pi \) (longitude), determines a bicubic spline \( s(u,v) \) satisfying pole continuity constraints (value and optional gradient at \( u=0 \) and \( u=\pi \)) and periodicity in \( v \):   </p><p class="formulaDsp">
\[              \sum_{i,j}(r_{ij} - s(u_i,v_j))^2 + (r_0 - s(0,v))^2 + (r_1 - s(\pi,v))^2 \le s.
\]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Integer array(3): <code>iopt(1)</code> = computation mode (<code>-1</code>/<code>0</code>/<code>1</code>); <code>iopt(2)</code> = continuity order at pole \( u=0 \) (<code>0</code>/<code>1</code>); <code>iopt(3)</code> = continuity order at pole \( u=\pi \) (<code>0</code>/<code>1</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ider</td><td>Integer array(4): pole data/derivative flags  <code>ider(1)</code> and <code>ider(3)</code> specify whether data at poles exist; <code>ider(2)</code> and <code>ider(4)</code> specify vanishing derivatives. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>Number of latitude grid points, \( 0 &lt; u_i &lt; \pi \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>Strictly increasing colatitudes (length \( m_u \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mv</td><td>Number of longitude grid points, \( m_v &gt; 3 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Strictly increasing longitudes (length \( m_v \)),  \( -\pi \le v_1 &lt; \pi,\ 
v_{m_v} &lt; v_1 + 2\pi \). </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a30c8a4cf89f70ba6c63596bfdcdc3d4e_cgraph.png" border="0" usemap="#anamespacefitpack__core_a30c8a4cf89f70ba6c63596bfdcdc3d4e_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a30c8a4cf89f70ba6c63596bfdcdc3d4e_cgraph" id="anamespacefitpack__core_a30c8a4cf89f70ba6c63596bfdcdc3d4e_cgraph">
<area shape="rect" title="Fit a smooth bivariate spline to gridded data on a sphere (latitude&#45;longitude grid)." alt="" coords="5,126,155,151"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="1261,263,1407,289"/>
<area shape="poly" title=" " alt="" coords="102,124,166,91,260,51,314,32,371,17,430,6,489,3,910,3,974,12,1059,36,1145,70,1184,90,1215,110,1251,143,1281,181,1323,249,1318,252,1277,184,1247,147,1212,114,1181,94,1143,75,1057,41,973,17,909,8,489,8,431,12,372,22,316,37,262,56,168,95,105,128"/>
<area shape="rect" href="namespacefitpack__core.html#a3e1011bf7749aa62d3c05bd1a20e36d1" title="Verify knot positions against data points (Schoenberg&#45;Whitney check)." alt="" coords="203,150,355,175"/>
<area shape="poly" title=" " alt="" coords="155,145,190,149,189,155,155,150"/>
<area shape="rect" href="namespacefitpack__core.html#accaa1729715efbe04726699613597c32" title=" " alt="" coords="203,199,356,225"/>
<area shape="poly" title=" " alt="" coords="113,149,204,184,227,192,225,197,202,189,111,154"/>
<area shape="rect" href="namespacefitpack__core.html#ae2fd0d6545f3ff0cc2019428c3d5ad38" title="Driver for spherical grid smoothing spline with knot selection." alt="" coords="204,101,355,126"/>
<area shape="poly" title=" " alt="" coords="155,127,190,122,191,127,155,132"/>
<area shape="poly" title=" " alt="" coords="1300,265,1293,255,1297,245,1311,239,1334,237,1363,240,1374,249,1371,254,1360,245,1334,242,1312,244,1301,249,1298,254,1304,262"/>
<area shape="rect" href="namespacefitpack__core.html#a8357b7623d6629bc3663f8023fcd6666" title="Select and insert a new knot at the location of maximum residual." alt="" coords="415,43,565,69"/>
<area shape="poly" title=" " alt="" coords="326,98,429,70,430,75,328,103"/>
<area shape="rect" href="namespacefitpack__core.html#a383ad79ef10f0ff29a9122c3f736178e" title="Compute smoothing spline on a spherical grid with pole constraints." alt="" coords="413,222,567,247"/>
<area shape="poly" title=" " alt="" coords="337,124,358,135,374,154,382,172,390,190,406,207,417,214,414,219,402,211,386,193,377,174,370,157,354,139,335,128"/>
<area shape="rect" href="namespacefitpack__core.html#a8c4fa92fbc6556a21d112fbdfbd0f80f" title=" " alt="" coords="404,93,576,133"/>
<area shape="poly" title=" " alt="" coords="355,111,390,111,390,116,355,116"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="423,157,557,197"/>
<area shape="poly" title=" " alt="" coords="323,124,411,151,410,156,321,129"/>
<area shape="rect" href="namespacefitpack__core.html#a74a11f85ace5b032c95c53307fa47913" title="Compute spherical grid spline coefficients via Kronecker product." alt="" coords="625,267,775,293"/>
<area shape="poly" title=" " alt="" coords="550,245,628,262,627,267,549,250"/>
<area shape="rect" href="namespacefitpack__core.html#a0055c06b11885b09b3da8a5b9b24d0bb" title="Solve a small symmetric linear system by Cholesky factorization." alt="" coords="624,218,776,243"/>
<area shape="poly" title=" " alt="" coords="567,231,610,230,610,235,567,236"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="829,436,987,476"/>
<area shape="poly" title=" " alt="" coords="711,291,755,353,788,390,826,422,834,427,831,432,822,426,784,393,751,356,707,295"/>
<area shape="rect" href="namespacefitpack__core.html#abba3243913c5e568249cd4d789a2b1d2" title="Rotate a split row into the block&#45;triangular periodic system with stride RHS." alt="" coords="824,321,992,361"/>
<area shape="poly" title=" " alt="" coords="745,290,828,315,826,320,743,295"/>
<area shape="rect" href="namespacefitpack__core.html#aed0bf32d459d0a6b5f61a5f43b4a038d" title="Rotate a row into a band matrix with contiguous&#45;block RHS." alt="" coords="824,257,992,297"/>
<area shape="poly" title=" " alt="" coords="775,276,810,276,810,281,775,282"/>
<area shape="rect" href="namespacefitpack__core.html#aa701068a010acc01614dbdb3d2d0af77" title="Rotate a row into a band matrix with stride (row&#45;access) RHS." alt="" coords="824,93,992,133"/>
<area shape="poly" title=" " alt="" coords="757,265,774,254,786,241,792,228,798,201,803,172,810,158,822,143,827,139,830,143,826,147,815,161,808,174,803,202,797,230,790,244,778,258,760,270"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="831,501,985,526"/>
<area shape="poly" title=" " alt="" coords="708,292,722,330,746,383,780,438,802,464,826,486,835,492,832,497,822,490,798,467,776,441,741,385,717,332,703,294"/>
<area shape="rect" href="namespacefitpack__core.html#ae7f22eea056465653c17c25aaf23b06f" title="Solve a bordered upper triangular system by back&#45;substitution." alt="" coords="831,550,985,575"/>
<area shape="poly" title=" " alt="" coords="706,292,717,339,739,405,774,476,798,508,826,537,832,541,829,546,822,541,794,512,770,479,734,407,712,340,701,294"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="833,386,983,411"/>
<area shape="poly" title=" " alt="" coords="717,291,763,330,825,371,843,379,841,384,823,376,760,334,713,295"/>
<area shape="rect" href="namespacefitpack__core.html#a95f95a1ab846dcf0b4035058fdde4bad" title="LU&#45;decompose a cyclic tridiagonal matrix." alt="" coords="833,43,983,69"/>
<area shape="poly" title=" " alt="" coords="759,265,774,254,789,233,796,212,797,168,798,124,806,102,822,80,828,74,832,78,826,83,810,104,803,125,803,169,802,213,794,235,778,258,762,269"/>
<area shape="rect" href="namespacefitpack__core.html#a3781580dd8295b2e2a32266fd0fcf027" title="Solve a cyclic tridiagonal system using LU factors from fpcyt1." alt="" coords="833,158,983,183"/>
<area shape="poly" title=" " alt="" coords="753,265,774,254,789,239,798,224,806,208,822,193,832,187,835,191,826,197,811,211,802,226,794,242,778,258,756,270"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="834,207,982,233"/>
<area shape="poly" title=" " alt="" coords="744,265,849,234,851,239,746,270"/>
<area shape="poly" title=" " alt="" coords="992,326,1247,286,1248,292,993,331"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="1052,213,1201,238"/>
<area shape="poly" title=" " alt="" coords="964,319,991,307,1047,275,1095,244,1098,248,1050,280,993,312,967,324"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="1053,163,1201,189"/>
<area shape="poly" title=" " alt="" coords="974,319,990,307,1001,294,1008,281,1013,253,1018,226,1026,212,1038,198,1044,194,1047,198,1042,202,1030,215,1024,228,1018,254,1013,283,1006,297,994,311,977,323"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="1040,389,1213,414"/>
<area shape="poly" title=" " alt="" coords="983,359,1067,382,1066,388,981,364"/>
<area shape="poly" title=" " alt="" coords="1147,386,1299,294,1302,298,1150,391"/>
<area shape="poly" title=" " alt="" coords="1093,390,1086,380,1089,370,1103,364,1127,362,1155,366,1167,375,1163,379,1153,371,1127,367,1105,369,1093,374,1091,380,1097,387"/>
<area shape="poly" title=" " alt="" coords="992,274,1248,274,1248,279,992,280"/>
<area shape="poly" title=" " alt="" coords="992,255,1058,239,1059,244,993,260"/>
<area shape="poly" title=" " alt="" coords="968,255,991,243,1004,232,1014,221,1023,209,1039,198,1052,191,1054,196,1041,202,1027,213,1018,224,1008,236,993,248,971,260"/>
<area shape="poly" title=" " alt="" coords="992,106,1044,108,1101,114,1159,127,1215,148,1248,170,1277,197,1319,250,1315,253,1273,201,1245,174,1212,153,1158,132,1100,119,1044,113,992,111"/>
<area shape="poly" title=" " alt="" coords="972,131,994,143,1009,158,1018,172,1027,185,1042,198,1055,205,1053,210,1038,202,1023,188,1013,175,1005,161,990,147,970,136"/>
<area shape="poly" title=" " alt="" coords="979,131,1069,157,1068,162,978,136"/>
<area shape="poly" title=" " alt="" coords="983,397,1026,397,1026,403,983,402"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="628,165,772,190"/>
<area shape="poly" title=" " alt="" coords="558,175,614,175,614,180,558,180"/>
</map>
</div>

</div>
</div>
<a id="aacb3cc3cd0d0028ebcb2525dc3a6001e" name="aacb3cc3cd0d0028ebcb2525dc3a6001e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacb3cc3cd0d0028ebcb2525dc3a6001e">&#9670;&#160;</a></span>sphere()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::sphere </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>teta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>phi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>r</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ntest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>npest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(ntest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>np</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(npest), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((ntest-4)*(npest-4)), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit a smooth bicubic spherical spline to scattered data on a sphere. </p>
<p>Given weighted data points \( (\theta_i, \phi_i, r_i, w_i) \), \( i=1,\ldots,m \), with \( 0 \le \theta \le \pi \) (colatitude) and \( 0 \le \phi \le 2\pi \) (longitude), determines a bicubic spline \( s(\theta, \phi) \) satisfying:</p>
<ul>
<li>Pole constraints: \( s(0,\phi) \) and \( s(\pi,\phi) \) are constant.</li>
<li>Periodicity in \( \phi \): derivatives match at \( \phi = 0 \) and \( \phi = 2\pi \).</li>
<li>Gradient constraints at poles for smooth angular dependence.</li>
</ul>
<p>The smoothing factor \( s \ge 0 \) controls the trade-off:   </p><p class="formulaDsp">
\[              \sum_{i=1}^{m} \bigl[w_i\,(r_i - s(\theta_i, \phi_i))\bigr]^2 \le s.
\]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Computation mode: <code>-1</code> = least-squares with user knots; <code>0</code> = smoothing, fresh start; <code>1</code> = smoothing, continue. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points, \( m \ge 2 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">teta</td><td>Colatitudes \( \theta_i \in [0, \pi] \) (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">phi</td><td>Longitudes \( \phi_i \in [0, 2\pi] \) (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r</td><td>Data values (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Positive weights (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor, \( s \ge 0 \) (ignored when <code>iopt=-1</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntest</td><td>Upper bound for \( n_\theta \), \( \ge 8 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npest</td><td>Upper bound for \( n_\phi \), \( \ge 8 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eps</td><td>Rank-deficiency threshold, \( 0 &lt; \varepsilon &lt; 1 \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nt</td><td>Total number of knots in \( \theta \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tt</td><td>Knot positions in \( \theta \) (length <code>ntest</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">np</td><td>Total number of knots in \( \phi \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tp</td><td>Knot positions in \( \phi \) (length <code>npest</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">c</td><td>B-spline coefficients, length \( (n_\theta{-}4)(n_\phi{-}4) \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals \( F_p \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk1</td><td>Real workspace (length <code>lwrk1</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk1</td><td>Declared dimension of <code>wrk1</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk2</td><td>Secondary workspace for rank-deficient systems (length <code>lwrk2</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk2</td><td>Declared dimension of <code>wrk2</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer workspace (length <code>kwrk</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kwrk</td><td>Declared dimension of <code>iwrk</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: \( \le 0 \) = success, <code>1</code><code>5</code> = convergence warnings, <code>10</code> = invalid input, <code>&gt;10</code> = <code>lwrk2</code> too small.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 11, 11.2 (pp. 254270); <a class="el" href="#a30c8a4cf89f70ba6c63596bfdcdc3d4e" title="Fit a smooth bivariate spline to gridded data on a sphere (latitude-longitude grid).">spgrid</a>  gridded spherical variant </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_aacb3cc3cd0d0028ebcb2525dc3a6001e_cgraph.png" border="0" usemap="#anamespacefitpack__core_aacb3cc3cd0d0028ebcb2525dc3a6001e_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_aacb3cc3cd0d0028ebcb2525dc3a6001e_cgraph" id="anamespacefitpack__core_aacb3cc3cd0d0028ebcb2525dc3a6001e_cgraph">
<area shape="rect" title="Fit a smooth bicubic spherical spline to scattered data on a sphere." alt="" coords="5,316,159,341"/>
<area shape="rect" href="namespacefitpack__core.html#a6b16cd0ae09d295a9bdf3723c10db8e7" title="Core algorithm for spline fitting on the sphere." alt="" coords="207,316,360,341"/>
<area shape="poly" title=" " alt="" coords="159,326,193,326,193,331,159,331"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="876,208,1021,233"/>
<area shape="poly" title=" " alt="" coords="324,339,365,350,408,358,528,375,624,383,669,380,716,371,768,355,827,330,858,312,886,289,928,242,932,246,889,293,861,316,829,335,770,360,718,377,670,385,624,388,528,380,408,363,363,355,323,344"/>
<area shape="rect" href="namespacefitpack__core.html#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="408,208,607,233"/>
<area shape="poly" title=" " alt="" coords="301,314,348,283,407,250,446,235,448,240,409,255,350,287,304,318"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="667,157,816,183"/>
<area shape="poly" title=" " alt="" coords="290,314,307,288,333,254,367,220,407,193,468,171,533,159,596,156,653,157,653,162,596,161,533,165,470,176,409,198,370,224,337,257,311,291,294,317"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="667,259,815,284"/>
<area shape="poly" title=" " alt="" coords="325,313,408,294,536,278,653,271,654,276,537,284,408,299,327,319"/>
<area shape="rect" href="namespacefitpack__core.html#aa452051613d61831a99b2f9ef8e21bc8" title="Rotate a smoothing&#45;matrix row into a band matrix using shifted pivots." alt="" coords="423,309,591,349"/>
<area shape="poly" title=" " alt="" coords="360,326,409,326,409,331,360,331"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="431,424,584,449"/>
<area shape="poly" title=" " alt="" coords="304,339,350,370,409,402,448,417,446,422,407,407,348,375,301,344"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="433,5,582,31"/>
<area shape="poly" title=" " alt="" coords="284,315,294,266,316,194,332,155,352,116,377,80,406,48,427,34,430,39,410,52,381,83,357,119,337,157,321,196,299,267,289,317"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="655,56,828,81"/>
<area shape="poly" title=" " alt="" coords="284,315,295,270,317,209,334,176,354,144,378,115,407,92,436,75,468,63,534,50,600,47,660,52,659,57,600,53,535,55,469,69,438,80,409,96,381,119,358,147,338,178,322,211,300,272,290,316"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="433,473,581,499"/>
<area shape="poly" title=" " alt="" coords="295,340,339,397,372,430,409,458,425,466,422,471,407,463,368,434,335,401,291,343"/>
<area shape="rect" href="namespacefitpack__core.html#a000e6860b30d66fcc8bf487d934c0f28" title="Sort scattered data points into rectangular panels." alt="" coords="432,523,583,548"/>
<area shape="poly" title=" " alt="" coords="292,340,307,374,332,420,366,468,387,489,410,508,421,515,418,519,406,512,383,493,362,471,328,423,302,377,287,343"/>
<area shape="rect" href="namespacefitpack__core.html#ab08555e9bd2f44d1461e09ba35a7bb22" title="Compute the minimum&#45;norm least&#45;squares solution under rank deficiency." alt="" coords="432,107,583,132"/>
<area shape="poly" title=" " alt="" coords="288,315,303,282,329,237,364,190,406,149,432,135,435,139,410,153,368,194,333,240,308,284,292,317"/>
<area shape="rect" href="namespacefitpack__core.html#a4bd769a20c06ac85da1866ea8ac3e98c" title="Convert constrained spherical spline coefficients to standard form." alt="" coords="432,572,583,597"/>
<area shape="poly" title=" " alt="" coords="290,341,302,383,326,442,361,504,383,533,410,557,421,565,418,569,406,561,380,536,356,507,321,444,297,385,285,342"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="440,622,575,662"/>
<area shape="poly" title=" " alt="" coords="289,341,299,390,320,462,336,502,356,540,381,576,410,608,429,621,426,625,406,612,376,580,352,543,331,504,315,464,294,392,284,342"/>
<area shape="poly" title=" " alt="" coords="915,210,908,200,911,190,925,184,949,181,977,185,989,194,985,198,975,190,949,187,927,189,915,193,913,199,919,206"/>
<area shape="poly" title=" " alt="" coords="607,218,862,218,862,223,607,223"/>
<area shape="poly" title=" " alt="" coords="566,205,668,183,669,188,568,210"/>
<area shape="poly" title=" " alt="" coords="568,231,669,253,668,258,566,236"/>
<area shape="poly" title=" " alt="" coords="591,328,705,320,767,309,827,293,878,268,920,240,923,244,880,273,829,298,768,314,706,325,592,333"/>
<area shape="poly" title=" " alt="" coords="536,306,708,189,711,193,539,311"/>
<area shape="poly" title=" " alt="" coords="589,306,675,285,676,290,590,311"/>
<area shape="poly" title=" " alt="" coords="568,28,669,50,668,56,566,33"/>
<area shape="poly" title=" " alt="" coords="789,79,829,98,860,121,888,147,931,195,927,199,884,151,856,125,827,103,786,84"/>
<area shape="poly" title=" " alt="" coords="708,58,700,48,704,38,718,32,741,29,770,33,781,42,778,46,768,38,741,35,719,37,708,41,706,47,712,54"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="662,515,821,555"/>
<area shape="poly" title=" " alt="" coords="583,533,648,533,648,538,583,538"/>
<area shape="poly" title=" " alt="" coords="583,113,700,117,765,126,829,142,881,167,924,197,920,201,878,172,827,147,764,131,700,122,583,118"/>
<area shape="poly" title=" " alt="" coords="568,130,669,152,668,157,566,135"/>
<area shape="poly" title=" " alt="" coords="529,130,710,249,707,253,527,134"/>
<area shape="poly" title=" " alt="" coords="566,104,668,82,669,87,568,109"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="669,629,813,655"/>
<area shape="poly" title=" " alt="" coords="575,639,656,639,656,645,575,645"/>
</map>
</div>

</div>
</div>
<a id="a76d523967d0d2a2011719c12c27b2fe7" name="a76d523967d0d2a2011719c12c27b2fe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76d523967d0d2a2011719c12c27b2fe7">&#9670;&#160;</a></span>splder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::splder </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate the \( \nu \)-th derivative of a spline \( s(x) \) at a set of points. </p>
<p>Given a spline of degree \( k \) in B-spline representation, evaluates \( s^{(\nu)}(x_i) \) for \( i = 1,\ldots,m \) using the recurrence scheme of de Boor. The derivative of order \( \nu \) of a degree- \( k \) spline is a degree- \( (k{-}\nu) \) spline whose B-spline coefficients are computed via the de Boor recurrence.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot positions (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Degree of the spline. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nu</td><td>Order of derivative, \( 0 \le \nu \le k \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Evaluation points (length \( m \)). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">y</td><td>Derivative values \( s^{(\nu)}(x_i) \) (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of evaluation points, \( m \ge 1 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">e</td><td>Extrapolation mode for points outside the support:<ul>
<li><code>0</code>: extrapolate from end spans.</li>
<li><code>1</code>: return zero.</li>
<li><code>2</code>: set <code>ier=1</code> and return. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace (length \( n \)). Contains derivative coefficients on exit. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal; <code>1</code> = out of bounds with <code>e=2</code>; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, 1.3; <a class="el" href="#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non-zero B-splines at a given point.">fpbspl</a>  B-spline basis evaluation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a76d523967d0d2a2011719c12c27b2fe7_cgraph.png" border="0" usemap="#anamespacefitpack__core_a76d523967d0d2a2011719c12c27b2fe7_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a76d523967d0d2a2011719c12c27b2fe7_cgraph" id="anamespacefitpack__core_a76d523967d0d2a2011719c12c27b2fe7_cgraph">
<area shape="rect" title="Evaluate the &#45;th derivative of a spline &#160;at a set of points." alt="" coords="5,29,155,55"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="203,29,352,55"/>
<area shape="poly" title=" " alt="" coords="155,39,189,39,189,45,155,45"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="400,29,573,55"/>
<area shape="poly" title=" " alt="" coords="352,39,386,39,386,45,352,45"/>
<area shape="poly" title=" " alt="" coords="453,31,446,21,449,11,463,5,487,3,515,6,527,15,523,20,513,11,487,8,465,10,453,15,451,20,457,28"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="621,29,767,55"/>
<area shape="poly" title=" " alt="" coords="574,39,608,39,608,45,574,45"/>
<area shape="poly" title=" " alt="" coords="660,31,653,21,657,11,671,5,694,3,723,6,734,15,731,20,720,11,694,8,672,10,661,15,658,20,664,28"/>
</map>
</div>

</div>
</div>
<a id="a633394bd969a94a285ac5eeda32e48a7" name="a633394bd969a94a285ac5eeda32e48a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a633394bd969a94a285ac5eeda32e48a7">&#9670;&#160;</a></span>splev()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::splev </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(out)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate a spline \( s(x) \) of degree \( k \) at a set of points. </p>
<p>Given a spline in its B-spline representation (knots \( t \), coefficients \( c \), degree \( k \)), evaluates \( s(x_i) \) for \( i = 1,\ldots,m \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot positions (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Degree of the spline. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Evaluation points (length \( m \)). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">y</td><td>Spline values \( s(x_i) \) (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of evaluation points. Must satisfy \( m \ge 1 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">e</td><td>Extrapolation mode for points outside \( [t_{k+1}, t_{n-k}] \):<ul>
<li><code>0</code> (<code>OUTSIDE_EXTRAPOLATE</code>): extrapolate from end spans.</li>
<li><code>1</code> (<code>OUTSIDE_ZERO</code>): return zero.</li>
<li><code>2</code> (<code>OUTSIDE_NOT_ALLOWED</code>): set <code>ier=1</code> and return.</li>
<li><code>3</code> (<code>OUTSIDE_NEAREST_BND</code>): clamp to nearest boundary value. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: <code>0</code> = normal return; <code>10</code> = invalid input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, 1.3 (pp. 4&ndash;14); <a class="el" href="#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non-zero B-splines at a given point.">fpbspl</a>  B-spline basis evaluation </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a633394bd969a94a285ac5eeda32e48a7_cgraph.png" border="0" usemap="#anamespacefitpack__core_a633394bd969a94a285ac5eeda32e48a7_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a633394bd969a94a285ac5eeda32e48a7_cgraph" id="anamespacefitpack__core_a633394bd969a94a285ac5eeda32e48a7_cgraph">
<area shape="rect" title="Evaluate a spline &#160;of degree &#160;at a set of points." alt="" coords="5,29,149,55"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="197,29,347,55"/>
<area shape="poly" title=" " alt="" coords="150,39,183,39,183,45,150,45"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="395,29,568,55"/>
<area shape="poly" title=" " alt="" coords="347,39,381,39,381,45,347,45"/>
<area shape="poly" title=" " alt="" coords="448,31,440,21,444,11,458,5,481,3,510,6,521,15,518,20,508,11,481,8,459,10,448,15,446,20,452,28"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="616,29,761,55"/>
<area shape="poly" title=" " alt="" coords="568,39,602,39,602,45,568,45"/>
<area shape="poly" title=" " alt="" coords="655,31,648,21,651,11,665,5,689,3,717,6,729,15,725,20,715,11,689,8,667,10,655,15,653,20,659,28"/>
</map>
</div>

</div>
</div>
<a id="a7125f23ea644bcee0719e6279126b038" name="a7125f23ea644bcee0719e6279126b038"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7125f23ea644bcee0719e6279126b038">&#9670;&#160;</a></span>splint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>) function, public fitpack_core::splint </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>k</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the definite integral of a spline \( s(x) \) over \( [a, b] \). </p>
<p>Calculates \( \int_a^b s(x)\,dx \) for a spline of degree \( k \) given in B-spline representation. The spline is considered identically zero outside its support \( (t_{k+1}, t_{n-k}) \).</p>
<p>Uses the method of Gaffney (1976): first computes the integrals of each normalized B-spline \( N_{i,k+1}(x) \) over \( [a, b] \), then forms the weighted sum with the spline coefficients.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot positions (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients (length \( n \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>Degree of the spline. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Left endpoint of the integration interval. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Right endpoint of the integration interval. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk</td><td>Real workspace (length \( n \)). On exit, contains integrals of normalized B-splines. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The integral \( \int_a^b s(x)\,dx \).</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, 1.3.3 (pp. 10&ndash;12), Eq. 1.42&ndash;1.44; <a class="el" href="#aaa4be60a77a5e3a8b9e0013517b221b2" title="Compute definite integrals of the normalized B-splines.">fpintb</a>  B-spline integration </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a7125f23ea644bcee0719e6279126b038_cgraph.png" border="0" usemap="#anamespacefitpack__core_a7125f23ea644bcee0719e6279126b038_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a7125f23ea644bcee0719e6279126b038_cgraph" id="anamespacefitpack__core_a7125f23ea644bcee0719e6279126b038_cgraph">
<area shape="rect" title="Compute the definite integral of a spline &#160;over ." alt="" coords="5,59,151,84"/>
<area shape="rect" href="namespacefitpack__core.html#aaa4be60a77a5e3a8b9e0013517b221b2" title="Compute definite integrals of the normalized B&#45;splines." alt="" coords="199,59,345,84"/>
<area shape="poly" title=" " alt="" coords="151,69,185,69,185,74,151,74"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="400,29,545,55"/>
<area shape="poly" title=" " alt="" coords="345,58,386,52,387,57,346,63"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="393,79,552,119"/>
<area shape="poly" title=" " alt="" coords="346,79,380,84,379,89,345,84"/>
<area shape="poly" title=" " alt="" coords="440,31,433,21,436,11,450,5,473,3,501,6,512,16,508,20,498,11,473,8,451,10,440,15,438,20,444,28"/>
</map>
</div>

</div>
</div>
<a id="ab82db7c6b3d5abc2ace2c6e76ec168d7" name="ab82db7c6b3d5abc2ace2c6e76ec168d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab82db7c6b3d5abc2ace2c6e76ec168d7">&#9670;&#160;</a></span>sproot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::sproot </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>t</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(n), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mest), intent(out)</td>          <td class="paramname"><span class="paramname"><em>zeros</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the zeros of a cubic spline \( s(x) \) given in B-spline representation. </p>
<p>Locates all real roots of a cubic spline ( \( k = 3 \)) by reducing the problem to finding zeros of the cubic polynomial on each knot interval \( [t_l, t_{l+1}] \). Uses continuity of the spline and its derivative to propagate endpoint values across intervals, calling fpcuro for each cubic piece.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Knot positions (length \( n \)). Must satisfy \( n \ge 8 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Total number of knots. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c</td><td>B-spline coefficients (length \( n \)). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">zeros</td><td>Array of zeros found (length <code>mest</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mest</td><td>Maximum number of zeros that can be stored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">m</td><td>Actual number of zeros found. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag:<ul>
<li><code>0</code>: normal return.</li>
<li><code>1</code>: number of zeros exceeds <code>mest</code>.</li>
<li><code>10</code>: invalid input data.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Only works for cubic splines ( \( k = 3 \)).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#aef57b5a3a930e0c3aa2eeb311b571aa6" title="Find the real zeros of a cubic polynomial.">fpcuro</a>  cubic polynomial root finder </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ab82db7c6b3d5abc2ace2c6e76ec168d7_cgraph.png" border="0" usemap="#anamespacefitpack__core_ab82db7c6b3d5abc2ace2c6e76ec168d7_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ab82db7c6b3d5abc2ace2c6e76ec168d7_cgraph" id="anamespacefitpack__core_ab82db7c6b3d5abc2ace2c6e76ec168d7_cgraph">
<area shape="rect" title="Find the zeros of a cubic spline &#160;given in B&#45;spline representation." alt="" coords="5,109,156,135"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="575,29,720,55"/>
<area shape="poly" title=" " alt="" coords="102,107,147,84,203,63,298,46,394,37,484,34,561,35,561,40,484,39,394,42,299,51,205,69,149,89,104,112"/>
<area shape="rect" href="namespacefitpack__core.html#a91926262dc58e19b1b4345d9696c90db" title="In&#45;place quicksort with optional index tracking." alt="" coords="204,102,357,142"/>
<area shape="poly" title=" " alt="" coords="156,119,190,119,190,125,156,125"/>
<area shape="rect" href="namespacefitpack__core.html#aef57b5a3a930e0c3aa2eeb311b571aa6" title="Find the real zeros of a cubic polynomial." alt="" coords="205,167,356,192"/>
<area shape="poly" title=" " alt="" coords="127,132,223,160,222,165,125,137"/>
<area shape="poly" title=" " alt="" coords="616,31,610,21,613,11,626,5,647,3,673,6,684,15,680,19,671,11,647,8,628,10,617,15,615,20,621,28"/>
<area shape="poly" title=" " alt="" coords="247,102,245,92,250,83,262,77,281,75,302,78,313,86,310,90,300,83,281,81,264,83,254,87,250,93,252,101"/>
<area shape="rect" href="fitpack__core_8_f90.html#a6e2d25f0c47b08f7fced619525b1a825" title=" " alt="" coords="405,107,515,132"/>
<area shape="poly" title=" " alt="" coords="357,118,391,118,391,123,357,124"/>
<area shape="poly" title=" " alt="" coords="484,104,562,68,591,57,592,62,564,72,487,109"/>
<area shape="poly" title=" " alt="" coords="430,108,424,98,427,89,440,82,460,80,485,84,495,92,491,96,482,88,460,85,441,87,431,92,429,98,435,105"/>
<area shape="rect" href="namespacefitpack__core.html#ab9e559a7491e780d631b07d895b4ff98" title="Test &#160;(strict greater&#45;than)." alt="" coords="569,105,726,131"/>
<area shape="poly" title=" " alt="" coords="515,116,555,116,555,121,515,122"/>
<area shape="rect" href="namespacefitpack__core.html#a69c35a8032dd7dfa0b593ce00610d36f" title="Test &#160;(strict less&#45;than)." alt="" coords="563,179,732,204"/>
<area shape="poly" title=" " alt="" coords="495,130,602,171,600,176,493,135"/>
<area shape="poly" title=" " alt="" coords="616,107,610,97,613,87,626,81,647,79,673,82,684,91,680,95,671,87,647,84,628,86,617,91,615,96,621,104"/>
<area shape="poly" title=" " alt="" coords="616,180,610,170,613,160,626,154,647,152,673,156,684,164,680,168,671,160,647,157,628,159,617,164,615,170,621,177"/>
</map>
</div>

</div>
</div>
<a id="a827820ea1a71f5e6fad5e75bd3016578" name="a827820ea1a71f5e6fad5e75bd3016578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a827820ea1a71f5e6fad5e75bd3016578">&#9670;&#160;</a></span>surev()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::surev </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>idim</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>tv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nu-4)*(nv-4)*idim), intent(in)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mu), intent(in)</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mv), intent(in)</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mv</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(mf), intent(out)</td>          <td class="paramname"><span class="paramname"><em>f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>mf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate a parametric bicubic spline surface on a grid. </p>
<p>Evaluates an \( d \)-dimensional ( \( d = \) <code>idim</code>) bicubic spline surface at the grid \( (u_i, v_j) \),  \( i=1,\ldots,m_u;\ 
j=1,\ldots,m_v \). </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_a827820ea1a71f5e6fad5e75bd3016578_cgraph.png" border="0" usemap="#anamespacefitpack__core_a827820ea1a71f5e6fad5e75bd3016578_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_a827820ea1a71f5e6fad5e75bd3016578_cgraph" id="anamespacefitpack__core_a827820ea1a71f5e6fad5e75bd3016578_cgraph">
<area shape="rect" title="Evaluate a parametric bicubic spline surface on a grid." alt="" coords="5,42,151,67"/>
<area shape="rect" href="namespacefitpack__core.html#a93f9263090199970a23f6dfca11227cf" title=" " alt="" coords="199,42,352,67"/>
<area shape="poly" title=" " alt="" coords="151,52,184,52,184,57,151,57"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="400,5,559,45"/>
<area shape="poly" title=" " alt="" coords="352,41,386,36,387,41,353,46"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="405,70,554,95"/>
<area shape="poly" title=" " alt="" coords="353,63,391,68,390,73,352,68"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="607,70,780,95"/>
<area shape="poly" title=" " alt="" coords="555,80,593,80,593,85,555,85"/>
<area shape="poly" title=" " alt="" coords="660,72,652,62,656,52,670,46,693,43,722,47,733,56,730,60,720,52,693,49,671,51,660,55,658,61,664,68"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="828,70,973,95"/>
<area shape="poly" title=" " alt="" coords="780,80,814,80,814,85,780,85"/>
<area shape="poly" title=" " alt="" coords="867,72,860,62,863,52,877,46,901,43,929,47,941,56,937,60,927,52,901,49,879,51,867,55,865,61,871,68"/>
</map>
</div>

</div>
</div>
<a id="ac3ec431477bdf8868e8aff1cc3f5ab51" name="ac3ec431477bdf8868e8aff1cc3f5ab51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3ec431477bdf8868e8aff1cc3f5ab51">&#9670;&#160;</a></span>surfit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine, public fitpack_core::surfit </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>iopt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>z</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(m), intent(in)</td>          <td class="paramname"><span class="paramname"><em>w</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>xe</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>yb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ye</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>ky</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nxest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nyest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>nmax</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>eps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>nx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nmax), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>tx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ny</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(nmax), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>ty</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension((nxest-kx-1)*(nyest-ky-1)), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>c</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk1), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), dimension(lwrk2), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>wrk2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>lwrk2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), dimension(kwrk), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>iwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(in)</td>          <td class="paramname"><span class="paramname"><em>kwrk</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), intent(out)</td>          <td class="paramname"><span class="paramname"><em>ier</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit a smoothing bivariate spline to scattered data. </p>
<p>Given weighted data points \( (x_i, y_i, z_i, w_i) \), \( i=1,\ldots,m \), determines a bivariate spline \( s(x,y) \) of degrees \( k_x, k_y \) on the rectangle \( [x_b, x_e] \times [y_b, y_e] \).</p>
<p>The smoothing factor \( s \ge 0 \) controls the trade-off: the routine minimizes discontinuity jumps in the spline derivatives subject to   </p><p class="formulaDsp">
\[              \sum_{i=1}^{m} \bigl[w_i\,(z_i - s(x_i, y_i))\bigr]^2 \le s.
\]
</p>
<p> Setting \( s = 0 \) produces an interpolating spline. The result is given in tensor-product B-spline representation and can be evaluated with bispev / bispeu.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">iopt</td><td>Computation mode: <code>-1</code> = least-squares with user knots; <code>0</code> = smoothing, fresh start; <code>1</code> = smoothing, continue. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Number of data points, \( m \ge (k_x{+}1)(k_y{+}1) \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>\( x \)-coordinates of data points (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">y</td><td>\( y \)-coordinates of data points (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>Data values (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Positive weights (length \( m \)). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xb</td><td>Lower \( x \)-boundary. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xe</td><td>Upper \( x \)-boundary. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yb</td><td>Lower \( y \)-boundary. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ye</td><td>Upper \( y \)-boundary. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kx</td><td>Degree in \( x \), \( 1 \le k_x \le 5 \) (bicubic recommended). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ky</td><td>Degree in \( y \), \( 1 \le k_y \le 5 \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Smoothing factor, \( s \ge 0 \) (ignored when <code>iopt=-1</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nxest</td><td>Upper bound for \( n_x \), \( \ge 2(k_x{+}1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nyest</td><td>Upper bound for \( n_y \), \( \ge 2(k_y{+}1) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nmax</td><td>Dimension of <code>tx</code>/<code>ty</code> arrays, \( \ge \max(n_x^{\text{est}}, n_y^{\text{est}}) \). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eps</td><td>Rank-deficiency threshold, \( 0 &lt; \varepsilon &lt; 1 \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">nx</td><td>Total number of knots in \( x \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tx</td><td>Knot positions in \( x \) (length <code>nmax</code>). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ny</td><td>Total number of knots in \( y \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ty</td><td>Knot positions in \( y \) (length <code>nmax</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">c</td><td>B-spline coefficients, length \( (n_x{-}k_x{-}1)(n_y{-}k_y{-}1) \). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fp</td><td>Weighted sum of squared residuals \( F_p \). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk1</td><td>Real workspace (length <code>lwrk1</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk1</td><td>Declared dimension of <code>wrk1</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">wrk2</td><td>Secondary workspace for rank-deficient systems (length <code>lwrk2</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lwrk2</td><td>Declared dimension of <code>wrk2</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">iwrk</td><td>Integer workspace (length <code>kwrk</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kwrk</td><td>Declared dimension of <code>iwrk</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ier</td><td>Error flag: \( \le 0 \) = success, <code>1</code><code>5</code> = convergence warnings, <code>10</code> = invalid input, <code>&gt;10</code> = <code>lwrk2</code> too small.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>For gridded data, use regrid instead  it is significantly faster.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 5, 5.3 (pp. 107117); <a class="el" href="#adba4c1c277c572cad2725b326b896ef8" title="Fit a smoothing bivariate spline to data on a rectangular grid.">regrid</a>  gridded variant; <a class="el" href="#aac8fa7ec692eb2758290f050c302d22d" title="Evaluate a bivariate spline on a rectangular grid.">bispev</a>  evaluate the result </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacefitpack__core_ac3ec431477bdf8868e8aff1cc3f5ab51_cgraph.png" border="0" usemap="#anamespacefitpack__core_ac3ec431477bdf8868e8aff1cc3f5ab51_cgraph" alt=""/></div>
<map name="anamespacefitpack__core_ac3ec431477bdf8868e8aff1cc3f5ab51_cgraph" id="anamespacefitpack__core_ac3ec431477bdf8868e8aff1cc3f5ab51_cgraph">
<area shape="rect" title="Fit a smoothing bivariate spline to scattered data." alt="" coords="5,288,148,313"/>
<area shape="rect" href="namespacefitpack__core.html#a999c5b98cb9e681f3045c39c6dea7151" title="Core algorithm for bivariate tensor&#45;product spline surface fitting." alt="" coords="196,288,343,313"/>
<area shape="poly" title=" " alt="" coords="148,298,182,298,182,303,148,303"/>
<area shape="rect" href="namespacefitpack__core.html#ab4ec4c90b00749bb021a6ec2f3433781" title="Rotate an observation row into the upper triangular band matrix." alt="" coords="391,173,589,199"/>
<area shape="poly" title=" " alt="" coords="283,286,328,248,358,227,390,209,411,200,413,205,392,214,360,231,331,252,286,290"/>
<area shape="rect" href="namespacefitpack__core.html#aa452051613d61831a99b2f9ef8e21bc8" title="Rotate a smoothing&#45;matrix row into a band matrix using shifted pivots." alt="" coords="406,223,574,263"/>
<area shape="poly" title=" " alt="" coords="318,285,399,264,400,269,320,291"/>
<area shape="rect" href="namespacefitpack__core.html#ae590b9ba81851ee9d9c76e1fe127c0d1" title="Solve an upper triangular banded system by back&#45;substitution." alt="" coords="413,288,567,313"/>
<area shape="poly" title=" " alt="" coords="343,298,400,298,400,303,343,303"/>
<area shape="rect" href="namespacefitpack__core.html#ac5fb8acceffae7a31a838c1d7ff97d31" title="Evaluate the non&#45;zero B&#45;splines at a given point." alt="" coords="415,52,565,77"/>
<area shape="poly" title=" " alt="" coords="273,287,314,206,347,155,389,109,411,93,436,80,438,85,414,98,392,113,351,158,318,208,278,289"/>
<area shape="rect" href="namespacefitpack__core.html#a57fba861443159865065312aa46b6627" title="Compute the discontinuity jumps of the B&#45;spline derivatives." alt="" coords="416,337,564,363"/>
<area shape="poly" title=" " alt="" coords="327,311,420,332,418,337,326,316"/>
<area shape="rect" href="namespacefitpack__core.html#a000e6860b30d66fcc8bf487d934c0f28" title="Sort scattered data points into rectangular panels." alt="" coords="415,387,565,412"/>
<area shape="poly" title=" " alt="" coords="289,311,334,342,392,373,412,380,410,385,390,378,331,347,286,316"/>
<area shape="rect" href="namespacefitpack__core.html#ab08555e9bd2f44d1461e09ba35a7bb22" title="Compute the minimum&#45;norm least&#45;squares solution under rank deficiency." alt="" coords="415,124,565,149"/>
<area shape="poly" title=" " alt="" coords="276,286,318,225,351,190,389,160,404,152,406,157,392,164,355,194,323,229,280,289"/>
<area shape="rect" href="namespacefitpack__core.html#afd90889b0d56592815337f99a849bc7a" title=" " alt="" coords="423,437,557,477"/>
<area shape="poly" title=" " alt="" coords="282,312,325,365,357,396,392,422,411,432,408,437,389,427,353,400,322,369,278,315"/>
<area shape="rect" href="fitpack__core_8_f90.html#aa91d9195d5c1268da8985c5f63cde0aa" title="Restore original x/y ordering if axes were interchanged." alt="" coords="455,501,525,527"/>
<area shape="poly" title=" " alt="" coords="278,313,292,348,315,395,349,445,369,467,392,486,416,499,442,506,440,512,414,504,389,491,366,471,345,448,311,398,287,350,273,315"/>
<area shape="rect" href="namespacefitpack__core.html#a44e0185b61cf87f55a1a6ffb9f10fb98" title="Test whether two reals are equal within machine precision." alt="" coords="859,105,1004,131"/>
<area shape="poly" title=" " alt="" coords="573,171,845,128,846,134,574,176"/>
<area shape="rect" href="namespacefitpack__core.html#aee86d7e7c8bbb38a98dd2dff92861293" title="Compute parameters of a Givens plane rotation." alt="" coords="649,231,799,256"/>
<area shape="poly" title=" " alt="" coords="543,196,659,225,658,230,542,201"/>
<area shape="rect" href="namespacefitpack__core.html#a3804afa034c5c78f99a71f867d53de7c" title="Apply a Givens plane rotation to two scalars." alt="" coords="650,181,798,207"/>
<area shape="poly" title=" " alt="" coords="590,187,636,188,636,194,589,192"/>
<area shape="poly" title=" " alt="" coords="898,107,890,97,894,87,908,81,931,79,960,82,971,91,968,96,958,87,931,84,909,86,898,91,896,96,902,104"/>
<area shape="poly" title=" " alt="" coords="545,261,603,276,670,287,706,288,742,286,777,279,809,266,846,241,877,208,900,173,917,142,921,144,905,175,881,211,850,245,812,271,778,284,743,291,706,294,670,292,601,282,544,266"/>
<area shape="poly" title=" " alt="" coords="574,241,636,241,636,246,574,246"/>
<area shape="poly" title=" " alt="" coords="574,223,650,207,651,212,575,228"/>
<area shape="rect" href="namespacefitpack__core.html#a2509dd629f972935555488cd2db1bff2" title="Test whether two reals differ beyond machine precision." alt="" coords="637,29,811,55"/>
<area shape="poly" title=" " alt="" coords="565,55,623,49,624,54,565,60"/>
<area shape="poly" title=" " alt="" coords="761,52,884,98,882,103,759,57"/>
<area shape="poly" title=" " alt="" coords="690,31,683,21,687,11,701,5,724,3,753,6,764,15,761,20,750,11,724,8,702,10,691,15,688,20,694,28"/>
<area shape="rect" href="namespacefitpack__core.html#ab8705afed0d461ae20bf35a10b0579f5" title="Find knot interval index l such that t(l) &lt;= x &lt; t(l+1). Uses hybrid search: linear for small ranges,..." alt="" coords="645,379,803,419"/>
<area shape="poly" title=" " alt="" coords="566,397,630,397,630,402,566,402"/>
<area shape="poly" title=" " alt="" coords="565,127,637,122,845,116,845,121,637,127,566,132"/>
<area shape="poly" title=" " alt="" coords="564,147,591,160,607,174,616,189,624,204,639,217,649,223,646,227,636,221,620,207,611,192,603,178,588,164,561,152"/>
<area shape="poly" title=" " alt="" coords="543,147,659,175,658,181,542,152"/>
<area shape="poly" title=" " alt="" coords="519,121,636,72,674,57,676,62,638,76,521,126"/>
<area shape="rect" href="namespacefitpack__core.html#aefb269f6c2a494ba69c10e93334def66" title="Rational interpolation for the smoothing parameter search." alt="" coords="652,444,796,469"/>
<area shape="poly" title=" " alt="" coords="558,454,638,454,638,459,558,459"/>
</map>
</div>

</div>
</div>
<a id="a4ef02c1455f01a04bc64bed3b5b4309b" name="a4ef02c1455f01a04bc64bed3b5b4309b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ef02c1455f01a04bc64bed3b5b4309b">&#9670;&#160;</a></span>swap_data()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental subroutine fitpack_core::swap_data </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Swap two real values in place. </p>

</div>
</div>
<a id="a50b6ad97b1dc461dd71a0efe495d0538" name="a50b6ad97b1dc461dd71a0efe495d0538"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50b6ad97b1dc461dd71a0efe495d0538">&#9670;&#160;</a></span>swap_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">elemental subroutine fitpack_core::swap_size </td>
          <td>(</td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), intent(inout)</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Swap two integer values in place. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8977b21dfb875ff715ed80ae54eb940f" name="a8977b21dfb875ff715ed80ae54eb940f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8977b21dfb875ff715ed80ae54eb940f">&#9670;&#160;</a></span>concon_maxbin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::concon_maxbin = 14</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae25605ee85ee9f332ef8c76fd1b4912f" name="ae25605ee85ee9f332ef8c76fd1b4912f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae25605ee85ee9f332ef8c76fd1b4912f">&#9670;&#160;</a></span>concon_maxtr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::concon_maxtr = 15</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a34253ec4cac375fd881ce164c7d6f3a5" name="a34253ec4cac375fd881ce164c7d6f3a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34253ec4cac375fd881ce164c7d6f3a5">&#9670;&#160;</a></span>concon_qp_fail</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::concon_qp_fail = 16</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af3c998a4a06cbcdfc95f2f901573016b" name="af3c998a4a06cbcdfc95f2f901573016b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3c998a4a06cbcdfc95f2f901573016b">&#9670;&#160;</a></span>deg2rad</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::deg2rad = <a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a>/180.0_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a668bd0af72972ca4b389eb70672f246b" name="a668bd0af72972ca4b389eb70672f246b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a668bd0af72972ca4b389eb70672f246b">&#9670;&#160;</a></span>degree_3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter, public fitpack_core::degree_3 = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3d07187113a320a4bf1fa751018181d2" name="a3d07187113a320a4bf1fa751018181d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d07187113a320a4bf1fa751018181d2">&#9670;&#160;</a></span>degree_4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter, public fitpack_core::degree_4 = 4</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4d7d7b394bfadf0160a6986d06c7952d" name="a4d7d7b394bfadf0160a6986d06c7952d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d7d7b394bfadf0160a6986d06c7952d">&#9670;&#160;</a></span>degree_5</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter, public fitpack_core::degree_5 = 5</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a038ab2216be4b6dddcf5166e9baf6487" name="a038ab2216be4b6dddcf5166e9baf6487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a038ab2216be4b6dddcf5166e9baf6487">&#9670;&#160;</a></span>fitpack_input_error</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_input_error = 10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8896021bdfc50c966a5f5ed3c0a8b23a" name="a8896021bdfc50c966a5f5ed3c0a8b23a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8896021bdfc50c966a5f5ed3c0a8b23a">&#9670;&#160;</a></span>fitpack_insufficient_knots</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_insufficient_knots = 13</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9bdff823e0b4b6c4d78480ebcf261b77" name="a9bdff823e0b4b6c4d78480ebcf261b77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bdff823e0b4b6c4d78480ebcf261b77">&#9670;&#160;</a></span>fitpack_insufficient_storage</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_insufficient_storage = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a106b66c8074f6ff15a3bbd5b3b05e846" name="a106b66c8074f6ff15a3bbd5b3b05e846"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a106b66c8074f6ff15a3bbd5b3b05e846">&#9670;&#160;</a></span>fitpack_interpolating_ok</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_interpolating_ok = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aad07193e4c7b3c7365d8c1092f6e4cc9" name="aad07193e4c7b3c7365d8c1092f6e4cc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad07193e4c7b3c7365d8c1092f6e4cc9">&#9670;&#160;</a></span>fitpack_invalid_constraint</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_invalid_constraint = 12</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a944d940ace1cff6450dfb7526fef5638" name="a944d940ace1cff6450dfb7526fef5638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a944d940ace1cff6450dfb7526fef5638">&#9670;&#160;</a></span>fitpack_invalid_range</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_invalid_range = 6</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a12befae31b0984a43ced0a5953d00699" name="a12befae31b0984a43ced0a5953d00699"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12befae31b0984a43ced0a5953d00699">&#9670;&#160;</a></span>fitpack_leastsquares_ok</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_leastsquares_ok = -2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adc355752db9a62cf5d13e0b62f1c7afc" name="adc355752db9a62cf5d13e0b62f1c7afc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc355752db9a62cf5d13e0b62f1c7afc">&#9670;&#160;</a></span>fitpack_maxit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_maxit = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad4ad90f1d8e6de762e926e53511dcfdc" name="ad4ad90f1d8e6de762e926e53511dcfdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4ad90f1d8e6de762e926e53511dcfdc">&#9670;&#160;</a></span>fitpack_ok</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_ok = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa524549dddd647e47d11f97c6219214d" name="aa524549dddd647e47d11f97c6219214d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa524549dddd647e47d11f97c6219214d">&#9670;&#160;</a></span>fitpack_overlapping_knots</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_overlapping_knots = 5</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0f2e775aca8ba712b352289ec5f3eaed" name="a0f2e775aca8ba712b352289ec5f3eaed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f2e775aca8ba712b352289ec5f3eaed">&#9670;&#160;</a></span>fitpack_s_too_small</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_s_too_small = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a01a372bcb8babb47683f1d60a0ac6d2f" name="a01a372bcb8babb47683f1d60a0ac6d2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01a372bcb8babb47683f1d60a0ac6d2f">&#9670;&#160;</a></span>fitpack_test_error</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_test_error = 11</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6aef274b373e0259f86d19f98f0f222f" name="a6aef274b373e0259f86d19f98f0f222f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aef274b373e0259f86d19f98f0f222f">&#9670;&#160;</a></span>fitpack_too_many_knots</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::fitpack_too_many_knots = 4</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a561dddd557c0d3839c8980a774ac5b26" name="a561dddd557c0d3839c8980a774ac5b26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a561dddd557c0d3839c8980a774ac5b26">&#9670;&#160;</a></span>five</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::five = 5.0_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6d8e71908bad79fed68247c6f7731862" name="a6d8e71908bad79fed68247c6f7731862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d8e71908bad79fed68247c6f7731862">&#9670;&#160;</a></span>four</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::four = 4.0_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0f011dd3c1148c6cecee9174b2391aa4" name="a0f011dd3c1148c6cecee9174b2391aa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f011dd3c1148c6cecee9174b2391aa4">&#9670;&#160;</a></span>fourth</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::fourth = 0.25_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a650e5831ebea638e634b52942aae265c" name="a650e5831ebea638e634b52942aae265c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a650e5831ebea638e634b52942aae265c">&#9670;&#160;</a></span>fp_bool</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter, public fitpack_core::fp_bool = c_bool</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac9aa06356d8fbf8f4b108db917e429a4" name="ac9aa06356d8fbf8f4b108db917e429a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9aa06356d8fbf8f4b108db917e429a4">&#9670;&#160;</a></span>fp_comm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter, public fitpack_core::fp_comm = c_double</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a015fac22c02c6a271cc91e07f8d068ef" name="a015fac22c02c6a271cc91e07f8d068ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a015fac22c02c6a271cc91e07f8d068ef">&#9670;&#160;</a></span>fp_false</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), parameter, public fitpack_core::fp_false = .false._FP_BOOL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab2b42bf8ab592eaa2ea37a333fd10f54" name="ab2b42bf8ab592eaa2ea37a333fd10f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2b42bf8ab592eaa2ea37a333fd10f54">&#9670;&#160;</a></span>fp_flag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter, public fitpack_core::fp_flag = c_int32_t</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a16ef1ddc6e8416540eac14148753788d" name="a16ef1ddc6e8416540eac14148753788d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16ef1ddc6e8416540eac14148753788d">&#9670;&#160;</a></span>fp_not_alloc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter fitpack_core::fp_not_alloc = -99999999_FP_SIZE</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Marker for unallocated arrays in communication buffers. </p>

</div>
</div>
<a id="ae6ce471487dec031d833fc0e5dfdb065" name="ae6ce471487dec031d833fc0e5dfdb065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6ce471487dec031d833fc0e5dfdb065">&#9670;&#160;</a></span>fp_real</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter, public fitpack_core::fp_real = c_double</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a813df3760ab07292679bf3d7384ddcb7" name="a813df3760ab07292679bf3d7384ddcb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a813df3760ab07292679bf3d7384ddcb7">&#9670;&#160;</a></span>fp_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter, public fitpack_core::fp_size = c_int32_t</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeb077d251aa5a83467c1db3413457d9b" name="aeb077d251aa5a83467c1db3413457d9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb077d251aa5a83467c1db3413457d9b">&#9670;&#160;</a></span>fp_true</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical(<a class="el" href="#a650e5831ebea638e634b52942aae265c">fp_bool</a>), parameter, public fitpack_core::fp_true = .true._FP_BOOL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9b6dcf919ef8883b8d7d8c5f4117e58c" name="a9b6dcf919ef8883b8d7d8c5f4117e58c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b6dcf919ef8883b8d7d8c5f4117e58c">&#9670;&#160;</a></span>half</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::half = 0.5_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2ab4fd1ec4cdc14189c1cbec78baaef0" name="a2ab4fd1ec4cdc14189c1cbec78baaef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ab4fd1ec4cdc14189c1cbec78baaef0">&#9670;&#160;</a></span>ifive</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter fitpack_core::ifive = 5_FP_SIZE</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a909438eb654f950c6ca9471738088510" name="a909438eb654f950c6ca9471738088510"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a909438eb654f950c6ca9471738088510">&#9670;&#160;</a></span>ifour</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter fitpack_core::ifour = 4_FP_SIZE</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a428e614df1a06b6dbf257ecd68a66f27" name="a428e614df1a06b6dbf257ecd68a66f27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a428e614df1a06b6dbf257ecd68a66f27">&#9670;&#160;</a></span>ione</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter fitpack_core::ione = 1_FP_SIZE</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aeaae5211a1438087b7d98f9648255e63" name="aeaae5211a1438087b7d98f9648255e63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaae5211a1438087b7d98f9648255e63">&#9670;&#160;</a></span>iopt_new_leastsquares</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::iopt_new_leastsquares = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9aeb0ab003e1195670a39f28dd36e5d4" name="a9aeb0ab003e1195670a39f28dd36e5d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9aeb0ab003e1195670a39f28dd36e5d4">&#9670;&#160;</a></span>iopt_new_smoothing</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::iopt_new_smoothing = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a979a930a27067e89d9a12cdfa770887e" name="a979a930a27067e89d9a12cdfa770887e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a979a930a27067e89d9a12cdfa770887e">&#9670;&#160;</a></span>iopt_old_fit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::iopt_old_fit = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a274f3c8c6327076d7195c73fa818ebef" name="a274f3c8c6327076d7195c73fa818ebef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a274f3c8c6327076d7195c73fa818ebef">&#9670;&#160;</a></span>ithree</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter fitpack_core::ithree = 3_FP_SIZE</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae215ea87e63c4e8042cee1d42ae50828" name="ae215ea87e63c4e8042cee1d42ae50828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae215ea87e63c4e8042cee1d42ae50828">&#9670;&#160;</a></span>itwo</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter fitpack_core::itwo = 2_FP_SIZE</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a01ebba5f497175707f893443bd77ea7b" name="a01ebba5f497175707f893443bd77ea7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01ebba5f497175707f893443bd77ea7b">&#9670;&#160;</a></span>izero</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter fitpack_core::izero = 0_FP_SIZE</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel private">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a1d8475ed3cb1c0bfccef4ca66ef6bf59" name="a1d8475ed3cb1c0bfccef4ca66ef6bf59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d8475ed3cb1c0bfccef4ca66ef6bf59">&#9670;&#160;</a></span>knot_dim_1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::knot_dim_1 = -1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7d99472224f26deec2560fedeab07794" name="a7d99472224f26deec2560fedeab07794"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d99472224f26deec2560fedeab07794">&#9670;&#160;</a></span>knot_dim_2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::knot_dim_2 = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae335f58a7994bbafd5ff9cfb81d1e7fb" name="ae335f58a7994bbafd5ff9cfb81d1e7fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae335f58a7994bbafd5ff9cfb81d1e7fb">&#9670;&#160;</a></span>knot_dim_none</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::knot_dim_none = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acea3d2d817763c46755c944d4ea72a24" name="acea3d2d817763c46755c944d4ea72a24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acea3d2d817763c46755c944d4ea72a24">&#9670;&#160;</a></span>max_idim</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter, public fitpack_core::max_idim = 10</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6c5b21fc23625ebfc7f555075c13eb07" name="a6c5b21fc23625ebfc7f555075c13eb07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c5b21fc23625ebfc7f555075c13eb07">&#9670;&#160;</a></span>max_order</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#a813df3760ab07292679bf3d7384ddcb7">fp_size</a>), parameter, public fitpack_core::max_order = 19</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4ef46fb771d804b34407c3ec419f79cc" name="a4ef46fb771d804b34407c3ec419f79cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ef46fb771d804b34407c3ec419f79cc">&#9670;&#160;</a></span>one</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::one = 1.0_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a641bf26c23c6c7089fe7ab041d8b9d4f" name="a641bf26c23c6c7089fe7ab041d8b9d4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a641bf26c23c6c7089fe7ab041d8b9d4f">&#9670;&#160;</a></span>onep5</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::onep5 = 1.5_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae8c83e115f52c352bdc76759d2c21a21" name="ae8c83e115f52c352bdc76759d2c21a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8c83e115f52c352bdc76759d2c21a21">&#9670;&#160;</a></span>outside_extrapolate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::outside_extrapolate = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa89341217e078cc2593242b8a4184ff6" name="aa89341217e078cc2593242b8a4184ff6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89341217e078cc2593242b8a4184ff6">&#9670;&#160;</a></span>outside_nearest_bnd</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::outside_nearest_bnd = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a90b449513694a8a6e8dd2e0893e9c044" name="a90b449513694a8a6e8dd2e0893e9c044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90b449513694a8a6e8dd2e0893e9c044">&#9670;&#160;</a></span>outside_not_allowed</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::outside_not_allowed = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aea35b146c25b52ee76291d55046635a8" name="aea35b146c25b52ee76291d55046635a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea35b146c25b52ee76291d55046635a8">&#9670;&#160;</a></span>outside_zero</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(<a class="el" href="#ab2b42bf8ab592eaa2ea37a333fd10f54">fp_flag</a>), parameter, public fitpack_core::outside_zero = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a46706d00dd4c5a65aad4dca9b490db91" name="a46706d00dd4c5a65aad4dca9b490db91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46706d00dd4c5a65aad4dca9b490db91">&#9670;&#160;</a></span>pi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::pi = atan2(<a class="el" href="#a9199b127ebd8fa693ca733b00ec1621b">zero</a>, -<a class="el" href="#a4ef46fb771d804b34407c3ec419f79cc">one</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeaec2c2df3931627500a073b6683fbb9" name="aeaec2c2df3931627500a073b6683fbb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaec2c2df3931627500a073b6683fbb9">&#9670;&#160;</a></span>pi2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::pi2 = 2*<a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af2c893201e301fa7f4756972b71b10bc" name="af2c893201e301fa7f4756972b71b10bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2c893201e301fa7f4756972b71b10bc">&#9670;&#160;</a></span>pi4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::pi4 = 4*<a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adcc34262b795f5b99a79de4e2eaac8fe" name="adcc34262b795f5b99a79de4e2eaac8fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcc34262b795f5b99a79de4e2eaac8fe">&#9670;&#160;</a></span>pio2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::pio2 = <a class="el" href="#a9b6dcf919ef8883b8d7d8c5f4117e58c">half</a>*<a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad1b55639d02ea588c18e1f890b04257f" name="ad1b55639d02ea588c18e1f890b04257f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1b55639d02ea588c18e1f890b04257f">&#9670;&#160;</a></span>pio4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::pio4 = <a class="el" href="#a0f011dd3c1148c6cecee9174b2391aa4">fourth</a>*<a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0909aaddeb47c5a7ae90af3942568060" name="a0909aaddeb47c5a7ae90af3942568060"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0909aaddeb47c5a7ae90af3942568060">&#9670;&#160;</a></span>pio8</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::pio8 = 0.125_FP_REAL*<a class="el" href="#a46706d00dd4c5a65aad4dca9b490db91">pi</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a79a1cbd52f4a65393251fbd8bce4d0c3" name="a79a1cbd52f4a65393251fbd8bce4d0c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79a1cbd52f4a65393251fbd8bce4d0c3">&#9670;&#160;</a></span>six</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::six = 6.0_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4bb4060ce4cd4a560895caf20419ad93" name="a4bb4060ce4cd4a560895caf20419ad93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bb4060ce4cd4a560895caf20419ad93">&#9670;&#160;</a></span>smallnum03</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::smallnum03 = 1.0e-03_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afb09c4fbdc52ad141ec702456cd5936b" name="afb09c4fbdc52ad141ec702456cd5936b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb09c4fbdc52ad141ec702456cd5936b">&#9670;&#160;</a></span>smallnum06</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::smallnum06 = 1.0e-06_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac4a447df425d54bdc2962c1fe0cdd332" name="ac4a447df425d54bdc2962c1fe0cdd332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4a447df425d54bdc2962c1fe0cdd332">&#9670;&#160;</a></span>smallnum08</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::smallnum08 = 1.0e-08_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab1ef41e135e2b19a4fef06743624081d" name="ab1ef41e135e2b19a4fef06743624081d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1ef41e135e2b19a4fef06743624081d">&#9670;&#160;</a></span>smallnum10</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::smallnum10 = 1.0e-10_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5de665dd2a4942cc8f8e3a7f9d6ca47c" name="a5de665dd2a4942cc8f8e3a7f9d6ca47c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5de665dd2a4942cc8f8e3a7f9d6ca47c">&#9670;&#160;</a></span>ten</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::ten = 10.0_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2400f32cd48e2a9819ac8679d58ac20e" name="a2400f32cd48e2a9819ac8679d58ac20e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2400f32cd48e2a9819ac8679d58ac20e">&#9670;&#160;</a></span>third</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::third = <a class="el" href="#a4ef46fb771d804b34407c3ec419f79cc">one</a>/3.0_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a943cd42934fd393b333db11f752fc638" name="a943cd42934fd393b333db11f752fc638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a943cd42934fd393b333db11f752fc638">&#9670;&#160;</a></span>three</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::three = 3.0_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afee03366ac96e05920c831ebe8d1a80b" name="afee03366ac96e05920c831ebe8d1a80b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afee03366ac96e05920c831ebe8d1a80b">&#9670;&#160;</a></span>two</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::two = 2.0_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9199b127ebd8fa693ca733b00ec1621b" name="a9199b127ebd8fa693ca733b00ec1621b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9199b127ebd8fa693ca733b00ec1621b">&#9670;&#160;</a></span>zero</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="#ae6ce471487dec031d833fc0e5dfdb065">fp_real</a>), parameter, public fitpack_core::zero = 0.0_FP_REAL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefitpack__core.html">fitpack_core</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
