<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: B-Spline Foundations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('theory_bsplines.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">B-Spline Foundations</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2home_2runner_2work_2fitpack_2fitpack_2doc_2theory__bsplines"></a></p>
<p>This page introduces the mathematical foundations of B-splines as used throughout FITPACK. All curve and surface fitting routines in the library represent their results as linear combinations of B-spline basis functions, so understanding these foundations is essential for interpreting knot vectors, coefficients, and the various evaluation, differentiation, and integration operations.</p>
<p>The presentation follows Dierckx (1993), Chapters 1 and 6.</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Piecewise Polynomials and Knot Vectors</h1>
<p>A <b>spline</b> of degree <picture><source srcset="form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k $" src="form_5.png"/></picture> is a piecewise polynomial function whose pieces join with <picture><source srcset="form_63_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k - 1 $" src="form_63.png"/></picture> continuous derivatives at designated breakpoints called <b>knots</b>. The knots are collected into a non-decreasing <b>knot vector</b></p>
<p class="formulaDsp">
<picture><source srcset="form_64_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    t_0 \leq t_1 \leq \cdots \leq t_{n+k+1}
\]" src="form_64.png"/></picture>
</p>
<p>which partitions the approximation interval <picture><source srcset="form_65_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ [a, b] $" src="form_65.png"/></picture> into sub-intervals. The number of distinct interior knots determines the flexibility of the spline: more knots allow closer approximation to complicated shapes, while fewer knots enforce smoothness.</p>
<p>The set of all splines of degree <picture><source srcset="form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k $" src="form_5.png"/></picture> on a given knot vector <picture><source srcset="form_66_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{t} $" src="form_66.png"/></picture> forms a linear space <picture><source srcset="form_67_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathcal{S}(k, \mathbf{t}) $" src="form_67.png"/></picture> of dimension <picture><source srcset="form_68_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ n + 1 $" src="form_68.png"/></picture>, where <picture><source srcset="form_68_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ n + 1 $" src="form_68.png"/></picture> is the number of B-spline basis functions (and therefore the number of coefficients needed to represent any element of the space).</p>
<p>In FITPACK the first and last <picture><source srcset="form_69_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k + 1 $" src="form_69.png"/></picture> knots are clamped to the boundary:</p>
<p class="formulaDsp">
<picture><source srcset="form_70_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    t_0 = t_1 = \cdots = t_k = a, \qquad
    t_{n+1} = t_{n+2} = \cdots = t_{n+k+1} = b
\]" src="form_70.png"/></picture>
</p>
<p>so that the spline interpolates (rather than merely approximates) its coefficient values at the endpoints.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
B-Spline Basis Functions</h1>
<p>Every element of <picture><source srcset="form_67_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathcal{S}(k, \mathbf{t}) $" src="form_67.png"/></picture> can be written uniquely as a linear combination of <b>B-spline basis functions</b> <picture><source srcset="form_71_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ N_{i,k}(x) $" src="form_71.png"/></picture>, which are defined recursively by the <b>Cox&ndash;de Boor recurrence</b>.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Degree zero</h2>
<p>For <picture><source srcset="form_72_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k = 0 $" src="form_72.png"/></picture> the basis functions are simple indicator functions:</p>
<p class="formulaDsp">
<picture><source srcset="form_73_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    N_{i,0}(x) =
    \begin{cases}
        1 &amp; \text{if } t_i \leq x &lt; t_{i+1}, \\
        0 &amp; \text{otherwise}.
    \end{cases}
\]" src="form_73.png"/></picture>
</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Recurrence for degree <picture><source srcset="form_74_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k \geq 1 $" src="form_74.png"/></picture></h2>
<p>Higher-degree basis functions are built from lower-degree ones:</p>
<p class="formulaDsp">
<picture><source srcset="form_75_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    N_{i,k}(x) =
        \frac{x - t_i}{t_{i+k} - t_i} \, N_{i,k-1}(x)
      + \frac{t_{i+k+1} - x}{t_{i+k+1} - t_{i+1}} \, N_{i+1,k-1}(x)
\]" src="form_75.png"/></picture>
</p>
<p>where any fraction with a zero denominator is taken to be zero (this arises when consecutive knots coincide). The routine <code>fpbspl</code> implements this recurrence.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Key properties</h2>
<p>The B-spline basis functions enjoy several properties that make them ideal for numerical computation:</p>
<ol type="1">
<li><b>Non-negativity</b>: <picture><source srcset="form_76_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ N_{i,k}(x) \geq 0 $" src="form_76.png"/></picture> for all <picture><source srcset="form_77_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x $" src="form_77.png"/></picture>.</li>
<li><b>Local support</b>: <picture><source srcset="form_78_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ N_{i,k}(x) = 0 $" src="form_78.png"/></picture> outside the interval <picture><source srcset="form_79_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ [t_i,\, t_{i+k+1}] $" src="form_79.png"/></picture>. Each basis function is nonzero on at most <picture><source srcset="form_69_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k + 1 $" src="form_69.png"/></picture> knot spans, so spline evaluation is a local operation.</li>
<li><b>Partition of unity</b>: At every point in <picture><source srcset="form_65_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ [a, b] $" src="form_65.png"/></picture> the basis functions sum to one: <picture><source srcset="form_80_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \sum_{i} N_{i,k}(x) = 1 $" src="form_80.png"/></picture>. This ensures that any convex combination of coefficients produces a spline value within the convex hull of those coefficients.</li>
<li><b>Smoothness</b>: At a simple knot (multiplicity 1), <picture><source srcset="form_81_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ N_{i,k} $" src="form_81.png"/></picture> has <picture><source srcset="form_63_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k - 1 $" src="form_63.png"/></picture> continuous derivatives. Each additional coincident knot reduces smoothness by one order.</li>
</ol>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, &sect;1.1&ndash;1.2</dd></dl>
<h1><a class="anchor" id="autotoc_md12"></a>
Spline as a Linear Combination</h1>
<p>Any spline <picture><source srcset="form_82_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s \in \mathcal{S}(k, \mathbf{t}) $" src="form_82.png"/></picture> is represented as</p>
<p class="formulaDsp">
<picture><source srcset="form_83_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    s(x) = \sum_{i=0}^{n} c_i \, N_{i,k}(x)
\]" src="form_83.png"/></picture>
</p>
<p>where the <picture><source srcset="form_84_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ c_i $" src="form_84.png"/></picture> are the <b>B-spline coefficients</b> (also called control points or de Boor points). The entire fitting problem therefore reduces to determining the <picture><source srcset="form_68_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ n + 1 $" src="form_68.png"/></picture> coefficients for a given knot vector.</p>
<p>In FITPACK the coefficient array is stored alongside the knot vector in each derived type (e.g., <code>fitpack_curve</code>, <code>fitpack_surface</code>). Once computed by the fitting routines, the same coefficients are used by all evaluation, derivative, and integration routines.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Evaluation: the de Boor Algorithm</h1>
<p>Given a point <picture><source srcset="form_85_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x \in [t_j,\, t_{j+1}) $" src="form_85.png"/></picture>, the spline value <picture><source srcset="form_86_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s(x) $" src="form_86.png"/></picture> can be computed without explicitly forming all basis functions. The <b>de Boor algorithm</b> is a triangular recurrence analogous to Horner's method for ordinary polynomials.</p>
<p>Define the initial values</p>
<p class="formulaDsp">
<picture><source srcset="form_87_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    d_i^{[0]} = c_i, \qquad i = j-k, \ldots, j
\]" src="form_87.png"/></picture>
</p>
<p>and compute for <picture><source srcset="form_88_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ r = 1, \ldots, k $" src="form_88.png"/></picture>:</p>
<p class="formulaDsp">
<picture><source srcset="form_89_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    d_i^{[r]} =
        \frac{x - t_i}{t_{i+k+1-r} - t_i} \, d_i^{[r-1]}
      + \frac{t_{i+k+1-r} - x}{t_{i+k+1-r} - t_i} \, d_{i-1}^{[r-1]},
    \qquad i = j-k+r, \ldots, j
\]" src="form_89.png"/></picture>
</p>
<p>After <picture><source srcset="form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k $" src="form_5.png"/></picture> stages the result is <picture><source srcset="form_90_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s(x) = d_j^{[k]} $" src="form_90.png"/></picture>. The cost is <picture><source srcset="form_91_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathcal{O}(k^2) $" src="form_91.png"/></picture> per evaluation point, independent of the total number of knots. This is the core loop in <code>splev</code> and underlies every <code>eval</code> method in the library.</p>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, Eq. 1.11</dd></dl>
<h1><a class="anchor" id="autotoc_md14"></a>
Derivatives</h1>
<p>Differentiation of a B-spline representation yields another B-spline of one degree lower. The derivative of <picture><source srcset="form_92_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s(x) = \sum_i c_i \, N_{i,k}(x) $" src="form_92.png"/></picture> is</p>
<p class="formulaDsp">
<picture><source srcset="form_93_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    s'(x) = \sum_{i=1}^{n} c_i^{(1)} \, N_{i,k-1}(x)
\]" src="form_93.png"/></picture>
</p>
<p>where the new coefficients are obtained by <b>differencing</b>:</p>
<p class="formulaDsp">
<picture><source srcset="form_94_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    c_i^{(1)} = \frac{k}{t_{i+k} - t_i} \, (c_i - c_{i-1})
\]" src="form_94.png"/></picture>
</p>
<p>Higher-order derivatives follow by repeated application: the <picture><source srcset="form_95_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \nu $" src="form_95.png"/></picture>-th derivative is a spline of degree <picture><source srcset="form_96_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k - \nu $" src="form_96.png"/></picture> with coefficients obtained from <picture><source srcset="form_95_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \nu $" src="form_95.png"/></picture> successive differencing steps. This structure is exploited by <code>splder</code>, which computes derivatives of any order up to <picture><source srcset="form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k $" src="form_5.png"/></picture>.</p>
<p>Because each differentiation reduces the degree by one, at most <picture><source srcset="form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k $" src="form_5.png"/></picture> derivatives are nonzero. A cubic spline ( <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k = 3 $" src="form_0.png"/></picture>) therefore has a piecewise-constant third derivative and a zero fourth derivative, regardless of the coefficients.</p>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, &sect;1.3</dd></dl>
<h1><a class="anchor" id="autotoc_md15"></a>
Integration</h1>
<p>The definite integral of a spline over an interval can be expressed directly in terms of its coefficients, without numerical quadrature. For a spline <picture><source srcset="form_92_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s(x) = \sum_i c_i \, N_{i,k}(x) $" src="form_92.png"/></picture> on the interval <picture><source srcset="form_65_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ [a, b] $" src="form_65.png"/></picture>:</p>
<p class="formulaDsp">
<picture><source srcset="form_97_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    \int_a^b s(x) \, dx = \sum_{i=0}^{n} c_i \, \frac{t_{i+k+1} - t_i}{k + 1}
\]" src="form_97.png"/></picture>
</p>
<p>This formula follows from the property that the integral of each basis function satisfies</p>
<p class="formulaDsp">
<picture><source srcset="form_98_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    \int_a^b N_{i,k}(x) \, dx = \frac{t_{i+k+1} - t_i}{k + 1}
\]" src="form_98.png"/></picture>
</p>
<p>when the knot vector is clamped at both ends. The routine <code>splint</code> implements this formula, giving exact results (up to floating-point arithmetic) regardless of the complexity of the spline.</p>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, &sect;1.4</dd></dl>
<h1><a class="anchor" id="autotoc_md16"></a>
Knot Insertion (Oslo Algorithm)</h1>
<p>A fundamental operation on B-spline representations is <b>knot insertion</b>: adding a new knot <picture><source srcset="form_99_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \bar{t} $" src="form_99.png"/></picture> to the knot vector without changing the spline function itself. The resulting representation has one more knot, one more coefficient, and the same function values everywhere.</p>
<p>Suppose a knot <picture><source srcset="form_100_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \bar{t} \in [t_j,\, t_{j+1}) $" src="form_100.png"/></picture> is inserted. The new coefficients <picture><source srcset="form_101_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \bar{c}_i $" src="form_101.png"/></picture> are obtained from the old ones by a <b>convex combination</b>:</p>
<p class="formulaDsp">
<picture><source srcset="form_102_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    \bar{c}_i =
    \begin{cases}
        c_i &amp; \text{if } i \leq j - k, \\[4pt]
        \alpha_i \, c_i + (1 - \alpha_i) \, c_{i-1}
            &amp; \text{if } j - k &lt; i \leq j, \\[4pt]
        c_{i-1} &amp; \text{if } i &gt; j,
    \end{cases}
\]" src="form_102.png"/></picture>
</p>
<p>with weights</p>
<p class="formulaDsp">
<picture><source srcset="form_103_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    \alpha_i = \frac{\bar{t} - t_i}{t_{i+k} - t_i}.
\]" src="form_103.png"/></picture>
</p>
<p>Because <picture><source srcset="form_104_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ 0 \leq \alpha_i \leq 1 $" src="form_104.png"/></picture>, the new coefficients lie in the convex hull of their neighbours&mdash;a key property that preserves shape.</p>
<p>Knot insertion is the basis of the <b>Oslo algorithm</b> (Cohen, Lyche, and Schumaker, 1986), which generalizes the operation to insert several knots at once. In FITPACK the <code>insert</code> routine performs single knot insertion and is used both for refinement and for the zero-finding algorithm in <code>sproot</code>.</p>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 6, &sect;6.2 (pp. 114&ndash;118)</dd></dl>
<h1><a class="anchor" id="autotoc_md17"></a>
Tensor Products for Bivariate Splines</h1>
<p>The B-spline framework extends naturally to two dimensions via <b>tensor products</b>. Given knot vectors <picture><source srcset="form_105_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{t}_x $" src="form_105.png"/></picture> and <picture><source srcset="form_106_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \mathbf{t}_y $" src="form_106.png"/></picture> with associated basis functions <picture><source srcset="form_107_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ N_{i,k_x}(x) $" src="form_107.png"/></picture> and <picture><source srcset="form_108_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ M_{j,k_y}(y) $" src="form_108.png"/></picture>, a bivariate spline is</p>
<p class="formulaDsp">
<picture><source srcset="form_109_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    s(x, y) = \sum_{i=0}^{n_x} \sum_{j=0}^{n_y}
        c_{ij} \, N_{i,k_x}(x) \, M_{j,k_y}(y)
\]" src="form_109.png"/></picture>
</p>
<p>The coefficient array <picture><source srcset="form_110_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ c_{ij} $" src="form_110.png"/></picture> has <picture><source srcset="form_111_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ (n_x + 1)(n_y + 1) $" src="form_111.png"/></picture> entries and is stored in column-major order in FITPACK.</p>
<p>Evaluation of a tensor-product spline decomposes into two sequences of univariate evaluations: first evaluate in <picture><source srcset="form_77_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x $" src="form_77.png"/></picture> for each row of coefficients, then evaluate the resulting intermediate values in <picture><source srcset="form_112_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ y $" src="form_112.png"/></picture>. This separability is the reason tensor-product splines scale well to two dimensions.</p>
<p>The routines <code>bispev</code> (grid evaluation) and <code>bispeu</code> (scattered evaluation) implement this strategy. Partial derivatives (<code>parder</code>, <code>pardeu</code>) and double integrals (<code>dblint</code>) follow the same tensor-product decomposition.</p>
<dl class="section see"><dt>See also</dt><dd>Dierckx, Ch. 1, &sect;1.5</dd></dl>
<h1><a class="anchor" id="autotoc_md18"></a>
Further Reading</h1>
<p>The foundations described on this page underpin all fitting algorithms in the library. The fitting problem itself&mdash;choosing knots and coefficients to approximate given data&mdash;is covered separately.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="theory_curve_fitting.html">Curve Fitting Theory</a> </dd>
<dd>
<a class="el" href="book_reference.html">Book Reference Index</a></dd></dl>
<blockquote class="doxtable">
<p>P. Dierckx, <em>Curve and Surface Fitting with Splines</em>, Oxford University Press, 1993. </p>
</blockquote>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
