<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Univariate Curve Fitting with fitpack_curve</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('tutorial_curve.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Univariate Curve Fitting with fitpack_curve</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2home_2runner_2work_2fitpack_2fitpack_2doc_2tutorial__curve"></a></p>
<p>This tutorial explains how to use the <code>fitpack_curve</code> type for univariate spline smoothing and interpolation of the form <picture><source srcset="form_4_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ y = s(x) $" src="form_4.png"/></picture>. It covers the mathematical background, basic and advanced usage, and practical guidance on choosing a smoothing parameter.</p>
<p>Use <code>fitpack_curve</code> when you have a single-valued relationship between an independent variable <picture><source srcset="form_77_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x $" src="form_77.png"/></picture> and a dependent variable <picture><source srcset="form_112_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ y $" src="form_112.png"/></picture> &mdash; that is, each <picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x_i $" src="form_11.png"/></picture> maps to exactly one <picture><source srcset="form_262_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ y_i $" src="form_262.png"/></picture>. The data must be sorted in strictly increasing order of <picture><source srcset="form_77_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x $" src="form_77.png"/></picture>.</p>
<h1><a class="anchor" id="autotoc_md71"></a>
Mathematical Background</h1>
<p>Given <picture><source srcset="form_36_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ m $" src="form_36.png"/></picture> data points <picture><source srcset="form_113_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ (x_i, y_i) $" src="form_113.png"/></picture> with positive weights <picture><source srcset="form_61_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ w_i $" src="form_61.png"/></picture>, FITPACK constructs a B-spline <picture><source srcset="form_86_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s(x) $" src="form_86.png"/></picture> of degree <picture><source srcset="form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k $" src="form_5.png"/></picture> (default <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k = 3 $" src="form_0.png"/></picture>, cubic) by solving the constrained optimization problem</p>
<p class="formulaDsp">
<picture><source srcset="form_263_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    \min \int_{x_1}^{x_m} \left[ s''(x) \right]^2 dx
    \quad \text{subject to} \quad
    \sum_{i=1}^{m} w_i^2 \left( y_i - s(x_i) \right)^2 \leq S
\]" src="form_263.png"/></picture>
</p>
<p>The <b>smoothing parameter</b> <picture><source srcset="form_142_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S \geq 0 $" src="form_142.png"/></picture> controls the trade-off between roughness and fidelity to the data:</p>
<ul>
<li>** <picture><source srcset="form_143_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S = 0 $" src="form_143.png"/></picture>** &mdash; Interpolation. The spline passes through every data point exactly.</li>
<li>**Small <picture><source srcset="form_144_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S $" src="form_144.png"/></picture>** &mdash; Close to the data but may oscillate between points.</li>
<li>**Large <picture><source srcset="form_144_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S $" src="form_144.png"/></picture>** &mdash; Very smooth, but may miss genuine features.</li>
</ul>
<h2><a class="anchor" id="autotoc_md72"></a>
Choosing S</h2>
<p>When the data satisfy <picture><source srcset="form_152_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ y_i = g(x_i) + \varepsilon_i $" src="form_152.png"/></picture> with independent errors of variance <picture><source srcset="form_154_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \sigma^2 $" src="form_154.png"/></picture> and unit weights, the expected residual sum of squares for the true function is <picture><source srcset="form_156_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ m \sigma^2 $" src="form_156.png"/></picture>. A natural starting point is therefore</p>
<p class="formulaDsp">
<picture><source srcset="form_264_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[    S \approx m \, \sigma^2
\]" src="form_264.png"/></picture>
</p>
<p>If no noise estimate is available, <picture><source srcset="form_159_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S = m $" src="form_159.png"/></picture> (assuming unit weights) is a reasonable first guess. The algorithm selects knots automatically: fewer knots for larger <picture><source srcset="form_144_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S $" src="form_144.png"/></picture>, more knots for smaller <picture><source srcset="form_144_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S $" src="form_144.png"/></picture>. After fitting, inspect <code>curve\mse()</code> and <code>curve\knots</code> to judge the result.</p>
<h1><a class="anchor" id="autotoc_md73"></a>
Basic Example</h1>
<p>The following program fits a smoothing spline to noisy sine data, evaluates it, and prints the result.</p>
<div class="fragment"><div class="line"><span class="keyword">program</span> basic_curve</div>
<div class="line">    <span class="keywordtype">use </span><a class="code hl_namespace" href="namespacefitpack.html">fitpack</a>, <span class="keywordtype">only</span>: fitpack_curve, fp_real, fp_flag, &amp;</div>
<div class="line">                       fitpack_success, fitpack_message, &amp;</div>
<div class="line">                       zero, one, half, pi</div>
<div class="line">    <span class="keywordtype">implicit none</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span> :: m = 50</div>
<div class="line"><span class="keywordtype">    real</span>(FP_REAL), <span class="keywordtype">parameter</span> :: two = 2.0_fp_real</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">    real</span>(FP_REAL) :: x(m), y(m), dx</div>
<div class="line">    <span class="keywordtype">type</span>(fitpack_curve) :: curve</div>
<div class="line">    <span class="keywordtype">integer(FP_FLAG)</span> :: ierr</div>
<div class="line"><span class="keywordtype">    real</span>(FP_REAL) :: y_at_pi</div>
<div class="line">    <span class="keywordtype">integer</span> :: i</div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Generate data on [0, 2*pi]</span></div>
<div class="line">    dx = two * pi / (m - 1)</div>
<div class="line">    <span class="keywordflow">do</span> i = 1, m</div>
<div class="line">        x(i) = (i - 1) * dx</div>
<div class="line">        y(i) = sin(x(i)) + 0.05_fp_real * sin(17.0_fp_real * x(i))</div>
<div class="line"><span class="keywordflow">    end do</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Fit a smoothing spline (S = m)</span></div>
<div class="line">    ierr = curve%new_fit(x, y, smoothing=real(m, fp_real))</div>
<div class="line">    <span class="keywordflow">if</span> (.not. fitpack_success(ierr)) <span class="keywordflow">then</span></div>
<div class="line">        print *, <span class="stringliteral">&#39;Fit failed: &#39;</span>, fitpack_message(ierr)</div>
<div class="line">        error stop</div>
<div class="line"><span class="keywordflow">    end if</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">! Evaluate at x = pi</span></div>
<div class="line">    y_at_pi = curve%eval(pi, ierr)</div>
<div class="line">    print <span class="stringliteral">&#39;(a,f10.6)&#39;</span>, <span class="stringliteral">&#39;s(pi)  = &#39;</span>, y_at_pi</div>
<div class="line">    print <span class="stringliteral">&#39;(a,i0)&#39;</span>,    <span class="stringliteral">&#39;knots  = &#39;</span>, curve%knots</div>
<div class="line">    print <span class="stringliteral">&#39;(a,es10.3)&#39;</span>, <span class="stringliteral">&#39;mse    = &#39;</span>, curve%mse()</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">call </span>curve%destroy()</div>
<div class="line"><span class="keyword">end program </span>basic_curve</div>
<div class="ttc" id="anamespacefitpack_html"><div class="ttname"><a href="namespacefitpack.html">fitpack</a></div><div class="ttdoc">Umbrella module that re-exports the complete FITPACK public API.</div><div class="ttdef"><b>Definition</b> fitpack.f90:33</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md74"></a>
Step-by-step</h2>
<ol type="1">
<li><b>Import</b> &sect; The <code>use fitpack</code> statement exposes the curve type, kind parameters (<code>FP_REAL</code>, <code>FP_FLAG</code>), error-handling helpers (<code>FITPACK_SUCCESS</code>, <code>FITPACK_MESSAGE</code>), and named constants (<code>zero</code>, <code>one</code>, <code>half</code>, <code>pi</code>). Note that <code>two</code> is not a public export &mdash; define it locally when needed.</li>
<li><b>Prepare data</b> &sect; The abscissae <code>x</code> must be strictly increasing. The corresponding values <code>y</code> may contain noise.</li>
<li><b>Fit</b> &sect; <code>curve\new_fit(x, y, smoothing=S)</code> constructs the spline. It returns an <code>integer(FP_FLAG)</code> error code. Check it with <code>FITPACK_SUCCESS(ierr)</code>.</li>
<li><b>Evaluate</b> &sect; <code>curve\eval(x, ierr)</code> accepts a scalar or an array and returns the spline value(s).</li>
<li><b>Clean up</b> &sect; <code>curve\destroy()</code> releases all internal allocations.</li>
</ol>
<h1><a class="anchor" id="autotoc_md75"></a>
Advanced Features</h1>
<h2><a class="anchor" id="autotoc_md76"></a>
Weights</h2>
<p>Supply per-point weights via the <code>w</code> argument to emphasize or de-emphasize individual observations. Points with larger weights are fitted more closely.</p>
<div class="fragment"><div class="line"><span class="keywordtype">real</span>(FP_REAL) :: w(m)</div>
<div class="line"> </div>
<div class="line"><span class="comment">! Inverse-variance weighting</span></div>
<div class="line">w = one / sigma</div>
<div class="line">ierr = curve%new_fit(x, y, w=w, smoothing=real(m, fp_real))</div>
</div><!-- fragment --><p>When weights are proportional to <picture><source srcset="form_265_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ 1 / \sigma_i $" src="form_265.png"/></picture>, the smoothing constraint becomes <picture><source srcset="form_266_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \sum (y_i - s(x_i))^2 / \sigma_i^2 \leq S $" src="form_266.png"/></picture>, and <picture><source srcset="form_225_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S \approx m $" src="form_225.png"/></picture> remains a natural choice.</p>
<h2><a class="anchor" id="autotoc_md77"></a>
Derivatives</h2>
<p>Evaluate derivatives of the fitted spline up to order <picture><source srcset="form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k $" src="form_5.png"/></picture> (the spline degree, default 3):</p>
<div class="fragment"><div class="line"><span class="keywordtype">real</span>(FP_REAL) :: dydx, d2ydx2</div>
<div class="line"> </div>
<div class="line">dydx   = curve%dfdx(pi / 4, order=1, ierr=ierr)   <span class="comment">! first derivative</span></div>
<div class="line">d2ydx2 = curve%dfdx(pi / 4, order=2, ierr=ierr)   ! second derivative</div>
</div><!-- fragment --><p>The <code>order</code> parameter selects which derivative: 1 for <picture><source srcset="form_267_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s'(x) $" src="form_267.png"/></picture>, 2 for <picture><source srcset="form_268_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s''(x) $" src="form_268.png"/></picture>, 3 for <picture><source srcset="form_269_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s'''(x) $" src="form_269.png"/></picture>.</p>
<h2><a class="anchor" id="autotoc_md78"></a>
Integration</h2>
<p>Compute the definite integral of the spline over an arbitrary sub-interval <picture><source srcset="form_65_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ [a, b] $" src="form_65.png"/></picture>:</p>
<div class="fragment"><div class="line"><span class="keywordtype">real</span>(FP_REAL) :: area</div>
<div class="line"> </div>
<div class="line">area = curve%integral(zero, pi)</div>
</div><!-- fragment --><p>This evaluates <picture><source srcset="form_270_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \int_a^b s(x) \, dx $" src="form_270.png"/></picture> analytically from the B-spline coefficients, so the result is exact for the fitted spline (no numerical quadrature error).</p>
<h2><a class="anchor" id="autotoc_md79"></a>
Zero Finding</h2>
<p>Find all zeros (roots) of a cubic spline within the data range:</p>
<div class="fragment"><div class="line"><span class="keywordtype">real</span>(FP_REAL), <span class="keywordtype">allocatable</span> :: roots(:)</div>
<div class="line"> </div>
<div class="line">roots = curve%zeros(ierr)</div>
<div class="line">print <span class="stringliteral">&#39;(a,i0)&#39;</span>, <span class="stringliteral">&#39;Number of zeros: &#39;</span>, <span class="keyword">size</span>(roots)</div>
</div><!-- fragment --><p>The <code>curve\zeros(ierr)</code> function returns an allocatable array containing every root of <picture><source srcset="form_271_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s(x) = 0 $" src="form_271.png"/></picture>. This operation requires a cubic spline ( <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k = 3 $" src="form_0.png"/></picture>).</p>
<h2><a class="anchor" id="autotoc_md80"></a>
Interpolation</h2>
<p>For exact interpolation &mdash; a spline that passes through every data point &mdash; set <code>smoothing=zero</code>:</p>
<div class="fragment"><div class="line">ierr = curve%new_fit(x, y, smoothing=zero)</div>
</div><!-- fragment --><p>Alternatively, call the dedicated interpolation method:</p>
<div class="fragment"><div class="line">ierr = curve%interpolate()</div>
</div><!-- fragment --><p>Both produce the smoothest spline (minimum roughness integral) that satisfies <picture><source srcset="form_118_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s(x_i) = y_i $" src="form_118.png"/></picture> for all <picture><source srcset="form_272_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ i $" src="form_272.png"/></picture>.</p>
<h2><a class="anchor" id="autotoc_md81"></a>
Smoothing Sweep</h2>
<p>When the appropriate smoothing level is unknown, try a sequence of <picture><source srcset="form_144_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S $" src="form_144.png"/></picture> values on a logarithmic scale and inspect the resulting number of knots and residual:</p>
<div class="fragment"><div class="line"><span class="keywordtype">integer</span> :: j</div>
<div class="line"> </div>
<div class="line">print <span class="stringliteral">&#39;(a)&#39;</span>, <span class="stringliteral">&#39;     S       knots   residual&#39;</span></div>
<div class="line"><span class="keywordflow">do</span> j = 1, 5</div>
<div class="line">    ierr = curve%new_fit(x, y, smoothing=10.0_fp_real**(3 - j))</div>
<div class="line">    <span class="keywordflow">if</span> (fitpack_success(ierr)) <span class="keywordflow">then</span></div>
<div class="line">        print <span class="stringliteral">&#39;(es10.1,i8,es12.3)&#39;</span>, &amp;</div>
<div class="line">            curve%smoothing, curve%knots, curve%mse()</div>
<div class="line"><span class="keywordflow">    end if</span></div>
<div class="line"><span class="keyword">end </span>do</div>
</div><!-- fragment --><p>A good fit typically shows a "knee" where adding more knots (decreasing <picture><source srcset="form_144_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S $" src="form_144.png"/></picture>) yields diminishing improvement in the residual. Choose the <picture><source srcset="form_144_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S $" src="form_144.png"/></picture> value at or just past this transition point.</p>
<h1><a class="anchor" id="autotoc_md82"></a>
API Summary</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>curve\new_fit(x, y, w, smoothing, order)</code>   </td><td class="markdownTableBodyNone">Fit a smoothing spline; returns <code>integer(FP_FLAG)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>curve\eval(x, ierr)</code>   </td><td class="markdownTableBodyNone">Evaluate <picture><source srcset="form_86_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s(x) $" src="form_86.png"/></picture> at a scalar or array of points    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>curve\dfdx(x, order, ierr)</code>   </td><td class="markdownTableBodyNone">Evaluate derivative of order 1, 2, or 3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>curve\integral(from, to)</code>   </td><td class="markdownTableBodyNone">Definite integral <picture><source srcset="form_270_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \int_a^b s(x) \, dx $" src="form_270.png"/></picture>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>curve\zeros(ierr)</code>   </td><td class="markdownTableBodyNone">All zeros of <picture><source srcset="form_86_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s(x) $" src="form_86.png"/></picture> (cubic splines only)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>curve\interpolate()</code>   </td><td class="markdownTableBodyNone">Exact interpolation ( <picture><source srcset="form_143_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S = 0 $" src="form_143.png"/></picture>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>curve\knots</code>   </td><td class="markdownTableBodyNone">Number of knots in the current fit    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>curve\mse()</code>   </td><td class="markdownTableBodyNone">Weighted residual sum of squares <picture><source srcset="form_273_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ f_p $" src="form_273.png"/></picture>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>curve\smoothing</code>   </td><td class="markdownTableBodyNone">Current smoothing parameter <picture><source srcset="form_144_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ S $" src="form_144.png"/></picture>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>curve\destroy()</code>   </td><td class="markdownTableBodyNone">Release all allocated memory   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md83"></a>
Complete Example</h1>
<p>A fully compilable program demonstrating smoothing, interpolation, derivatives, integration, root finding, and a smoothing sweep is provided in <code>examples/example_curve.f90</code>. Build and run it with:</p>
<div class="fragment"><div class="line">fpm run --example example_curve</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md84"></a>
Error Handling</h1>
<p>All fitting and evaluation routines return an <code>integer(FP_FLAG)</code> error code. Use <code>FITPACK_SUCCESS(ierr)</code> to test for success and <code>FITPACK_MESSAGE(ierr)</code> to obtain a human-readable description:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (.not. fitpack_success(ierr)) <span class="keywordflow">then</span></div>
<div class="line">    print *, <span class="stringliteral">&#39;Error: &#39;</span>, fitpack_message(ierr)</div>
<div class="line"><span class="keyword">end </span>if</div>
</div><!-- fragment --><p>Common return values:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag   </th><th class="markdownTableHeadNone">Meaning    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>FITPACK_OK</code> (0)   </td><td class="markdownTableBodyNone">Success    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>FITPACK_INTERPOLATING_OK</code> ( <picture><source srcset="form_274_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$-1$" src="form_274.png"/></picture>)   </td><td class="markdownTableBodyNone">Interpolating spline returned    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>FITPACK_S_TOO_SMALL</code> (1)   </td><td class="markdownTableBodyNone">Smoothing parameter too small for the knot budget    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>FITPACK_MAXIT</code> (2)   </td><td class="markdownTableBodyNone">Maximum iterations reached    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>FITPACK_INPUT_ERROR</code> (10)   </td><td class="markdownTableBodyNone">Invalid input data   </td></tr>
</table>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="theory_curve_fitting.html">Curve Fitting Theory</a> </dd>
<dd>
<a class="el" href="theory_bsplines.html">B-Spline Foundations</a> </dd>
<dd>
<a class="el" href="tutorial_periodic_curve.html">Periodic Curve Fitting</a> </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
